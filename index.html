
<!DOCTYPE html>
<html lang='en'>
<head>
<title>Developing on AWS - Lab 6 - Developing an end to end Application with AWS | Qwiklabs</title>
<script>
//<![CDATA[
window.gon={};gon.current_user={"firstname":"Anthony","lastname":"Gilbert","fullname":"Anthony Gilbert","company":"Revolent Group","email":"a.gilbert@revolentgroup.com","origin":"gk-emea, direct","subscriptions":0,"id":"7a5134b2da973255c04cc096e087560e","qlCreatedAt":"2022-03-08 20:25:33 UTC","optIn":true,"current_organization_id":null,"current_organization_role":null};gon.segment=null;gon.deployment="gk-emea";gon.content={"type":"Lab","id":67435,"name":"Developing on AWS - Lab 6 - Developing an end to end Application with AWS"};
//]]>
</script>
<script>
  dataLayer = [
    {user: gon.current_user},
    {content: gon.content}
  ];
</script>
<script src="https://cdn.qwiklabs.com/assets/hallofmirrors/polyfills/webcomponents-loader-60a166e60df2787cca5915e2ced8c317457f421a20f02601b937a72275ac441a.js"></script>
<script src="https://cdn.qwiklabs.com/assets/vendor-2beee108ba05276bc429223ee82ed81449d233c93d45af5da84add895e101218.js"></script>
<script src="https://cdn.qwiklabs.com/assets/application-fc0a28d87377f3b4dffb6b887596c9cc7f2cb61496b1d69999d679f17724f659.js"></script>
<script src="https://cdn.qwiklabs.com/assets/hallofmirrors/hallofmirrors-75c2ea0b51280293b9c6417e3db46fb02057e62356900a03787a4e4b26c7c35e.js"></script>
<!--[if lt IE 9]>
<script src='http://html5shim.googlecode.com/svn/trunk/html5.js' type='text/javascript'></script>
<![endif]-->
<!--[endif]>  <![endif]-->
<script type='application/ld+json'>
{
  "@context": "http://schema.org",
  "@type": "WebSite",
  "url": "https://www.qwiklabs.com/",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://www.qwiklabs.com/catalog?keywords={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script>
<script id='ze-snippet' src='https://static.zdassets.com/ekr/snippet.js?key=511e4158-0aec-4e3c-b2e6-4daa1769f51e'></script>


<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="51KkVDKojJGdRxk5qKoo5yMfHDnzBX8f4xJv30D981kTJ+WtDDU3GUarHqrp8X01xeFx3lYPzFAZp+c9zJmUFQ==" />
<meta content='width=device-width, initial-scale=1.0, user-scalable=yes' name='viewport'>
<meta content='1rRsY0INj8RvwB5EF5pwdxt2A2P9aDgAlsICaJ0d5w0' name='google-site-verification'>
<meta content='#3681E4' property='msapplication-TileColor'>
<meta content='/favicon-144.png' property='msapplication-TileImage'>
<meta content='[{&quot;id&quot;:&quot;recaptcha_experiment&quot;,&quot;optimize_id&quot;:&quot;dpViOcLkT3qS4TvL2mRojA&quot;,&quot;title&quot;:&quot;No Recaptcha shown for trusted users&quot;,&quot;variant_index&quot;:0,&quot;variant&quot;:&quot;original&quot;}]' name='active-experiments'>
<meta content='{&quot;userId&quot;:27375}' name='help-api-product-data'>
<meta content='Developing on AWS is a three-day instructor led course.' name='description'>
<meta content='Qwiklabs' name='author'>
<meta content='Developing on AWS - Lab 6 - Developing an end to end Application with AWS | Qwiklabs' property='og:title'>
<meta content='website' property='og:type'>
<meta content='/favicon-144.png' property='og:image'>
<meta content='Qwiklabs' property='og:site_name'>
<meta content='Developing on AWS is a three-day instructor led course.' property='og:description'>
<meta content='/qwiklabs_logo_900x887.png' property='og:logo' size='900x887'>
<meta content='/qwiklabs_logo_994x187.png' property='og:logo' size='994x187'>



<link color='#3681E4' href='/favicon-svg.svg' rel='mask-icon'>
<link href='/favicon-180.png' rel='apple-touch-icon-precomposed'>
<link href='/favicon-32.png' rel='shortcut icon' type='image/x-icon'>



<link rel="stylesheet" media="screen" href="https://fonts.googleapis.com/css?family=Oswald:400|Roboto+Mono:400,700|Roboto:300,400,500,700|Google+Sans:300,400,500,700|Google+Sans+Display:400|Material+Icons|Google+Material+Icons" />


<link rel="stylesheet" media="all" href="https://cdn.qwiklabs.com/assets/application-f1ff8a46c8eec9a0b98246c510722cf4aac8e25d766204e233abd87f9d661f54.css" />

<style>
  :root {
    --primary-text-on-surface-color: #1A73E8;
    --primary-text-on-surface-color-dark: #1568d6;
    --primary-text-on-surface-color-darker: #135ec1;
    --primary-text-on-surface-color-darkest: #1154ac;
    --primary-surface-color: #1A73E8;
    --primary-surface-color-rgb: 26,115,232;
    --primary-surface-color-light: #d1e3fa;
    --primary-surface-color-lightest: #e8f1fd;
    --text-on-primary-color: #FFFFFF;
    --accent-text-on-surface-color: #F29900;
    --accent-surface-color: #F9AB00;
    --accent-surface-color-rgb: 249,171,0;
    --accent-surface-color-light: #ffefcc;
    --text-on-accent-color: #202124;
  }
</style>



</head>
<body class='lab-show l-full no-nav application-new focuses focuses-show lab-show l-full no-nav '>
<div class='header-container'>
<div class='header'>
<ql-toolbar jumpEnabled>
<div class='header__title' slot='title'>
<ql-icon-button label="Back" href="/classrooms/4134" id="33f47832a38f5aab" target="_self" tip="Back">arrow_back</ql-icon-button>
<h1 class='ql-headline-6'>Developing on AWS - Lab 6 - Developing an end to end Application with AWS</h1>
</div>
<div class='header__actions' slot='action'>
<ql-icon-button id='control-panel-target' style='display: none;'>
dashboard
</ql-icon-button>
<ql-menu for='control-panel-target' id='control-panel-menu'></ql-menu>
<ql-icon-button class='mobile-hide' icon='help_outline' id='help-menu-button' label='Open help menu' tip='Help'></ql-icon-button>
<ql-menu for='help-menu-button' id='help-menu'>
<ql-menu-item data-analytics-action='opened_help' data-analytics-label='lab' label='Help Center' onclick='hallofmirrors.helpService.startHelp({&quot;productData&quot;:{&quot;userId&quot;:27375},&quot;context&quot;:&quot;lab&quot;})'></ql-menu-item>
<ql-menu-item href='https://support.google.com/qwiklabs/contact/contact_us' label='Email support' target='_blank'></ql-menu-item>
<ql-menu-item label='Chat support' onClick='ql.chat.open()'></ql-menu-item>
</ql-menu>

<ql-icon-button class='mobile-hide' icon='language' id='language' label='Select your language preference' tip='Language'></ql-icon-button>
<ql-menu for='language'>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='ar' href='/classrooms/4134/labs/31084?locale=ar' label='العربية‬‎' lang='ar'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='de' href='/classrooms/4134/labs/31084?locale=de' label='Deutsch' lang='de'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='en' href='/classrooms/4134/labs/31084?locale=en' label='English' lang='en'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='es' href='/classrooms/4134/labs/31084?locale=es' label='español (Latinoamérica)' lang='es'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='fr' href='/classrooms/4134/labs/31084?locale=fr' label='français' lang='fr'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='fr_CA' href='/classrooms/4134/labs/31084?locale=fr_CA' label='français (Canada)' lang='fr-CA'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='he' href='/classrooms/4134/labs/31084?locale=he' label='עברית' lang='he'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='id' href='/classrooms/4134/labs/31084?locale=id' label='bahasa Indonesia' lang='id'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='it' href='/classrooms/4134/labs/31084?locale=it' label='Italiano' lang='it'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='ja' href='/classrooms/4134/labs/31084?locale=ja' label='日本語' lang='ja'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='ko' href='/classrooms/4134/labs/31084?locale=ko' label='한국어' lang='ko'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='pl' href='/classrooms/4134/labs/31084?locale=pl' label='Polski' lang='pl'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='pt_BR' href='/classrooms/4134/labs/31084?locale=pt_BR' label='português (Brasil)' lang='pt-BR'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='pt_PT' href='/classrooms/4134/labs/31084?locale=pt_PT' label='português (Portugal)' lang='pt-PT'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='ru' href='/classrooms/4134/labs/31084?locale=ru' label='русский' lang='ru'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='tr' href='/classrooms/4134/labs/31084?locale=tr' label='Türkçe' lang='tr'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='zh' href='/classrooms/4134/labs/31084?locale=zh' label='简体中文' lang='zh'></ql-menu-item>
<ql-menu-item data-analytics-action='changed_locale' data-analytics-label='zh_TW' href='/classrooms/4134/labs/31084?locale=zh_TW' label='繁體中文' lang='zh-TW'></ql-menu-item>
</ql-menu>

<ql-icon-button id='my_account' label='My account' tip='My account'>
<ql-avatar></ql-avatar>
</ql-icon-button>
<ql-menu for='my_account' id='my_account_menu' style='max-height: 640px'>
<div class='my-account-menu'>
<ql-avatar class='l-mtl l-mbl' size='120'></ql-avatar>
<div class='my-account-menu__user-info l-mbl'>
<h4 class='ql-subhead-1'>Anthony Gilbert</h4>
<p class='ql-body-2 text--light'>a.gilbert@revolentgroup.com</p>
<p class='ql-body-2 text--light'>
</p>
</div>
<div class='buttons l-mbl'>
<a class="button button--hairline" id="settings" href="/my_account/profile">Settings</a>
</div>
<hr>
<ql-button data-analytics-action='clicked_sign_out' href='/users/sign_out' method='delete'>
Sign Out
</ql-button>
<div class='privacy l-mtl'>
<a target="_blank" class="ql-caption text--light" href="/privacy_policy">Privacy</a>
<span class='ql-caption text--light l-mls l-mrs'>&middot;</span>
<a class="ql-caption text--light" href="/terms_of_service">Terms</a>
</div>
</div>
</ql-menu>

</div>
</ql-toolbar>

</div>
</div>

<nav class='nav-panel js-nav-panel'>
<div class='nav-panel__logo'>
<div class="custom-logo"><img alt="Qwiklabs" height="24" aria-label="Qwiklabs" src="https://cdn.qwiklabs.com/F8s2cBi6pqGxWTVxZEne8LVyTDBb6nK3UEh%2FzydCyF4%3D" /></div>
</div>
<nav class='ql-sidenav'>
<ql-sidenav-item href='/' icon='home' label='Home'></ql-sidenav-item>

<ql-sidenav-item href='/catalog' icon='school' label='Catalog'></ql-sidenav-item>

<ql-sidenav-item active href='/profile' icon='event_note' label='Profile'></ql-sidenav-item>

</nav>

</nav>
<div class='nav-panel__overlay js-nav-toggle'></div>

<main class='js-main' id='jump-content'>
<div class='l-main-wrapper' id='main-wrapper'>




<ql-drawer-container class='js-lab-state' data-analytics-payload='{&quot;label&quot;:&quot;Developing on AWS - Lab 6 - Developing an end to end Application with AWS&quot;,&quot;lab_name&quot;:&quot;Developing on AWS - Lab 6 - Developing an end to end Application with AWS&quot;,&quot;classroom_name&quot;:null,&quot;deployment&quot;:&quot;gk-emea&quot;}' data-focus-id='31084' data-lab-billing-limit='0.0' data-lab-duration='14400' data-parent='classroom' id='lab-container'>
<ql-drawer id='terminal-drawer' slot='drawer' style='width: calc(100% - 480px)'>
<iframe allow='clipboard-read' class='terminal' id='embedded-resource'></iframe>
</ql-drawer>
<ql-drawer-content class='js-lab-wrapper' id='lab-content' slot='drawer-content'>
<ql-drawer-container id='lab-content-container'>
<ql-drawer id='control-panel-drawer' open slot='drawer' width='320'>
<ql-lab-control-panel class='ql-lab-control-panel__max-height control-panel js-lab-control-panel' connectionFiles='[]' labControlButton='{&quot;disabled&quot;:false,&quot;pending&quot;:false,&quot;running&quot;:false}' labDetails='[]' labTimer='{&quot;ticking&quot;:false,&quot;secondsRemaining&quot;:14400}' studentResources='[]'>
</ql-lab-control-panel>
</ql-drawer>
<ql-drawer-content id='lab-instructions' slot='drawer-content'>
<ql-snackbar id='alert-snackbar'></ql-snackbar>
<div class='alert alert--fake js-alert'>
<p class='alert__message js-alert-message' role='alert'></p>
<ql-icon-button class='alert__close js-alert-close' icon='clear'></ql-icon-button>
<iframe class='l-ie-iframe-fix' tabindex='-1'></iframe>
</div>
<div class='lab-content__renderable-instructions js-lab-content'>
<div class='lab-preamble'>
<h1 class='lab-preamble__title'>
Developing on AWS - Lab 6 - Developing an end to end Application with AWS
</h1>
<div class='lab-preamble__details subtitle-headline-1'>
<span>4 hours </span>
<span>Free</span>
<div class='lab__rating'>
<a aria-label="Lab Reviews" href="/focuses/31084/reviews?parent=classroom"><div class='rateit' data-rateit-readonly='true' data-rateit-value='4.6'></div>

</a><ql-button aria-label='Rate Lab' id='rate-lab-btn' label='Rate Lab' text></ql-button>
</div>
</div>
</div>
<div class='lab-outline-place-holder'></div>

<div class='markdown-lab-instructions js-markdown-instructions no-select' id='markdown-lab-instructions'>
<p><img src="https://s3-us-west-2.amazonaws.com/us-west-2-aws-training/awsu-spl/sts-sign-in-images/media/aws-logo.png" alt=""></p>

<h1>Lab 6 - Developing an end to end Application with AWS</h1>

<p>© 2021 Amazon Web Services, Inc. and its affiliates. All rights reserved. This work may not be reproduced or redistributed, in whole or in part, without prior written permission from Amazon Web Services, Inc. Commercial copying, lending, or selling is prohibited. All trademarks are the property of their owners.</p>

<p>Note: Do not include any personal, identifying, or confidential information into the lab environment. Information entered may be visible to others.</p>

<p>Corrections, feedback, or other questions? Contact us at <a href="https://support.aws.amazon.com/#/contacts/aws-training" target="_blank"><em>AWS Training and Certification</em></a>.</p>

<h2 id="step1">Overview</h2>

<p>In this lab, you will learn how to use the AWS SDK and several AWS services to build an end to end serverless web application instead of the little pieces you have been building in the previous labs.</p>

<p>The idea of this web application is to provide a way for users to create and manage text notes and play them back audibly in different accents and voices by using Amazon Polly.</p>

<p>The web app will have the following:</p>
<ul>
<li>A frontend based on Angular whose files will be hosted on a static website in Amazon S3.</li>
<li>A backend based on Amazon Cognito User Pools, Amazon API Gateway, Amazon Lambda, Amazon DynamoDB, and Amazon Polly.</li>
</ul>
<p>There is a need to develop one Lambda function as part of this lab and use four Lambda functions that have already been coded for you. Once you complete the lab and you still have time remaining, take the challenge by coding three of those four Lambda functions yourself.</p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram-2020.png" alt="Lab 6 Diagram"></p>

<p><strong>This lab makes use of the following AWS services:</strong></p>

<p><strong>Amazon API Gateway</strong></p>
<ul>
<li>Create, maintain, and secure APIs at any scale. Run multiple versions of the same API simultaneously with quick iteration, testing, and release. Throttle traffic and authorize API calls to withstand traffic spikes. Monitor performance metrics and information on API calls, data latency, and error rates.</li>
<li>
<i class="fas fa-info-circle" style="color:#00a1c9;"></i> <a href="https://aws.amazon.com/api-gateway" target="_blank">Learn more about Amazon API Gateway</a>
</li>
</ul>
<p><strong>Amazon Cognito</strong></p>
<ul>
<li>Amazon Cognito lets you add user sign-up, sign-in, and access control to your web and mobile apps quickly and easily. Amazon Cognito scales to millions of users and supports sign-in with social identity providers, such as Apple, Facebook, Google, and Amazon, and enterprise identity providers via SAML 2.0 and OpenID Connect.</li>
<li>
<i class="fas fa-info-circle" style="color:#00a1c9;"></i> <a href="https://aws.amazon.com/cognito" target="_blank">Learn more about Amazon Cognito</a>
</li>
</ul>
<p><strong>Amazon DynamoDB</strong></p>
<ul>
<li>Amazon DynamoDB is a key-value and document database that delivers single-digit millisecond performance at any scale. It's a fully managed, multi-region, multi-active, durable database with built-in security, backup and restore, and in-memory caching for internet-scale applications.</li>
<li>
<i class="fas fa-info-circle" style="color:#00a1c9;"></i> <a href="https://aws.amazon.com/dynamodb" target="_blank">Learn more about Amazon DynamoDB</a>
</li>
</ul>
<p><strong>Amazon Elastic Compute Cloud (Amazon EC2)</strong></p>
<ul>
<li>Amazon EC2 is a web service that provides resizable compute capacity in the cloud. It reduces the time required to obtain and boot a new server instance to minutes, allowing you to quickly scale capacity, both up-and-down, as your computing requirements change.</li>
<li>
<i class="fas fa-info-circle" style="color:#00a1c9;"></i> <a href="https://aws.amazon.com/ec2" target="_blank">Learn more about Amazon EC2</a>
</li>
</ul>
<p><strong>Amazon Lambda</strong></p>
<ul>
<li>AWS Lambda is a serverless compute service that lets you run code without provisioning or managing servers, creating workload-aware cluster scaling logic, maintaining event integrations, or managing runtimes. With Lambda, you can run code for virtually any type of application or backend service - all with zero administration.</li>
<li>
<i class="fas fa-info-circle" style="color:#00a1c9;"></i> <a href="https://aws.amazon.com/lambda/" target="_blank">Learn more about AWS Lambda</a>
</li>
</ul>
<p><strong>Amazon Polly</strong></p>
<ul>
<li>Amazon Polly is a service that turns text into lifelike speech, allowing you to create applications that talk, and build entirely new categories of speech-enabled products. Polly's Text-to-Speech (TTS) service uses advanced deep learning technologies to synthesize natural sounding human speech. With dozens of lifelike voices across a broad set of languages, you can build speech-enabled applications that work in many different countries.</li>
<li>
<i class="fas fa-info-circle" style="color:#00a1c9;"></i> <a href="https://aws.amazon.com/polly" target="_blank">Learn more about Amazon Polly</a>
</li>
</ul>
<p><strong>AWS Identity and Access Management (IAM)</strong></p>
<ul>
<li>AWS Identity and Access Management (IAM) enables you to manage access to AWS services and resources securely. Using IAM, you can create and manage AWS users and groups, and use permissions to allow and deny their access to AWS resources.</li>
<li>
<i class="fas fa-info-circle" style="color:#00a1c9;"></i> <a href="https://aws.amazon.com/iam" target="_blank">Learn more about IAM</a>
</li>
</ul>
<p><strong>Simple Storage Service (Amazon S3)</strong></p>
<ul>
<li>Amazon Simple Storage Service (Amazon S3) is an object storage service that offers industry-leading scalability, data availability, security, and performance.</li>
<li>
<i class="fas fa-info-circle" style="color:#00a1c9;"></i> <a href="https://aws.amazon.com/s3" target="_blank">Learn more about Amazon S3</a>
</li>
</ul>
<h2 id="step2">Objectives</h2>

<p>After completing this lab, you will be able to:</p>
<ul>
<li>Use Remote Desktop (RDP) to connect to an Amazon EC2 instance running Windows Server as your development environment.</li>
<li>Use Amazon EC2 Instance Connect to connect to an Amazon EC2 Instance running Linux.</li>
<li>Host a Static Website in an Amazon S3 bucket.</li>
<li>Create an IAM Policy and Role to give specific access to Lambda.</li>
<li>Create an Amazon Cognito User Pool to authenticate users and control access to API Gateway.</li>
<li>Create Lambda functions to perform CRUD operations on a DynamoDB table.</li>
<li>Create a Restful API on API Gateway to front Lambda functions.</li>
<li>Access the Amazon Polly service through API.</li>
</ul>
<h2 id="step3">Prerequisites</h2>

<p>This lab requires:</p>
<ul>
<li>Access to a notebook computer with Wi-Fi running Microsoft Windows or macOS.</li>
<li>An Internet browser such as Chrome, Firefox, or IE9+. (previous versions of Internet Explorer are not supported)</li>
<li>A Microsoft Remote Desktop client to connect to your development Amazon EC2 instance.</li>
</ul>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> You can use an iPad or tablet device to access these directions in the lab console.  </p>

<h2 id="step4">Icon key</h2>

<p>Various icons are used throughout this lab to call attention to certain aspects of the guide. The following list explains the purpose for each one:</p>
<ul>
<li>
<i class="fas fa-keyboard"></i> Specifies the command you must run.</li>
<li>
<i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> Verify the output of a command or edited file.</li>
<li>
<i class="fas fa-sticky-note" style="color:#ec7211;"></i> Specifies important hints, tips, guidance, or advice.</li>
<li>
<i class="fas fa-info-circle" style="color:#00a1c9;"></i> Specifies where to find more information.</li>
<li>
<i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Calls attention to information of special interest or importance. Failure to read the note does not result in physical harm to the equipment or data, but could result in the need to repeat certain steps.</li>
<li>
<i class="fas fa-user-shield" style="color:#00a1c9;"></i> Identifies opportunities to incorporate security best practices.</li>
<li>
<i class="fas fa-exclamation-triangle" style="color:#d13212;"></i> Draws special attention to actions that are irreversible and could potentially impact the failure of a command or process. Includes warnings about configurations that cannot be changed after they are made.</li>
<li>
<i class="far fa-comment" style="color:#00a1c9;"></i> Suggests a moment to pause to consider how you might apply a concept in your own environment or to initiate a conversation about the topic at hand.</li>
<li>
<p><i class="fas fa-file-code" style="color:#00a1c9;"></i> In some cases, you may run a script or apply a file that has been pre-created for you. This icon signifies a code block that is used to display the contents of the script or file you interacted with.</p>
<ul>
<li>When you need to copy only a certain part of a code block, there will be numbered <strong>TODO</strong> comments in the code.</li>
</ul>
</li>
<li><p><i class="far fa-compass" style="color:#dd6b10;"></i> When asked to open the <strong>Context Menu</strong> for an item, this is the same action as right-clicking for a mouse or the appropriate action for your particular pointing device.</p></li>
</ul>
<h2 id="step5">Duration</h2>

<p>This lab will require around <strong>2 hours</strong> to complete.</p>

<h2 id="step6">Start Lab</h2>
<ol start="1">
<li>At the top of your screen, launch your lab by choosing <span style="background-color:#34A853;font-family:Google Sans;font-weight:bold;font-size:90%;color:white;border-color:#34A853;border-radius:4px;border-width:2px;border-style:solid;padding-top:5px;padding-bottom:5px;padding-left:10px;padding-right:10px;">Start Lab</span>
</li>
</ol>
<p>This starts the process of provisioning your lab resources. An estimated amount of time to provision your lab resources is displayed. You must wait for your resources to be provisioned before continuing.</p>

<p><i class="fas fa-info-circle"></i> If you are prompted for a token, use the one distributed to you (or credits you have purchased). </p>
<ol start="2">
<li>Open your lab by choosing <span style="background-color:white;font-family:Google Sans;font-weight:bold;font-size:90%;color:#1a73e8;border-color:#dadce0;border-radius:4px;border-width:2px;border-style:solid;padding-top:5px;padding-bottom:5px;padding-left:10px;padding-right:10px;">Open Console</span>
</li>
</ol>
<p>This opens an AWS Management Console sign-in page.</p>
<ol start="3">
<li>On the sign-in page, configure:</li>
</ol><ul>
<li>
<strong>IAM user name:</strong> <input readonly class="copyable-inline-input" size="10" type="text" value="awsstudent">
</li>
<li>
<strong>Password:</strong> Paste the value of <strong>Password</strong> from the left side of the lab page</li>
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Sign In</span>
</li>
</ul>
<p><i class="fas fa-exclamation-triangle"></i> <strong>Do not change the Region unless instructed.</strong></p>



<h3>Common Login Errors</h3>

<p><strong>Error: You must first log out</strong></p>

<p><img src="https://s3-us-west-2.amazonaws.com/us-west-2-aws-training/awsu-spl/sts-sign-in-images/media/logouterror.png" alt=""></p>

<p>If you see the message, <strong>You must first log out before logging into a different AWS account:</strong> </p>
<ul>
<li>Choose <strong>click here</strong>
</li>
<li>Close your browser tab to return to your initial lab window</li>
<li>Choose <span style="background-color:white;font-family:Google Sans;font-weight:bold;font-size:90%;color:#1a73e8;border-color:#dadce0;border-radius:4px;border-width:2px;border-style:solid;padding-top:5px;padding-bottom:5px;padding-left:10px;padding-right:10px;">Open Console</span> again</li>
</ul>


<h2 id="step7">Task 1: Connect to your development environment</h2>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> This lab is to be completed using the <strong>Windows Dev Instance</strong> for the <strong>.NET</strong> and the <strong>Java</strong> versions of the lab.</p>

<p>The <strong>Python</strong> version of the lab will be completed using the <strong>Linux Dev Instance</strong>. You will be instructed to use <strong>EC2 Instance Connect</strong> at the appropriate times.</p>

<p>For now, connect to the <strong>Windows Dev Instance</strong> using one of the following options if you are going to use the <strong>.NET</strong> or <strong>Java</strong> version of the lab. Otherwise move ahead to <strong>Task 1.2</strong>:</p>
<ul>
<li><p><a href="#connect_guacamole" target="_self">Connect to Your Windows Dev Instance using Apache Guacamole</a></p></li>
<li><p><a href="#connect_win_win" target="_self">Connect to Your Windows Dev Instance from a Windows Machine using RDP</a></p></li>
<li><p><a href="#connect_win_mac" target="_self">Connect to Your Windows Dev Instance from a macOS Machine using RDP</a></p></li>
</ul>
<p><a id="task1-continue" target="_blank"></a></p>

<h3>Task 1.2: Command window options</h3>

<p>When lab instructions in subsequent sections require a command window, use a <strong>PowerShell</strong> session.</p>

<h2 id="step8">Task 2: Choose a programming language</h2>
<ol start="4">
<li>Choose the programming language you would like to use for this lab. You can use the .NET, Java, or Python.</li>
</ol><ul>
<li><p><a href="#dotnet" target="_self">.NET</a></p></li>
<li><p><a href="#java" target="_self">Java</a></p></li>
<li><p><a href="#python" target="_self">Python</a></p></li>
</ul>
<p><a id="dotnet" target="_blank"></a></p>

<h2 id="step9">Task 3: (.NET) - Amazon Cognito Authentication</h2>

<p>AWS SDK for .NET simpliﬁes use of AWS Services by providing a set of libraries that are consistent and familiar for .NET developers.</p>
<ul>
<li>
<i class="fas fa-info-circle" style="color:#00a1c9;"></i> <a href="https://aws.amazon.com/sdk-for-net" target="_blank">Learn more about the AWS SDK for .NET</a>
</li>
</ul>
<p>In this task, you will:</p>
<ul>
<li>Create an Amazon Cognito user pool, which you are going to use to authenticate your end users and control access through API Gateway, making sure that your endpoint is secure.</li>
<li>Create and confirm an Amazon Cognito user by using the <strong>Linux Dev Instance</strong>. The Amazon Cognito user is used to test the end to end application.</li>
</ul>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram1-2020.png" alt="Lab 6 Diagram"></p>

<p><i class="fas fa-info-circle" style="color:#00a1c9;"></i> For more information on Amazon Cognito User Pools, see: <a href="https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-identity-pools.html" target="_blank">Amazon Cognito User Pools</a></p>

<h3>Task 3.1: (.NET) - Creating an Amazon Cognito User Pool</h3>
<ol start="5">
<li>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>Amazon Cognito</strong>.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Verify that you are in the <strong>correct region</strong>. If you are unsure of the region, you can see it identified in the <strong>Lab Information</strong> section to the left of these instructions. Every service that is used in the lab (Amazon Cognito, API Gateway, Lambda, and DynamoDB) must be in the same region. Take a note of this region and every time the instructions prompt you to verify your region, make sure it is the same.</p>
<ol start="6">
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Manage User Pools</span>
</li>
<li>Choose <span style="background-color:#2a7fd4;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;border-color:#0055aa;border-radius:2px;white-space:nowrap;">Create a user pool</span>
</li>
<li>For <strong>Pool name</strong>, enter: <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesPool">
</li>
<li>For <strong>How do you want to create your user pool?</strong>, choose <span style="color:#0073bb;"><strong>Step through settings</strong></span>
</li>
<li>Go to the <strong>Which standard attributes do you want to require?</strong> section.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#d13212;"></i> This step can't be modified once the User Pool is created. To correct this, you would need to delete the current User Pool and create a new one.</p>
<ol start="11">
<li><p>Remove the checkbox next to <i class="far fa-square"></i> <strong>email</strong> and choose <span style="background-color:#329AD6;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Next step</span></p></li>
<li><p>In the <strong>What password strength do you want to require?</strong> section, you set the specifics required for the password. The password used is for testing purposes and you will be entering it many times so it has limited security settings.</p></li>
</ol>
<p>Choose the following configuration:</p>
<ul>
<li>
<strong>Minimum length</strong> <input readonly class="copyable-inline-input" size="1" type="text" value="6">
</li>
</ul>
<p>Unselect the following options:</p>
<ul>
<li>
<i class="far fa-square"></i> <strong>Require numbers</strong>
</li>
<li>
<i class="far fa-square"></i> <strong>Require special character</strong>
</li>
<li>
<i class="far fa-square"></i> <strong>Require uppercase letters</strong>
</li>
<li>
<i class="far fa-square"></i> <strong>Require lowercase letters</strong>
</li>
</ul><ol start="13">
<li>Choose <span style="background-color:#329AD6;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Next step</span>
</li>
</ol>
<p>In the navigation menu on the left, you will find a list of all of the main steps for the creation of the Amazon Cognito User Pool. As many settings can stay as the defaults, you will skip ahead and go to the ones that need to be modified.</p>
<ol start="14">
<li><p>Choose <strong>App clients</strong>.</p></li>
<li><p>Choose <span style="color:#0073bb;">Add an app client</span></p></li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Make sure that you follow the next steps exactly as this configuration can't be undone. To correct, you would have to delete the current App client and create a new one.</p>
<ul>
<li>
<strong>App client name:</strong>  <input readonly class="copyable-inline-input" size="17" type="text" value="PollyNotesAngular">
</li>
<li>Unselect <i class="far fa-square"></i> <strong>Generate client secret</strong>.</li>
</ul><ol start="16">
<li>Choose <span style="background-color:#329AD6;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Create app client</span>
</li>
<li>In the navigation menu on the left, choose <strong>Review</strong> and review all of the settings.</li>
<li>Choose <span style="background-color:#329AD6;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Create pool</span>
</li>
<li>Save the <strong>Pool Id</strong> and the <strong>Pool ARN</strong> from your Amazon Cognito Pool information into a separate file for use later in this lab.</li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> Make sure to note that it is for <strong>Amazon Cognito Pool Id</strong> and <strong>Amazon Cognito Pool ARN</strong> as well.</p>

<p>For example, in the Oregon region, the <strong>Pool Id</strong> would look like <strong>us-west-2_XXXXXXXXX</strong> and the <strong>Pool ARN</strong> would look like <strong>arn:aws:cognito-idp:us-west-2:012345678901:userpool/us-west-2_XXXXXXXXX</strong>.</p>
<ol start="20">
<li><p>In the navigation pane on the left, under <strong>General settings</strong>, choose <strong>App clients</strong>.</p></li>
<li><p>Save the <strong>App client id</strong> in the form of xxxxxxxxxxxxxxxxxxxxxxxxxx information into the same file. Make sure to note that it is for the <strong>Amazon Cognito App client id</strong>.</p></li>
</ol>
<h3>Task 3.2: (.NET) - Creating a User for the Amazon Cognito User Pool</h3>

<p>In this task, you will create and confirm an Amazon Cognito user by using the Linux Dev Instance. The Amazon Cognito user is used to test the end to end application.</p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> You could connect to your Windows Dev Instance and open a PowerShell session to complete this step. However, to show another option, you will connect to the Linux Dev Instance using Amazon EC2 Instance Connect. It will connect you to a web-based ssh session.</p>
<ol start="22">
<li>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>EC2</strong>.</li>
<li>Choose <strong>Instances</strong>.</li>
<li>Select <i class="far fa-check-square" style="color:#0073bb;"></i>  <strong>Linux Instance Dev</strong> and then choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;"> Connect</span>
</li>
<li>Select the <strong>EC2 Instance Connect</strong> tab.</li>
<li>Ensure the <strong>User name</strong> field is set to <input readonly class="copyable-inline-input" size="8" type="text" value="ec2-user">.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Connect</strong></span>
</li>
</ol>
<p><i class="fas fa-keyboard"></i> In the following command, change <strong>change-me_app-client-id</strong> with the value of the <strong>App client id</strong> that you copied to a file earlier and then, run the command:</p>
<pre class="highlight shell"><code>aws cognito-idp sign-up --client-id change-me_app-client-id --username student --password student&#x000A;</code></pre>
<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> <strong>Expected output:</strong></p>

<p><span style="font-family:Courier;">{<br><br>
    "UserConfirmed": false,<br><br>
    "UserSub": "abc70c2f-52v7-4abc-c195-012abc8560ab"<br><br>
}<br>
</span></p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> The values in the output should show your specific configuration.</p>

<p>You have now created a user in Amazon Cognito with the username <input readonly class="copyable-inline-input" size="7" type="text" value="student"> and a password of <input readonly class="copyable-inline-input" size="7" type="text" value="student">. Even though this isn't secure, you are using a simple username and password for simplicity during testing.</p>
<ol start="28">
<li>Next, confirm the user that you created. You will need to change <strong>change-me_pool-id</strong> with the value of the <strong>Pool Id</strong> that you copied to a file earlier.</li>
</ol>
<p><i class="fas fa-keyboard"></i> To confirm the user, enter the following command:</p>
<pre class="highlight shell"><code>aws cognito-idp admin-confirm-sign-up --user-pool-id change-me_pool-id --username student&#x000A;</code></pre><ol start="29">
<li>Go back to the <strong>Amazon Cognito</strong> console, choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Manage User Pools</span>
</li>
<li>Under <span style="color:#0073bb;">User Pools</span> choose <span style="color:#0073bb;"><strong>PollyNotesPool</strong></span>.</li>
<li>Under <strong>General settings</strong>, choose <strong>Users and groups</strong>.</li>
</ol>
<p>You should see the username <span style="color:#0073bb;">student</span> and the status is <strong>CONFIRMED</strong>. If you do not see it, choose <i class="fas fa-sync" style="color:#0073bb;"></i> to refresh the browser.</p>

<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> Congratulations! You have successfully created an Amazon Cognito User Pool, manually added a user, and confirmed that user.</p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i>  Normally, the sign-up process would be done via the application. However, the application that you are using doesn't provide such a function. So instead, it is manually created.</p>

<h2 id="step10">Task 4: (.NET) - Creating a DynamoDB table</h2>

<p>In this task, you will create a table in DynamoDB called <strong>pollynotes</strong>. This table is going to be used to store your user id, along with your notes.</p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram2-2020.png" alt="Lab 6 Diagram"></p>
<ol start="32">
<li><p>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>DynamoDB</strong>.</p></li>
<li><p>Choose the <strong>Tables</strong> link on the navigation menu on the left side.</p></li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Verify that you are in the <strong>correct region</strong>. If you are unsure of the region, you can see it identified in the <strong>Lab Information</strong> section to the left of these instructions.</p>

<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> The entries below are case sensitive, make sure that you copy and paste the entries from the lab console.</p>
<ol start="34">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create table</span> and fill in the values below:</li>
</ol><ul>
<li><p><strong>Table name:</strong> <input readonly class="copyable-inline-input" size="10" type="text" value="pollynotes"></p></li>
<li><p><strong>Partition key:</strong> <input readonly class="copyable-inline-input" size="6" type="text" value="userId"> <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">string <i class="fas fa-caret-down"></i></span></p></li>
<li><p><strong>Sort key:</strong> <input readonly class="copyable-inline-input" size="6" type="text" value="noteId"> <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">string <i class="fas fa-caret-down"></i></span></p></li>
<li><p><strong>Settings:</strong>  <i class="fas fa-dot-circle" style="color:#0073bb;"></i> Default settings</p></li>
</ul><ol start="35">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create table</span>
</li>
</ol>
<p>It may take up to 15 seconds for the DynamoDB table to be created. There will be a spinning loading logo next to your table name. Wait for that to disappear before moving to the next step.</p>
<ol start="36">
<li>From the left of your screen choose <strong>Items</strong> &gt; <i class="fas fa-dot-circle" style="color:#0073bb;"></i> pollynotes &gt; <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create item</span>
</li>
</ol><ul>
<li><p>In the <strong>VALUE</strong> field next to <strong>userId</strong>, enter: <input readonly class="copyable-inline-input" size="8" type="text" value="testuser"></p></li>
<li><p>In the <strong>VALUE</strong> field next to <strong>noteId</strong>, enter: <input readonly class="copyable-inline-input" size="3" type="text" value="001"></p></li>
</ul><ol start="37">
<li>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Add new attribute <i class="fas fa-caret-down"></i></span> &gt; <strong>String</strong> &gt; update <strong>NewValue</strong> to <input readonly class="copyable-inline-input" size="4" type="text" value="note">.</li>
</ol><ul>
<li>In the <strong>VALUE</strong> field next to <strong>note</strong>, enter: <input readonly class="copyable-inline-input" size="17" type="text" value="My note to myself">
</li>
</ul><ol start="38">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create item</span>
</li>
</ol>
<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> <strong>Example:</strong></p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/newItem.png" alt="Expected Output"></p>
<ol start="39">
<li>Create a few more items by going through the <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create item</span> process again.</li>
</ol>
<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> <strong>Example:</strong></p>
<ul>
<li>Your next <strong>noteId</strong> should be <input readonly class="copyable-inline-input" size="3" type="text" value="002">, then <input readonly class="copyable-inline-input" size="3" type="text" value="003">, and more.</li>
<li>The <strong>userId</strong> should always be <input readonly class="copyable-inline-input" size="8" type="text" value="testuser">.</li>
<li>The <strong>note</strong> can be anything that you would like, but beware that it will be recited back by Amazon Polly at some point.</li>
</ul>
<h3>Task 5: (.NET) - Creating Amazon S3 buckets</h3>

<p>In this task, you will create two Amazon S3 buckets:</p>
<ul>
<li>A website bucket which will host your front end website.</li>
<li>An MP3 bucket which will store your MP3 files.</li>
</ul>
<p>You will only be creating the buckets in this section and you will configure them in a later step.</p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram3-2020.png" alt="Lab 6 Diagram"></p>
<ol start="40">
<li>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>Amazon S3</strong>.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> You can see that the region is Global. This is because Amazon S3 does not require region selection. However, Amazon S3 creates buckets in a region you specify. When creating your buckets, select the correct region based on what you noted before. If you are unsure of the region, you can verify it in the <strong>Lab Information</strong> section to the left of these instructions.</p>

<h3>Task 5.1: (.NET) - Create the Web Bucket</h3>
<ol start="41">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create bucket</span></p></li>
<li><p><strong>Bucket name:</strong> (all lowercase): <input readonly class="copyable-inline-input" size="38" type="text" value="polly-notes-web-&lt;firstname&gt;-&lt;lastname&gt;"></p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> For example, if your name is John Smith, your bucket name would be <strong>polly-notes-web-john-smith</strong>.</p>
<ol start="43">
<li><p>Make sure that the <strong>Region</strong> field is set to the appropriate region that you have noted earlier.</p></li>
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create bucket</span></p></li>
</ol>
<h3>Task 5.2: (.NET) - Create the MP3 Bucket</h3>

<p>In this task you will create another Amazon S3 bucket to hold the Amazon Polly audio files.</p>
<ol start="45">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create bucket</span></p></li>
<li><p><strong>Bucket name:</strong> (all lowercase): <input readonly class="copyable-inline-input" size="38" type="text" value="polly-notes-mp3-&lt;firstname&gt;-&lt;lastname&gt;"></p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> For example, if your name is John Smith, your bucket name would be <strong>polly-notes-mp3-john-smith</strong>.</p>
<ol start="47">
<li><p>Make sure that the <strong>Region</strong> field is set to the appropriate region that you have noted earlier.</p></li>
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create bucket</span></p></li>
</ol>
<h2 id="step11">Task 6: (.NET) - Reviewing an IAM Managed Policy and Creating an IAM Role</h2>

<p>In this task, you will review an IAM Managed Policy and create an IAM Role to allow your Lambda functions to:</p>
<ul>
<li>Perform CRUD operations on DynamoDB.</li>
<li>Call the Amazon Polly API.</li>
<li>Perform the PUT operation on Amazon S3 for the MP3.</li>
<li>Log events to CloudWatch.</li>
</ul>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram3b-2020.png" alt="Lab 6 Diagram"></p>
<ol start="49">
<li>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>IAM</strong>.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> You can see that the region is Global. IAM does not require region selection because it's a global service.</p>

<h3>Task 6.1: (.NET) - Review an IAM Policy</h3>
<ol start="50">
<li><p>To save time the <strong>lambda_ddb_s3_polly</strong> managed policy has already been created.</p></li>
<li><p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> The policy includes the following permissions:</p></li>
</ol>
<p><span style="font-family:Courier;">{<br><br>
  "Version": "2012-10-17",<br><br>
  "Statement": [<br><br>
    {<br><br>
      "Effect": "Allow",<br><br>
      "Action": [<br><br>
        "dynamodb:DeleteItem",<br><br>
        "dynamodb:GetItem",<br><br>
        "dynamodb:PutItem",<br><br>
        "dynamodb:Query",<br><br>
        "dynamodb:UpdateItem",<br><br>
        "dynamodb:DescribeTable",<br><br>
        "polly:SynthesizeSpeech",<br><br>
        "s3:PutObject",<br><br>
        "s3:GetObject",<br><br>
        "logs:CreateLogGroup",<br><br>
        "logs:CreateLogStream",<br><br>
        "logs:PutLogEvents"<br><br>
      ],<br><br>
      "Resource": ["*"]<br><br>
    }<br><br>
  ]<br><br>
}<br>
</span></p>

<h3>Task 6.2: (.NET) - Creating an IAM role</h3>

<p>In this task, you will create an IAM Role called <strong>PollyNotesRole</strong> and attach the <strong>lambda_ddb_s3_polly</strong> policy to it. This Role will be used by the Lambda functions in the next sections. This IAM role allows you to delegate access with defined permissions in the above policy to trusted entities without having to hard code your credentials in your code.</p>
<ol start="52">
<li><p>In the navigation pane, choose <strong>Roles</strong>, and then choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create role</span></p></li>
<li><p>Under <strong>Select type of trusted entity</strong>, choose <i class="fas fa-cube" style="color:#0073bb;"></i> <strong>AWS service</strong>.</p></li>
<li><p>Go to the <strong>Choose a use case</strong> section. Choose <span style="color:#0073bb;">Lambda</span>, and then choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Next: Permissions</span></p></li>
<li><p>In the <strong>Search</strong> field, enter: <input readonly class="copyable-inline-input" size="19" type="text" value="lambda_ddb_s3_polly"></p></li>
<li><p>Select the <span style="color:#0073bb;"><i class="far fa-check-square"></i> <strong>lambda_ddb_s3_polly</strong></span> policy.</p></li>
<li><p>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Next: Tags</span></p></li>
<li><p>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Next: Review</span></p></li>
<li><p>For <strong>Role name</strong>, enter: <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesRole"></p></li>
<li><p>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create role</span></p></li>
</ol>
<p>You should see a message reading:</p>

<p><i class="fas fa-check-circle" style="color:green;"></i> <span style="color:green;">The role</span><span style="color:#0073bb;"> <strong>PollyNotesRole</strong></span> <span style="color:green;">has been created</span></p>

<h2 id="step12">Task 7: (.NET) - Creating the Lambda ListFunction</h2>

<p>In this task, you will create your Lambda ListFunction. To do this, you edit the <em>ListFunction.sln</em> file.</p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram4-2020.png" alt="Lab 6 Diagram"></p>

<h3>Task 7.1: (.NET) - Getting to the ListFunction code</h3>
<ol start="61">
<li>From the <strong>Windows Dev Instance</strong>, open <strong>Visual Studio</strong> using the desktop icon.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#d13212;"></i> While you can open Visual Studio by opening the solution file itself, you are directed to opening Visual Studio from the desktop icon because it does other tasks behind the scenes to allow this lab to function without errors.</p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> When prompted with the <strong>Welcome</strong> window, select <strong><span style="color:#0073bb;">Not now, maybe later</span></strong> and then select <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;white-space:nowrap;">Start Visual Studio</span></p>
<ol start="62">
<li>Choose <strong>Open a project or solution</strong> &gt; navigate to <input readonly class="copyable-inline-input" size="29" type="text" value="C:\temp\workdir\lab6CSharpLab"> folder and open the file <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotes.sln">
</li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> Before you can get started, you need to update all <strong>AWS NuGet</strong> packages. Open the context menu for the <strong>Solution PollyNotes</strong> project &gt; <strong>Manage Nuget Packages for Solution...</strong> &gt; <strong>Updates</strong> &gt; check all for <strong>AWS</strong> packages &gt; choose <strong>Update</strong> &gt; agree to any questions asked &gt; once updated close the NuGet manager.</p>

<p>There are many projects inside of this solution. For this specific Lambda function, you will focus on the following two:</p>
<ul>
<li>
<strong>ListFunction</strong>: The project that you will use to develop the ListFunction Lambda function.</li>
<li>
<strong>ListFunctionSolution</strong>: The solution of the ListFunction that you will develop. You can use this for reference.</li>
</ul><ol start="63">
<li>Open the file <strong>ListFunction.cs</strong> under the ListFunction project.</li>
</ol>
<p>It may seem that there is a lot of code already written for you. However, you will quickly realize that only the structure for the Lambda function has been created so that you don't have to spend much time on this.</p>
<ol start="64">
<li>Take a look at the current code to get a better understanding. Examine the following:</li>
</ol><ul>
<li>The function call that you will develop is called <strong>FunctionHandler</strong>.</li>
<li>The <strong>FunctionHandler</strong> takes in the Note as a first argument. The <em>context</em> argument isn't used here.</li>
<li>The other function is a Main() which will be used to test your function once it is coded. You can look at it to understand that only a userId is being passed to your <strong>FunctionHandler()</strong> function. That Main is serializing JSON into a Note and passing it to your FunctionHandler.</li>
</ul>
<h3>Task 7.2: (.NET) - Coding the ListFunction</h3>
<ol start="65">
<li>It is now time for you to code! You will need to edit the <strong>ListFunction.cs</strong> under the <strong>FunctionHandler</strong> only.</li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> If you would rather not code and just use the Solution file, skip to <a href="#task73link" target="_self">Task 7.3</a></p>
<ul>
<li><p>Your goal is to develop a Lambda function that will receive a userId as an input and return a list of Note objects.</p></li>
<li><p>.NET Core is a strong type language which means that receiving JSON isn't as easy to parse as some other languages. Instead, Lambda and .NET work together to deserialize the JSON payload into an object.</p></li>
<li><p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> The input from Lambda will look similar to the following:</p></li>
</ul>
<p><span style="font-family:Courier;">{<br><br>
  "userId": "testuser"<br><br>
}<br>
</span></p>
<ul>
<li>It may look difficult to parse at first glance. However, .NET Core will do the work for you by serializing this JSON into a Note object that will have its userId property set and that you receive as an argument to your Lambda function as you can see in the function that you need to develop.</li>
</ul><pre class="highlight csharp"><code><span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Note</span><span class="p">&gt;</span> <span class="nf">FunctionHandler</span><span class="p">(</span><span class="n">Note</span> <span class="n">note</span><span class="p">,</span> <span class="n">ILambdaContext</span> <span class="n">context</span><span class="p">)</span>&#x000A;</code></pre><ul>
<li>
<i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> The output that Lambda is expecting is a List of Notes that should be similar to the following:</li>
</ul>
<p><span style="font-family:Courier;">[<br><br>
     {<br><br>
            "userId": "testuser",<br><br>
            "noteId": "001",<br><br>
            "note": "My note to myself"<br><br>
      },<br><br>
      {<br><br>
            "userId": "testuser",<br><br>
            "noteId": "002",<br><br>
            "note": "This is a really cool lab."<br><br>
      }<br><br>
]<br>
</span></p>

<p>This may sound like a challenge to return this kind of data. However, by returning a <input readonly class="copyable-inline-input" size="10" type="text" value="List&lt;Note&gt;">, the Lambda .NET Core will serialize the list of Note and output the above JSON data.</p>
<ul>
<li><p>Comments have been left in the code to give you some help. However, it is your responsibility to make good use of those comments or to do it on your own. There are many ways to Query DynamoDB and the Solution code makes use of the Object Persistence Model that was discussed in the class. You should take a look at the following:</p></li>
<li><p><i class="fas fa-info-circle" style="color:#00a1c9;"></i> <a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DynamoDBContext.QueryScan.html" target="_blank">Query and Scan</a></p></li>
<li><p><i class="fas fa-info-circle" style="color:#00a1c9;"></i> <a href="https://docs.aws.amazon.com/sdkfornet/v3/apidocs/items/DynamoDBv2/MDynamoDBContextQueryAsyncObjectQueryOperatorIEnumerable!Object!DynamoDBOperationConfig.html" target="_blank">QueryAsync</a></p></li>
</ul>
<p>Because .NET Core can't use synchronous invocations of the C# SDK, you will have to rely on the Async functions for all of the calls to the APIs of AWS. This adds some complexity to the code as you will need to get a Task from the Async call and run a Wait() on that task. You will not be able to use the usual <strong>() =&gt;</strong> or await (unless you create another function).</p>

<p><i class="fas fa-info-circle" style="color:#00a1c9;"></i> Depending on the call you will make, the return value may be an <a href="https://docs.aws.amazon.com/sdkfornet/v3/apidocs/items/DynamoDBv2/TAsyncSearch%601.html" target="_blank">AsyncSearch</a>, which you can then convert into a Task by using the <a href="https://docs.aws.amazon.com/sdkfornet/v3/apidocs/items/DynamoDBv2/MAsyncSearch%601GetRemainingAsyncCancellationToken.html" target="_blank">GetRemainingAsync</a> call.</p>

<p>The return call of the Async calls Task mentioned is typically what you are looking for. For example, if you were to create a <input readonly class="copyable-inline-input" size="16" type="text" value="Task&lt;List&lt;Note&gt;&gt;"> from your query, you should be able to return the <input readonly class="copyable-inline-input" size="6" type="text" value="Result"> directly.</p>

<p>Overall, the work you have to do is to query DynamoDB to find all of the notes of the userId based on the <strong>note</strong> argument and return a <input readonly class="copyable-inline-input" size="10" type="text" value="List&lt;Note&gt;"> based on the response of your query. Good luck and remember that there is always a Solution file that can help you out! Once you think you have something working or would like to test things out, follow the next steps.</p>
<ol start="66">
<li><p>To test your code locally instead of having to upload your code to Lambda and invoke it from there. You will run the project as a Console program, which will call the <strong>Main()</strong> function. This will simulate a call to your Lambda handler with the userId <input readonly class="copyable-inline-input" size="8" type="text" value="testuser">. Even though this test runs locally, it's only your Lambda function that runs locally, your code is making an actual call to DynamoDB.</p></li>
<li><p>Make sure <strong>ListFunction</strong> is selected to be run (top of the screen).</p></li>
<li><p>Select <strong>Debug -&gt; Start Without Debugging</strong> or press <strong>Ctrl+F5</strong>. You can also troubleshoot by using breakpoints and running the code by using <strong>Debug -&gt; Start Debugging</strong> or <strong>F5</strong>. A Chrome browser window should open on <strong>localhost:5050</strong> which will simulate the Lambda console when testing a Lambda function.</p></li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#d13212;"></i> If an <strong>Internet Explorer</strong> browser window opens, this will cause the lab to stall. The workaround is to update the default browser to be set to Chrome. (Choose <strong>Start Menu</strong> &gt; type <strong>Default</strong> &gt; press <strong>Enter</strong> &gt; choose <strong>Default apps</strong> &gt; choose <strong>Web browser</strong> &gt; select <strong>Google Chrome</strong> &gt; close the <strong>Default Apps</strong> window)</p>

<p>It will automatically populate the following text boxes on your behalf. Make sure they match below:</p>
<ul>
<li>
<strong>Config File:</strong> aws-lambda-tools-defaults.json</li>
<li>
<strong>Function:</strong> PollyNotes-ListFunction</li>
<li>
<strong>AWS Credential Profile:</strong> developer</li>
<li>
<strong>AWS Region:</strong> <em>Update to match the value to the left of these instructions.</em>
</li>
</ul><ol start="69">
<li>No changes are needed for the <strong>Example Requests:</strong> drop-down list.</li>
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> Enter the following JSON test payload in the <strong>Function Input</strong> text box.</li>
</ol><pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testuser"</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre><ol start="71">
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;white-space:nowrap;">Execute Function</span>
</li>
</ol>
<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> <strong>Expected output:</strong></p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/notes-list-test.png" alt="Mock PollyNotes List Function results"></p>

<p>The output shows a listing all of the notes that you created in your DynamoDB table in prior steps. Your notes may differ from our example.</p>
<ol start="72">
<li>Close the <strong>Mock Lambda</strong> browser window and the <strong>dot-net-lambda-test-tool</strong> command prompt window.</li>
</ol>
<p><a id="task73link" target="_blank"></a></p>

<h3>Task 7.3: (.NET) - Upload your ListFunction to Lambda</h3>
<ol start="73">
<li><p>It is time to upload your Lambda function to AWS Lambda. To do so, you will use the <strong>AWS ToolKit</strong> that has been installed in Visual Studio. This simplifies the process instead of having to use the command line. What is done in the background for you is to create a ZIP of your code, creating the Lambda function by using the ZIP, and associating the IAM Role that you created earlier.</p></li>
<li><p><i class="far fa-compass" style="color:#dd6b10;"></i> Depending on if you are deploying your own code or the Solution code, you will need to open the context menu for the appropriate project:</p></li>
</ol><ul>
<li>
<i class="far fa-compass" style="color:#dd6b10;"></i> If you have coded your function, open the context menu on the <strong>ListFunction</strong> project in the Solution Explorer. Then, select <strong>Publish to AWS Lambda...</strong>
</li>
<li>
<i class="far fa-compass" style="color:#dd6b10;"></i> If you want to use the <strong>Solution Code</strong>, open the context menu on the <strong>ListFunctionSolution</strong> project in the Solution Explorer. Then, select <strong>Publish to AWS Lambda...</strong>
</li>
</ul>
<p><i class="fas fa-exclamation-triangle" style="color:#d13212;"></i> If you encounter an error uploading your Lambda function to Lambda, please confirm that on <strong>Step 73</strong> you opened <strong>Visual Studio 2017</strong> from the <strong>desktop icon</strong>. It is wrapped in a script to create the needed credentials on-the-fly. If you opened Visual Studio by opening the <input readonly class="copyable-inline-input" size="4" type="text" value=".sln"> file directly, those credentials do not get created and can lead to the error you may be facing.</p>
<ol start="75">
<li>For <strong>Region</strong>, select the Region value to the left of these instructions if not already set correctly.</li>
</ol>
<p>Note that everything else is pre-populated for you. This is due to the <em>aws-lambda-tools-defaults.json</em> file that has been set with the appropriate Function Name, Language Runtime, Framework, and more. You can take a look at this file once you are done creating the Lambda function.</p>
<ol start="76">
<li><p>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;white-space:nowrap;">Next</span></p></li>
<li><p>For <strong>Role Name</strong>, select <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesRole"></p></li>
<li><p>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;white-space:nowrap;">Upload</span></p></li>
</ol>
<p>You have now uploaded your Lambda function!</p>

<p>The next step is to test the Lambda function from the Lambda UI.</p>
<ol start="79">
<li>From the browser window you have opened to the <strong>AWS Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>Lambda</strong>.</li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> This lab uses the <i class="fas fa-toggle-on" style="color:#0073bb;"></i> <strong>Updated Lambda Console</strong>. If you are unsure which version you are using, simply choose the <i class="fas fa-bars"></i> icon in the top-left corner of the Lambda console and it will indicate if the <strong>Update Lambda Console</strong> option is on or off. If it shows <strong>off</strong>, select the toggle option to turn it on.</p>
<ol start="80">
<li><p>Choose the <strong>PollyNotes-ListFunction</strong> link. If you don't see your function, make sure that you are in the correct Region.</p></li>
<li><p>Choose the <strong>Test</strong> tab and make the following selections:</p></li>
</ol><ul>
<li>Under <strong>Test event</strong> choose <i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="9" type="text" value="New event">.</li>
<li>
<strong>Template:</strong> <input readonly class="copyable-inline-input" size="11" type="text" value="hello-world">
</li>
<li>
<strong>Event name</strong>, enter: <input readonly class="copyable-inline-input" size="8" type="text" value="ListTest">
</li>
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> Replace the JSON payload with the following:</li>
</ul><pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testuser"</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre><ol start="82">
<li><p>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save Changes</span></p></li>
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Test</span></p></li>
</ol>
<p>It is normal for it to take a little longer as this is the first time you are running your Lambda function.</p>
<ol start="84">
<li>There should be a green check mark just under the name of your Lambda function name with the message <em>Execution result: succeeded (logs)</em>. Choose <strong>Details</strong> and you should see the output of your Lambda function listing a few notes that you have created in the DynamoDB section.</li>
</ol>
<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> <strong>Example Output:</strong></p>

<p><span style="font-family:Courier;">[<br><br>
  {<br><br>
    "userId": "testuser",<br><br>
    "noteId": "001",<br><br>
    "note": "My note to myself"<br><br>
  },<br><br>
  {<br><br>
    "userId": "testuser",<br><br>
    "noteId": "002",<br><br>
    "note": "This is a really cool lab."<br><br>
  },<br><br>
  {<br><br>
    "userId": "testuser",<br><br>
    "noteId": "003",<br><br>
     "note": "By the end of this lab, I'll be ready for an ice-cold Dr Pepper."<br><br>
    }<br><br>
]<br>
</span></p>

<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> Congratulations! You have just created the <strong>PollyNotes-ListFunction</strong> that will act as your backend when a user will need to list their notes.</p>

<h2 id="step13">Task 8: (.NET) - Creating an API Gateway</h2>

<p>In this task, you will create a Restful API to front the back-end Lambda function. The API will use Amazon Cognito identities for authentication. For the application, you will be using the AWS API Gateway Service.</p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram5-2020.png" alt="Lab 6 Diagram"></p>
<ol start="85">
<li>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>API Gateway</strong>.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Verify that you are in the <strong>correct region</strong>. If you are unsure of the region, you can see it identified in the <strong>Lab Information</strong> section to the left of these instructions.</p>
<ol start="86">
<li>Under <strong>Choose an API type</strong>, select <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Build</span> from the <strong>REST API</strong> card.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> There is a similar option labeled as <strong>REST API Private</strong>. Please be mindful not to select this option.</p>
<ol start="87">
<li><p>In the <strong>Create your first API</strong> dialog box, choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">OK</span></p></li>
<li><p>Under <strong>Create new API</strong>, select <strong>New API</strong>.</p></li>
<li>
<p>Enter the following formation:</p>
<ul>
<li>
<strong>API name</strong>, enter: <input readonly class="copyable-inline-input" size="13" type="text" value="PollyNotesAPI">
</li>
<li>
<strong>Description</strong>, enter: <input readonly class="copyable-inline-input" size="13" type="text" value="PollyNotesAPI">
</li>
<li>
<strong>Endpoint Type</strong>, select <input readonly class="copyable-inline-input" size="8" type="text" value="Regional">.</li>
</ul>
</li>
<li><p>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create API</span></p></li>
</ol>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/create-api1.png" alt="Amazon Cognito Review Defaults"></p>

<h3>Task 8.1: (.NET) - Creating the Amazon Cognito Authorizer</h3>

<p>In this task, you create the Amazon Cognito Authorizer. The Authorizer will allow you to control access to the API with the Amazon Cognito User Pool.</p>
<ol start="91">
<li><p>In the left navigation menu, choose <strong>Authorizers</strong>.</p></li>
<li><p>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">+ Create New Authorizer</span></p></li>
<li>
<p>Enter the following information:</p>
<ul>
<li>
<strong>Name</strong>: <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesPool">
</li>
<li>
<strong>Type</strong>: <input readonly class="copyable-inline-input" size="7" type="text" value="Cognito">
</li>
<li>
<strong>Cognito User Pool</strong>: <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesPool">
</li>
<li>
<strong>Token Source</strong>: <input readonly class="copyable-inline-input" size="13" type="text" value="Authorization">
</li>
<li>
<strong>Token Validation</strong>: Leave empty.</li>
</ul>
</li>
<li><p>Choose <span style="color:#0073bb;"><strong>Create</strong></span></p></li>
</ol>
<h3>Task 8.2: (.NET) - Creating the resources</h3>

<p>In this task, you create your API Resources.</p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram5-2020.png" alt="Lab 6 Diagram"></p>
<ol start="95">
<li><p>In the navigation pane, choose <strong>Resources</strong>.</p></li>
<li><p>Under <strong>Resources</strong>, select <strong><span style="color:#0073bb;">/</span></strong>.</p></li>
<li><p>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Actions <i class="fas fa-caret-down"></i></span>, and then select <strong>Create Resource</strong>.</p></li>
<li><p>Under <strong>Resource Name</strong>, enter the following: <input readonly class="copyable-inline-input" size="5" type="text" value="notes"></p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> The <strong>Resource Path</strong> will will populate automatically with <strong>notes</strong>.</p>
<ol start="99">
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create Resource</span>
</li>
</ol>
<p>Now that you have created your resource, you need to create your Methods.  </p>

<h3>Task 8.3 (.NET) - Creating the API GET method</h3>
<ol start="100">
<li><p>If not already selected, choose the Resources link and select <strong><span style="color:#0073bb;">/notes</span></strong>.</p></li>
<li><p>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Actions <i class="fas fa-caret-down"></i></span>, and then select <strong>Create Method</strong>.</p></li>
<li><p>Select <strong>GET</strong> and then choose <i class="fas fa-check-circle"></i> (check mark tick).</p></li>
<li><p>For <strong>Integration type</strong>, select <i class="far fa-dot-circle" style="color:#0073bb;"></i> <strong>Lambda Function</strong>.</p></li>
<li><p>Under <strong>Lambda Function</strong>, type an uppercase <input readonly class="copyable-inline-input" size="1" type="text" value="P">, then select your Lambda <strong>PollyNotes-ListFunction</strong>.</p></li>
<li><p>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
<li><p>In the <strong>Add Permission to Lambda Function</strong> dialog box, choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">OK</span></p></li>
<li><p>Choose <span style="color:#0073bb;"><strong>Method Request</strong></span></p></li>
<li><p>In the <strong>Settings</strong> section, next to <strong>Authorization</strong>, choose <i class="fas fa-pencil-alt" style="color:#0073bb;"></i> (Edit).</p></li>
<li><p>Select <strong>PollyNotesPool</strong> and then, choose <i class="fas fa-check-circle"></i> (check mark tick).</p></li>
<li><p>In the breadcrumb, choose <span style="color:#0073bb;"><strong>&lt;- Method Execution</strong></span></p></li>
<li><p>Choose <span style="color:#0073bb;"><strong>Integration Request</strong></span></p></li>
<li><p>Expand the <i class="fas fa-caret-right"></i> <strong>Mapping Templates</strong> section.</p></li>
<li><p>Select <i class="far fa-dot-circle" style="color:#0073bb;"></i> <strong>When there are no templates defined (recommended)</strong>.</p></li>
<li><p>Under <strong>Content-Type</strong>, choose <i class="fas fa-plus-circle"></i> <span style="color:#0073bb;"><strong>Add mapping template</strong></span></p></li>
<li><p>Enter <input readonly class="copyable-inline-input" size="16" type="text" value="application/json"> and choose <i class="fas fa-check-circle"></i> (check mark tick).</p></li>
<li><p><i class="fas fa-file-code" style="color:#00a1c9;"></i> In the box that appeared below, enter the following:</p></li>
</ol><pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testuser"</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/jsonexample1.png" alt="jsonexample"></p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> You are hard coding the value of <em>userId</em> here so that when you do your first test from the web interface, you can see the original notes you have created in DynamoDB. Since you won't be creating the CreateUpdate Function until after doing your test, you would have no way to create a note for your user. The first step once you are done fully testing the List function, will be to change this mapping template to be dynamic based on the Amazon Cognito ID of the user login.</p>
<ol start="117">
<li><p>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Save</strong></span></p></li>
<li><p>Choose the <strong><span style="color:#0073bb;">/notes</span></strong> resource.</p></li>
<li><p>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Actions <i class="fas fa-caret-down"></i></span> and select <strong>Enable CORS</strong>.</p></li>
<li><p>Under <strong>Gateway Responses for PollyNotes API API</strong>, check option for <i class="far fa-check-square" style="color:#0073bb;"></i> <strong>DEFAULT 4XX</strong> and <i class="far fa-check-square" style="color:#0073bb;"></i> <strong>DEFAULT 5XX</strong>.</p></li>
<li><p>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Enable CORS and replace existing CORS headers</span></p></li>
<li><p>In the <strong>Confirm method changes</strong> dialog box, choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Yes, replace existing values</span></p></li>
<li>
<p>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Actions <i class="fas fa-caret-down"></i></span>, then select <strong>Deploy API</strong>. Make the following updates:</p>
<ul>
<li>
<strong>Deployment stage</strong>: <input readonly class="copyable-inline-input" size="11" type="text" value="[New Stage]">
</li>
<li>
<strong>Stage name</strong>: <input readonly class="copyable-inline-input" size="4" type="text" value="prod">
</li>
</ul>
</li>
<li><p>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Deploy</span></p></li>
<li><p>Copy the <strong>Invoke URL</strong> and paste it into a file. You will need it later in the lab.</p></li>
<li>
<p>In the prod Stage Editor, choose the <strong>Logs/Tracing</strong> tab and make the following updates:</p>
<ul>
<li>
<strong>CloudWatch Settings</strong>
<ul>
<li>
<strong>Enable CloudWatch Logs</strong> <i class="fas fa-check-square" style="color:#0073bb;"></i>
</li>
<li>
<strong>Log level</strong> <input readonly class="copyable-inline-input" size="4" type="text" value="INFO">
</li>
<li>
<strong>Log full requests/responses data</strong> <i class="fas fa-check-square" style="color:#0073bb;"></i>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save Changes</span></p></li>
</ol>
<h2 id="step14">Task 9: Creating the Front-End Website</h2>

<p>In this task, you create the front-end website.</p>
<ol start="128">
<li>Download and extract the following zip file:</li>
</ol>
<p><strong>Source file:</strong> <a href="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/scripts/polly-notes-web-bucket-root.zip" target="_blank">ZIP File</a></p>
<ol start="129">
<li>
<i class="fas fa-keyboard"></i> Modify the <em>main.bundle.js</em> file (lines 2-4) and change the following values:</li>
</ol><pre class="highlight javascript"><code><span class="c1">// Change the following 3 variable's value</span>&#x000A;<span class="kd">var</span> <span class="nx">API_GATEWAY_INVOKE_URL</span> <span class="o">=</span> <span class="s2">"https://your-api-url"</span>&#x000A;<span class="kd">var</span> <span class="nx">COGNITO_POOL_ID</span> <span class="o">=</span> <span class="s1">'us-east-1-xxxxxxxxxxx'</span>&#x000A;<span class="kd">var</span> <span class="nx">COGNITO_APP_CLIENT_ID</span> <span class="o">=</span> <span class="s1">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>&#x000A;</code></pre>
<p>You should have noted the needed values from prior lab steps. If you do not have details, you can get them by using the Console and the following paths:</p>
<ul>
<li><strong>Services -&gt; API Gateway -&gt; PollyNotesAPI -&gt; Stages -&gt; prod (API Gateway Invoke URL)</strong></li>
<li><strong>Services -&gt; Cognito -&gt; Manage User Pools -&gt; PollyNotesPool (Cognito Pool ID)</strong></li>
<li><strong>Services -&gt; Cognito -&gt; Manage User Pools -&gt; PollyNotesPool -&gt; App clients (Cognito App client ID)</strong></li>
</ul><ol start="130">
<li><p>Save the changes to the file.</p></li>
<li><p>Next, you need to enable CORS on the MP3 Bucket. When users access your website, they will be loading the website from the static Website bucket. Then, they will use javascript in their browser to connect to two different endpoints; API Gateway and the MP3 bucket. You already enabled CORS on the API Gateway, but you now need to enable CORS on your MP3 bucket, so that it can set response headers.</p></li>
<li><p>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>Amazon S3</strong>.</p></li>
<li><p>Choose your <input readonly class="copyable-inline-input" size="38" type="text" value="polly-notes-mp3-&lt;firstname&gt;-&lt;lastname&gt;"> bucket.</p></li>
<li><p>Choose the <strong>Permissions</strong> tab.</p></li>
<li><p>Navigate down to the <strong>Cross-origin resource sharing (CORS)</strong> section, then choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span></p></li>
<li><p><i class="fas fa-file-code" style="color:#00a1c9;"></i> Copy and paste the following JSON code into the text box, then choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save changes</span></p></li>
</ol><pre class="highlight json"><code><span class="p">[</span><span class="w">&#x000A;    </span><span class="p">{</span><span class="w">&#x000A;        </span><span class="s2">"AllowedHeaders"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">&#x000A;            </span><span class="s2">"*"</span><span class="w">&#x000A;        </span><span class="p">],</span><span class="w">&#x000A;        </span><span class="s2">"AllowedMethods"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">&#x000A;            </span><span class="s2">"GET"</span><span class="w">&#x000A;        </span><span class="p">],</span><span class="w">&#x000A;        </span><span class="s2">"AllowedOrigins"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">&#x000A;            </span><span class="s2">"*"</span><span class="w">&#x000A;        </span><span class="p">],</span><span class="w">&#x000A;        </span><span class="s2">"ExposeHeaders"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">&#x000A;    </span><span class="p">}</span><span class="w">&#x000A;</span><span class="p">]</span><span class="w">&#x000A;</span></code></pre><ol start="137">
<li>Next, go to your Website bucket. In the breadcrumb trail, choose <span style="color:#0073bb;"><strong>Amazon S3</strong></span>, and then, choose your <input readonly class="copyable-inline-input" size="38" type="text" value="polly-notes-web-&lt;firstname&gt;-&lt;lastname&gt;"> bucket.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Upload</span>
</li>
<li>Upload all the files and folders in the folder named <input readonly class="copyable-inline-input" size="27" type="text" value="polly-notes-web-bucket-root"> (not the folder itself) by dragging them onto the upload window.</li>
</ol>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/drag.png" alt="Dragging files into S3"></p>
<ol start="140">
<li><p>Move to the bottom of the screen, and choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Upload</span></p></li>
<li><p>Once the files and folders have uploaded successfully (32 total), choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Close</span></p></li>
</ol>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/files-example.png" alt="Amazon S3 website files and folders listing"></p>

<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> There should be a combined total of <strong>10 files and folders</strong> in the <strong>root</strong> of the <input readonly class="copyable-inline-input" size="38" type="text" value="polly-notes-web-&lt;firstname&gt;-&lt;lastname&gt;"> Amazon S3 bucket.</p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/tenfiles.png" alt="List of files in S3 bucket"></p>
<ol start="142">
<li>Choose the <strong>Permissions</strong> tab.</li>
<li>In the <strong>Block public access (bucket settings)</strong> card choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span>
</li>
<li>Unselect <i class="far fa-square"></i> <strong>Block</strong> <em>all</em> <strong>public access</strong>.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save changes</span>
</li>
<li>A confirmation box will appear; type <input readonly class="copyable-inline-input" size="7" type="text" value="confirm"> and choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Confirm</span>
</li>
<li>Move down to the <strong>Bucket policy</strong> card and choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span>
</li>
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> Copy and paste the following bucket policy into the <strong>Bucket policy</strong> field.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Ensure that you replace your bucket name.</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"Version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-10-17"</span><span class="p">,</span><span class="w">&#x000A;    </span><span class="s2">"Statement"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">&#x000A;        </span><span class="p">{</span><span class="w">&#x000A;            </span><span class="s2">"Sid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PublicReadGetObject"</span><span class="p">,</span><span class="w">&#x000A;            </span><span class="s2">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">&#x000A;            </span><span class="s2">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="p">,</span><span class="w">&#x000A;            </span><span class="s2">"Action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"s3:GetObject"</span><span class="p">,</span><span class="w">&#x000A;            </span><span class="s2">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:s3:::polly-notes-web-&lt;firstname&gt;-&lt;lastname&gt;/*"</span><span class="w">&#x000A;        </span><span class="p">}</span><span class="w">&#x000A;    </span><span class="p">]</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre><ol start="149">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save changes</span></p></li>
<li><p>The description of your bucket should now be flagged with <span style="background-color:#D90000;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Publicly accessible</span> and the <strong>Permissions overview</strong> card will read <strong>Access</strong> as<br>
<i class="fas fa-exclamation-triangle" style="color:#D90000;"></i> <span style="color:#D90000;">Public</span></p></li>
<li><p>Choose the <strong>Properties</strong> tab.</p></li>
<li><p>In the <strong>Static website hosting</strong> card, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span></p></li>
</ol>
<p>Configure the following settings:</p>
<ul>
<li>
<strong>Static website hosting:</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i> Enable</li>
<li>
<strong>Index document</strong>: <input readonly class="copyable-inline-input" size="10" type="text" value="index.html">
</li>
<li>
<strong>Error document:</strong> <input readonly class="copyable-inline-input" size="10" type="text" value="error.html">
</li>
</ul><ol start="153">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save changes</span></p></li>
<li><p>Move to the <strong>Static website hosting</strong> card and copy your <em>Bucket website endpoint</em> URL to a text editor.</p></li>
</ol>
<p>You will use this again in the lab.</p>

<h2 id="step15">Task 10: (.NET) - Testing the web application</h2>

<p>In this task, you test the web application by loading your Amazon S3 Hosted URL.</p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> You can obtain your Amazon S3 Hosted URL by going into the Amazon S3 Console. Select your web hosting bucket. Choose the <strong>Properties</strong> tab, and then choose, <strong>Static website hosting</strong>.</p>
<ol start="155">
<li>In a browser, enter your Static website hosting URL. You should be presented with a login page.</li>
</ol>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/pollynotes-loginpage.png" alt="Amazon Polly Notes Login Page"></p>
<ol start="156">
<li>Login with the following:</li>
</ol><ul>
<li>For <strong>UserName</strong>, enter: <input readonly class="copyable-inline-input" size="7" type="text" value="student">
</li>
<li>For <strong>Password</strong>, enter: <input readonly class="copyable-inline-input" size="7" type="text" value="student">
</li>
</ul><ol start="157">
<li>You should be presented with a page that looks like the following:</li>
</ol>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/pollynotes-homepage.png" alt="Polly Notes Login Page"></p>

<p>You should expect to see the notes you created earlier. All other functionality, such as adding notes, updating, deleting, or playing will not work. You need to create the API methods and Lambda functions to enable this functionality.</p>

<h2 id="step16">Task 11: (.NET) - Creating the remaining Lambda functions</h2>

<p>You have two options for the remaining Lambda functions:</p>
<ul>
<li>Take it easy on me! Use the Solution Code to create the rest of the Lambda functions.</li>
<li>Take the challenge! If you have time, create the other Lambda functions manually that interact with DynamoDB (Dictate, CreateUpdate, Search, and Delete). It is considered a challenge to complete this given the time provided for the lab.</li>
</ul>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram6-2020.png" alt="Lab 6 Diagram"></p>

<p>If you decide to take the challenge, the recommendation is to start by using the Solution Code and then go back to replace the functions with your own code to ensure you get to see the full application before spending more time coding.</p>

<h3>Task 11.1: (.NET) - Creating the Lambda DictateFunction</h3>

<p>In this task, you work with the Lambda DictateFunction. This function is already completely coded for you due to the length of this lab. This is why you will not find Solution Code for the Dictate function.</p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> This lab uses the <i class="fas fa-toggle-on" style="color:#0073bb;"></i> <strong>Updated Lambda Console</strong>.</p>
<ol start="158">
<li>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>Lambda</strong>.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create function</span> and make the following updates:</li>
</ol><ul>
<li>
<strong>Author from scratch</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i>
</li>
<li>
<strong>Function name:</strong> <input readonly class="copyable-inline-input" size="26" type="text" value="PollyNotes-DictateFunction">
</li>
<li>
<strong>Runtime:</strong> <em>.NET Core 3.1 (C#/PowerShell)</em>
</li>
<li>
<strong>Permissions:</strong>
<ul>
<li>Expand <i class="fas fa-caret-right"></i> <strong>Change default execution role</strong>.</li>
<li>
<strong>Execution role:</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i> <em>Use an existing role</em>
</li>
<li>
<strong>Existing role:</strong> <em>PollyNotesRole</em>
</li>
</ul>
</li>
</ul><ol start="160">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create function</span>
</li>
</ol>
<p>The lambda function page will be displayed with your function configuration.</p>
<ol start="161">
<li>Scroll to the right and select the <strong>Configuration</strong> tab. In the <strong>General Configuration</strong> card, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span>. In the window that appears, enter the following:</li>
</ol><ul>
<li>
<strong>Description</strong>: <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out">
</li>
</ul>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Due to the expansion of <strong>AWS Lambda states to all functions</strong> for the <strong>delayed update configuration mechanism</strong>, the <strong>Description</strong> requires the <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out"> value to be supplied. If this is not added, you will receive the following error when you try to update the function in later steps.</p>
<ul>
<li><strong><em>Failed to upload project to Lambda because of 409, ResourceConflictException.</em></strong></li>
</ul><ol start="162">
<li><p>Download the Solution Code for the Dictate function: <a href="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/scripts/PollyNotes-DictateFunction-Solution.zip" target="_blank">PollyNotes-DictateFunction-Solution</a>.</p></li>
<li><p>In the <strong>Code source</strong> section, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Upload from <i class="fas fa-caret-down"></i></span> ,  select <strong>.zip file</strong>, and then choose the <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;"><i class="fas fa-upload"></i> Upload</span> button. Select the local copy of the downloaded ZIP file named  <input readonly class="copyable-inline-input" size="39" type="text" value="PollyNotes-DictateFunction-Solution.zip"> and choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> You can ignore the notification in the <strong>Code source</strong> card reading, <em>The code editor does not support the .NET Core 3.1 (C#/PowerShell) runtime.</em>"</p>
<ol start="164">
<li>Navigate down to the <strong>Runtime settings</strong> card, click on <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span> and enter the following details:</li>
</ol><ul>
<li>
<strong>Handler</strong>: <input readonly class="copyable-inline-input" size="65" type="text" value="DictateFunction::DictateFunction.DictateFunction::FunctionHandler">
</li>
</ul><ol start="165">
<li><p>Click <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
<li><p>Choose the <strong>Configuration</strong> tab.</p></li>
<li><p>Choose <strong>Environment variables</strong> from the options on the left and then choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span></p></li>
<li><p>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Add environment variable</span></p></li>
<li><p>Add the following values:</p></li>
</ol><ul>
<li>
<strong>Key</strong>: <input readonly class="copyable-inline-input" size="15" type="text" value="MP3_BUCKET_NAME">
</li>
<li>
<strong>Value</strong>: <input readonly class="copyable-inline-input" size="38" type="text" value="polly-notes-mp3-&lt;firstname&gt;-&lt;lastname&gt;">. (Update with your bucket name.)</li>
</ul><ol start="170">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
<li><p>Now test the function. Choose the <strong>Test</strong> tab and configure the following fields under <strong>Test event</strong>:</p></li>
</ol><ul>
<li>
<i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="9" type="text" value="New event">
</li>
<li>
<strong>Template:</strong> <input readonly class="copyable-inline-input" size="11" type="text" value="hello-world">
</li>
<li>
<strong>Name:</strong> <input readonly class="copyable-inline-input" size="11" type="text" value="DictateTest">
</li>
</ul><ol start="172">
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> Replace the JSON payload with the following:</li>
</ol><pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"voiceId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Russell"</span><span class="p">,</span><span class="w">&#x000A;    </span><span class="s2">"note"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">&#x000A;        </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testuser"</span><span class="p">,</span><span class="w">&#x000A;        </span><span class="s2">"noteId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"001"</span><span class="w">&#x000A;    </span><span class="p">}</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre><ol start="173">
<li><p>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Save changes</span></p></li>
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Test</span></p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> It is normal for it to take a little longer as this is the first time you are running your Lambda function.</p>

<p>There should be a green check mark just under the name of your Lambda function name on the left indicating <em>Execution result: succeeded (logs)</em>.</p>
<ol start="175">
<li>Choose the <strong>Details</strong> link under that text. You should see the output of your Lambda function providing a very long URL to your MP3 bucket which represents a pre-signed URL.</li>
</ol>
<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> For example:</p>

<p><span style="font-family:Courier;">"<a href="https://polly-notes-mp3-%5C" target="_blank">https://polly-notes-mp3-\</a>-&lt;lastname&gt;.s3.amazonaws.com/testuser/001.mp3?X-Amz-Security-Token=..."<br>
</span></p>
<ol start="176">
<li>Copy and paste that URL in your browser to listen to Russell dictating your note!</li>
</ol>
<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> Congratulations! You have now created your Lambda Dictate function.</p>

<h3>Task 11.2: (.NET) - Creating the Lambda CreateUpdateFunction</h3>
<ol start="177">
<li>Choose the <span style="color:#0073bb;">Functions</span> bread crumb at the top of the page.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create function</span> and make the following updates:</li>
</ol><ul>
<li>
<strong>Author from scratch</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i>
</li>
<li>
<strong>Function name:</strong> <input readonly class="copyable-inline-input" size="31" type="text" value="PollyNotes-CreateUpdateFunction">
</li>
<li>
<strong>Runtime:</strong> <em>.NET Core 3.1 (C#/PowerShell)</em>
</li>
<li>
<strong>Permissions:</strong>
<ul>
<li>Expand <i class="fas fa-caret-right"></i> <strong>Change default execution role</strong>.</li>
<li>
<strong>Execution role:</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i> <em>Use an existing role</em>
</li>
<li>
<strong>Existing role:</strong> <em>PollyNotesRole</em>
</li>
</ul>
</li>
</ul><ol start="179">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create function</span>
</li>
</ol>
<p>The lambda function page will be displayed with your function configuration.</p>
<ol start="180">
<li>Scroll to the right and select the <strong>Configuration</strong> tab. In the <strong>General Configuration</strong> card, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span>. In the window that appears, enter the following:</li>
</ol><ul>
<li>
<strong>Description</strong>: <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out">
</li>
</ul>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Due to the expansion of <strong>AWS Lambda states to all functions</strong> for the <strong>delayed update configuration mechanism</strong>, the <strong>Description</strong> requires the <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out"> value to be supplied. If this is not added, you will receive the following error when you try to update the function in later steps.</p>
<ul>
<li><strong><em>Failed to upload project to Lambda because of 409, ResourceConflictException.</em></strong></li>
</ul><ol start="181">
<li><p>Download the Solution code for the Dictate function: <a href="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/scripts/PollyNotes-CreateUpdateFunction-Solution.zip" target="_blank">PollyNotes-CreateUpdateFunction-Solution</a>.</p></li>
<li><p>In the <strong>Code source</strong> section, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Upload from <i class="fas fa-caret-down"></i></span> ,  select <strong>.zip file</strong>, and then choose the <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;"><i class="fas fa-upload"></i> Upload</span> button. Select the local copy of the downloaded ZIP file named <input readonly class="copyable-inline-input" size="44" type="text" value="PollyNotes-CreateUpdateFunction-Solution.zip"> and choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> You can ignore the notification in the <strong>Code source</strong> card reading, <em>The code editor does not support the .NET Core 3.1 (C#/PowerShell) runtime.</em>"</p>
<ol start="183">
<li>Navigate down to the <strong>Runtime settings</strong> card, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span> and enter the following details:</li>
</ol><ul>
<li>
<strong>Handler:</strong> <input readonly class="copyable-inline-input" size="104" type="text" value="CreateUpdateFunctionSolution::CreateUpdateFunctionSolution.CreateUpdateFunctionSolution::FunctionHandler">
</li>
</ul><ol start="184">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
<li><p>Now test the function. Choose the <strong>Test</strong> tab and configure the following fields under <strong>Test event</strong>:</p></li>
</ol><ul>
<li>
<i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="9" type="text" value="New event">
</li>
<li>
<strong>Template:</strong> <input readonly class="copyable-inline-input" size="11" type="text" value="hello-world">
</li>
<li>
<strong>Name:</strong> <input readonly class="copyable-inline-input" size="16" type="text" value="CreateUpdateTest">
</li>
</ul><ol start="186">
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> Replace the JSON payload with the following:</li>
</ol><pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testuser"</span><span class="p">,</span><span class="w">&#x000A;    </span><span class="s2">"noteId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"001"</span><span class="p">,</span><span class="w">&#x000A;    </span><span class="s2">"note"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My very new note to myself"</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre><ol start="187">
<li><p>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Save changes</span></p></li>
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Test</span></p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> It is normal for it to take a little longer as this is the first time you are running your Lambda function.</p>

<p>There should be a green check mark just under the name of your Lambda function name on the left indicating <em>Execution result: succeeded (logs)</em>.</p>
<ol start="189">
<li>Choose the <strong>Details</strong> link under that text. You should see the output of your Lambda function providing the noteId that you just uploaded. For example, <input readonly class="copyable-inline-input" size="5" type="text" value='"001"'>. You can open the <strong>DynamoDB</strong> console to see the updated note.</li>
</ol>
<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> Congratulations! You have now created your Lambda CreateUpdate function.</p>

<h3>Task 11.3: (.NET) - Creating the Lambda SearchFunction</h3>
<ol start="190">
<li>Choose the <span style="color:#0073bb;">Functions</span> bread crumb at the top of the page.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create function</span> and make the following updates:</li>
</ol><ul>
<li>
<strong>Author from scratch</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i>
</li>
<li>
<strong>Function name:</strong> <input readonly class="copyable-inline-input" size="25" type="text" value="PollyNotes-SearchFunction">
</li>
<li>
<strong>Runtime:</strong> <em>.NET Core 3.1 (C#/PowerShell)</em>
</li>
<li>
<strong>Permissions:</strong>
<ul>
<li>Expand <i class="fas fa-caret-right"></i> <strong>Change default execution role</strong>.</li>
<li>
<strong>Execution role:</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i> <em>Use an existing role</em>
</li>
<li>
<strong>Existing role:</strong> <em>PollyNotesRole</em>
</li>
</ul>
</li>
</ul><ol start="192">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create function</span>
</li>
</ol>
<p>The lambda function page will be displayed with your function configuration.</p>
<ol start="193">
<li>Scroll to the right and select the <strong>Configuration</strong> tab. In the <strong>General Configuration</strong> card, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span>. In the window that appears, enter the following:</li>
</ol><ul>
<li>
<strong>Description</strong>: <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out">
</li>
</ul>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Due to the expansion of <strong>AWS Lambda states to all functions</strong> for the <strong>delayed update configuration mechanism</strong>, the <strong>Description</strong> requires the <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out"> value to be supplied. If this is not added, you will receive the following error when you try to update the function in later steps.</p>
<ul>
<li><strong><em>Failed to upload project to Lambda because of 409, ResourceConflictException.</em></strong></li>
</ul><ol start="194">
<li><p>Download the Solution Code for the Search function: <a href="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/scripts/PollyNotes-SearchFunction-Solution.zip" target="_blank">PollyNotes-SearchFunction-Solution</a></p></li>
<li><p>In the <strong>Function code</strong> section, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Actions <i class="fas fa-caret-down"></i></span> ,  select <strong>Upload a .zip file</strong>, and then choose the <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;"><i class="fas fa-upload"></i> Upload</span> button. Select the local copy of the downloaded ZIP file named <em>PollyNotes-SearchFunction-Solution.zip</em> and choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> You can ignore the notification in the <strong>Code source</strong> card reading, <em>The code editor does not support the .NET Core 3.1 (C#/PowerShell) runtime.</em>"</p>
<ol start="196">
<li>Scroll down to the <strong>Runtime settings</strong> card, click on <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span> and enter the following details.</li>
</ol><ul>
<li>
<strong>Handler</strong>, enter: <input readonly class="copyable-inline-input" size="86" type="text" value="SearchFunctionSolution::SearchFunctionSolution.SearchFunctionSolution::FunctionHandler">
</li>
</ul><ol start="197">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
<li><p>Now test the function. Choose the <strong>Test</strong> tab and configure the following fields under <strong>Test event</strong>:</p></li>
</ol><ul>
<li>
<i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="9" type="text" value="New event">
</li>
<li>
<strong>Template:</strong> <input readonly class="copyable-inline-input" size="11" type="text" value="hello-world">
</li>
<li>
<strong>Name:</strong> <input readonly class="copyable-inline-input" size="10" type="text" value="SearchTest">
</li>
</ul><ol start="199">
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> Replace the JSON payload with the following:</li>
</ol><pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testuser"</span><span class="p">,</span><span class="w">&#x000A;    </span><span class="s2">"note"</span><span class="p">:</span><span class="w"> </span><span class="s2">"very"</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre><ol start="200">
<li><p>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Save changes</span></p></li>
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Test</span></p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> It is normal for it to take a little longer as this is the first time you are running your Lambda function.</p>

<p>There should be a green check mark just under the name of your Lambda function name on the left indicating <em>Execution result: succeeded (logs)</em>.</p>
<ol start="202">
<li>Choose the <strong>Details</strong> link under that text.</li>
</ol>
<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> You should see the output of your Lambda function listing a note you just searched for using the <input readonly class="copyable-inline-input" size="4" type="text" value="very"> keyword that was just created in your previous CreateUpdateFunction.</p>

<p><span style="font-family:Courier;">[<br><br>
  {<br><br>
    "userId": "testuser",<br><br>
    "noteId": "001",<br><br>
    "note": "My very new note to myself"<br><br>
  }<br><br>
]<br>
</span></p>

<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> Congratulations! You have now created your Lambda Search function.</p>

<h3>Task 11.4: (.NET) - Creating the Lambda DeleteFunction</h3>
<ol start="203">
<li>Choose the <span style="color:#0073bb;">Functions</span> bread crumb at the top of the page.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create function</span> and make the following updates:</li>
</ol><ul>
<li>
<strong>Author from scratch</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i>
</li>
<li>
<strong>Function name:</strong> <input readonly class="copyable-inline-input" size="25" type="text" value="PollyNotes-DeleteFunction">
</li>
<li>
<strong>Runtime:</strong> <em>.NET Core 3.1 (C#/PowerShell)</em>
</li>
<li>
<strong>Permissions:</strong>
<ul>
<li>Expand <i class="fas fa-caret-right"></i> <strong>Change default execution role</strong>.</li>
<li>
<strong>Execution role:</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i> <em>Use an existing role</em>
</li>
<li>
<strong>Existing role:</strong> <em>PollyNotesRole</em>
</li>
</ul>
</li>
</ul><ol start="205">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create function</span>
</li>
</ol>
<p>The lambda function page will be displayed with your function configuration.</p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> If you see the following message in the <strong>Function code</strong> section, it can be ignored.</p>
<ol start="206">
<li>Scroll to the right and select the <strong>Configuration</strong> tab. In the <strong>General Configuration</strong> card, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span>. In the window that appears, enter the following:</li>
</ol><ul>
<li>
<strong>Description</strong>: <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out">
</li>
</ul>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Due to the expansion of <strong>AWS Lambda states to all functions</strong> for the <strong>delayed update configuration mechanism</strong>, the <strong>Description</strong> requires the <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out"> value to be supplied. If this is not added, you will receive the following error when you try to update the function in later steps.</p>
<ul>
<li><strong><em>Failed to upload project to Lambda because of 409, ResourceConflictException.</em></strong></li>
</ul><ol start="207">
<li><p>Download the Solution code for the Delete function: <a href="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/scripts/PollyNotes-DeleteFunction-Solution.zip" target="_blank">PollyNotes-DeleteFunction-Solution</a>.</p></li>
<li><p>In the <strong>Code source</strong> section, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Upload from <i class="fas fa-caret-down"></i></span> ,  select <strong>.zip file</strong>, and then choose the <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;"><i class="fas fa-upload"></i> Upload</span> button. Select the local copy of the downloaded ZIP file named  <input readonly class="copyable-inline-input" size="38" type="text" value="PollyNotes-DeleteFunction-Solution.zip"> and choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> You can ignore the notification in the <strong>Code source</strong> card reading, <em>The code editor does not support the .NET Core 3.1 (C#/PowerShell) runtime.</em>"</p>
<ol start="209">
<li>Navigate down to the <strong>Runtime settings</strong> card, click on <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span> and enter the following details:</li>
</ol><ul>
<li>
<strong>Handler</strong>, enter: <input readonly class="copyable-inline-input" size="86" type="text" value="DeleteFunctionSolution::DeleteFunctionSolution.DeleteFunctionSolution::FunctionHandler">
</li>
</ul><ol start="210">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
<li><p>Now test the function. Choose the <strong>Test</strong> tab and configure the following fields under <strong>Test event</strong>:</p></li>
</ol><ul>
<li>
<i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="9" type="text" value="New event">
</li>
<li>
<strong>Template:</strong> <input readonly class="copyable-inline-input" size="11" type="text" value="hello-world">
</li>
<li>
<strong>Name:</strong> <input readonly class="copyable-inline-input" size="10" type="text" value="DeleteTest">
</li>
</ul><ol start="212">
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> Replace the JSON payload with the following:</li>
</ol><pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testuser"</span><span class="p">,</span><span class="w">&#x000A;    </span><span class="s2">"noteId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"001"</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre><ol start="213">
<li><p>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Save changes</span></p></li>
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Test</span></p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> It is normal for it to take a little longer as this is the first time you are running your Lambda function.</p>

<p>There should be a green check mark just under the name of your Lambda function name on the left side of the screen with text mentioning: <em>Execution result: succeeded (logs)</em>.</p>
<ol start="215">
<li>Choose the <strong>Details</strong> link under that text. You should see the output of your Lambda function providing the noteId that you just deleted. For example, <input readonly class="copyable-inline-input" size="5" type="text" value='"001"'>. You can verify the note was delete in the <strong>DynamoDB</strong> console.</li>
</ol>
<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> Congratulations! You have now created your Lambda Delete function.</p>

<h2 id="step17">Task 12 (.NET) - Creating the remaining Restful API</h2>

<p>In this task, you create the remaining Restful API.</p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram-2020.png" alt="Lab 6 Diagram"></p>
<ol start="216">
<li>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>API Gateway</strong>.</li>
<li>Choose <strong><span style="color:#0073bb;">PollyNotesAPI</span></strong>.</li>
<li>Choose the <span style="color:#0073bb;">/notes/GET</span> method.</li>
<li>Choose <span style="color:#0073bb;">Integration Request</span>
</li>
<li>Navigate to the bottom and expand <i class="fas fa-caret-right"></i> <strong>Mapping Templates</strong>.</li>
<li>Choose <strong>application/json</strong>.</li>
<li>Navigate down and replace the mapping template with the following:</li>
</ol><pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$context.authorizer.claims.sub"</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> You are now removing the hard coded value of <em>testuser</em> to a variable that is dynamically populated based on your authorizer. In this case, the authorizer is Amazon Cognito. This means, <em>userId</em> will now be set to the value of the Amazon Cognito ID of the user login.</p>
<ol start="223">
<li><p>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
<li><p>Download the following Swagger file (API-Gateway-for-students-swagger.yaml):</p></li>
</ol>
<p><strong>Source file:</strong> <a href="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/scripts/API-Gateway-for-students-swagger.yaml" target="_blank">SWAGGER</a></p>
<ol start="225">
<li><p>Modify <strong>line 11</strong> of the file to replace it with your <strong>Amazon Cognito User Pool ARN</strong> (in between the quotes "").</p></li>
<li><p><strong>Save</strong> the file.</p></li>
<li><p>From the <strong>API Gateway</strong> console, choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Actions <i class="fas fa-caret-down"></i></span> and select <strong>Import API</strong>.</p></li>
<li><p>Scroll to the bottom of the page and change the <strong>Import mode</strong> to <strong>Merge</strong>.</p></li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#d13212;"></i> Be mindful not to select <input readonly class="copyable-inline-input" size="9" type="text" value="Overwrite">.</p>
<ol start="229">
<li><p>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Select Swagger File</span> and then select your saved Swagger file.</p></li>
<li><p>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Import</span></p></li>
</ol>
<p>The Swagger file will create the additional resources and methods for your API. You still need to integrate the Methods with your Lambda functions.</p>
<ol start="231">
<li>Choose the /<span style="color:#0073bb;">notes</span>/<span style="color:#6aaf35;">POST</span> method.</li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> If you encounter an error reading, <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;"><i class="fas fa-exclamation-circle" style="color:red;"></i> You do not have permission to perform this action.</span> you can ignore it.</p>

<p>The reason for this error is due to the swagger file specifying a mock function from another region. API Gateway tries to pull it up and returns the error because you do not have permissions to that region.</p>
<ol start="232">
<li>Choose <span style="color:#0073bb;"><strong>Integration Request</strong></span>
</li>
<li>For <strong>Lambda Region</strong>, choose <i class="fas fa-pencil-alt" style="color:#0073bb;"></i> (edit).</li>
<li>Select your <strong>Lambda Region</strong> based on what you have noted before and then, choose <i class="fas fa-check-circle"></i> (check mark tick).</li>
<li>For <strong>Lambda Function</strong>, type P and then select <strong>PollyNotes-CreateUpdateFunction</strong>. Choose <i class="fas fa-check-circle"></i> (check mark tick).</li>
<li>In the <strong>Add Permission to Lambda Function</strong> dialog box, make sure the Lambda function reflects the correct name.</li>
</ol><ul>
<li><p>If the name is correct, choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>OK</strong></span> to accept and allow invocation permissions to be created and your trigger to be setup.</p></li>
<li>
<p>If it reads as the <strong>Mock</strong> function name, we have to do a couple additional steps to workaround this UI issue.</p>
<ul>
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>OK</strong></span>.</li>
<li>Choose <strong>Resources</strong> link on the left to leave that section.</li>
<li>Next choose the appropriate method and select <strong>Integration Request</strong> and repeat the instructions as normal.</li>
<li>You should see that the region is set correctly but the <strong>Lambda Function</strong> is pointing to <strong>arn:aws:lambda:us-west-2:012345678901:function:Mock</strong> and needs to be updated.</li>
<li>
<i class="fas fa-sticky-note" style="color:#ec7211;"></i> There appears to be a bug with the API Gateway UI that causes this issue. It should be resolved soon. Until then, this is the workaround.</li>
</ul>
</li>
</ul><ol start="237">
<li>Repeat these steps for the remaining methods with the following mappings:</li>
</ol><ul>
<li>
<strong>/search/<span style="color:#0073bb;">GET</span></strong>     PollyNotes-SearchFunction</li>
<li>
<strong>/{id}/<span style="color:#d13212;">DELETE</span></strong>    PollyNotes-DeleteFunction</li>
<li>
<strong>/{id}/<span style="color:#6aaf35;">POST</span></strong>      PollyNotes-DictateFunction</li>
</ul><ol start="238">
<li>Once you have completed the steps for each of the above methods, complete the following:</li>
</ol><ul>
<li>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Actions <i class="fas fa-caret-down"></i></span> and select <strong>Deploy API</strong>.</li>
<li>Select the <span style="color:#0073bb;">prod</span> stage, and then, choose <strong>Deploy</strong>.</li>
</ul><ol start="239">
<li>
<i class="far fa-thumbs-up" style="color:#0073bb;"></i> Your API should now be fully functional.</li>
</ol>
<h2 id="step18">Task 13: (.NET) Testing the web application</h2>

<p>In this task, you test the web application by loading your Amazon S3 Hosted URL.</p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram-2020.png" alt="Lab 6 Diagram"></p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> You can obtain your Amazon S3 Hosted URL by going into the Amazon S3 Console. Select your web hosting bucket. Choose the <strong>Properties</strong> tab, and then choose, <strong>Static website hosting</strong>.</p>
<ol start="240">
<li>Test the application by exploring the functionality of the site. Test the add, delete, update, and search functions. Test that the voice options work correctly.</li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> Should you receive a backend server error, revisit the method integration steps and ensure the Lambda Function value is set correctly.</p>
<ul>
<li>If you find any that read as, <strong>arn:aws:lambda:us-west-2:012345678901:function:Mock/invocation</strong>, go back and update those methods to the correct Lambda Function name.</li>
</ul>
<p><a href="#troubleshooting" target="_self">A list of additional troubleshooting tips can be found here</a></p>

<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> Congratulations! You have completed developing the <strong>.NET</strong> version of this lab!</p>

<p>If you do not wish to complete the <strong>Java</strong> version of the lab, <a href="#end" target="_self">continue to the next step</a>.</p>

<p><a id="java" target="_blank"></a></p>

<h2 id="step19">Task 3: (Java) - Amazon Cognito Authentication</h2>

<p>The AWS SDK for Java simpliﬁes use of AWS Services by providing a set of libraries that are consistent and familiar for Java developers.</p>
<ul>
<li>
<i class="fas fa-info-circle" style="color:#00a1c9;"></i> <a href="https://aws.amazon.com/sdk-for-java" target="_blank">Learn more about the AWS SDK for Java</a>
</li>
</ul>
<p>In this task, you will:</p>
<ul>
<li>Create an Amazon Cognito user pool, which you are going to use to authenticate your end users and control access through API Gateway, making sure that your endpoint is secure.</li>
<li>Create and confirm an Amazon Cognito user using the Linux Dev Instance. The Amazon Cognito user is used to test the end to end application.</li>
</ul>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram1-2020.png" alt="Lab 6 Diagram"></p>

<p><i class="fas fa-info-circle" style="color:#00a1c9;"></i> For more information on Amazon Cognito User Pools, see: <a href="https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-identity-pools.html" target="_blank">Amazon Cognito User Pools</a></p>

<h3>Task 3.1: (Java) - Creating an Amazon Cognito user pool</h3>
<ol start="241">
<li>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>Cognito</strong>.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Verify that you are in the <strong>correct region</strong>. If you are unsure of the region, you can see it identified in the <strong>Lab Information</strong> section to the left of these instructions. Every service that is used in the lab (Amazon Cognito, API Gateway, Lambda, and DynamoDB) must be in the same region. Take a note of this region and every time the instructions prompt you to verify your region, make sure it is the same.</p>
<ol start="242">
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Manage User Pools</span>
</li>
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create a user pool</span>
</li>
<li>For <strong>Pool name</strong>, enter: <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesPool">
</li>
<li>For <strong>How do you want to create your user pool?</strong>, choose <span style="color:#0073bb;"><strong>Step through settings</strong></span>
</li>
<li>Go to the <strong>Which standard attributes do you want to require?</strong> section.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#d13212;"></i> This step can't be modified once the User Pool is created. To correct this, you would need to delete the current User Pool and create a new one.</p>
<ol start="247">
<li><p>Remove the checkbox next to <i class="far fa-square"></i> <strong>email</strong> and choose <span style="background-color:#329AD6;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Next step</span></p></li>
<li><p>In the <strong>What password strength do you want to require?</strong> section, you set the specifics required for the password. The password used is for testing purposes and you will be entering it many times so it has limited security settings.</p></li>
</ol>
<p>Make the following configuration:</p>
<ul>
<li>
<strong>Minimum length</strong> <input readonly class="copyable-inline-input" size="1" type="text" value="6">
</li>
</ul>
<p>Unselect the following options:</p>
<ul>
<li>
<i class="far fa-square"></i> <strong>Require numbers</strong>
</li>
<li>
<i class="far fa-square"></i> <strong>Require special character</strong>
</li>
<li>
<i class="far fa-square"></i> <strong>Require uppercase letters</strong>
</li>
<li>
<i class="far fa-square"></i> <strong>Require lowercase letters</strong>
</li>
</ul><ol start="249">
<li>Choose <span style="background-color:#329AD6;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Next step</span>
</li>
</ol>
<p>In the navigation menu on the left, you will find a list of all of the main steps for the creation of the Amazon Cognito User Pool. As many settings can stay as the defaults, you will skip ahead and go to the ones that need to be modified.</p>
<ol start="250">
<li>Choose <strong>App clients</strong>.</li>
<li>Choose <span style="color:#0073bb;"><strong>Add an app client</strong></span>
</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Make sure that you follow the next steps exactly as this configuration can't be undone. To correct, you would have to delete the current App client and create a new one.</p>
<ul>
<li>
<strong>App client name:</strong>  <input readonly class="copyable-inline-input" size="17" type="text" value="PollyNotesAngular">
</li>
<li>Unselect <i class="far fa-square"></i> <strong>Generate client secret</strong>.</li>
</ul><ol start="252">
<li>Choose <span style="background-color:#329AD6;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Create app client</span>
</li>
<li>In the navigation menu on the left, choose <strong>Review</strong> and review all of the settings.</li>
<li>Choose <span style="background-color:#329AD6;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Create pool</span>
</li>
<li>Save the <strong>Pool Id</strong> and the <strong>Pool ARN</strong> from your Amazon Cognito Pool information into a separate file for use later in this lab.</li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> Make sure to note that it is for <strong>Amazon Cognito Pool Id</strong> and <strong>Amazon Cognito Pool ARN</strong> as well.</p>

<p>For example, in the Oregon region, the <strong>Pool Id</strong> would look like <strong>us-west-2_XXXXXXXXX</strong> and the <strong>Pool ARN</strong> would look like <strong>arn:aws:cognito-idp:us-west-2:012345678901:userpool/us-west-2_XXXXXXXXX</strong>.</p>
<ol start="256">
<li><p>In the navigation pane on the left, under <strong>General settings</strong>, choose <strong>App clients</strong>.</p></li>
<li><p>Save the <strong>App client id</strong> in the form of xxxxxxxxxxxxxxxxxxxxxxxxxx information into the same file. Make sure to note that it is for the <strong>Amazon Cognito App client id</strong>.</p></li>
</ol>
<h3>Task 3.2: (Java) - Creating a user for the Amazon Cognito user pool</h3>

<p>In this task, you will create and confirm an Amazon Cognito user by using the Linux Dev Instance. The Amazon Cognito user is used to test the end to end application.</p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> You could connect to your Windows Dev Instance and open a PowerShell session to complete this step. However, to show another option, you will connect to the Linux Dev Instance using EC2 Instance Connect. It will connect you to a web-based ssh session.</p>
<ol start="258">
<li>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select  <strong>EC2</strong>.</li>
<li>Choose <strong>Instances</strong>.</li>
<li>Select <i class="far fa-check-square" style="color:#0073bb;"></i>  <strong>Linux Instance Dev</strong> and then choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;"> Connect</span>
</li>
<li>Select the <strong>EC2 Instance Connect</strong> tab.</li>
<li>Ensure the <strong>User name</strong> field is set to <input readonly class="copyable-inline-input" size="8" type="text" value="ec2-user">.</li>
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Connect</strong></span></p></li>
<li><p><i class="fas fa-keyboard"></i> Enter the following command, but make sure to change <strong>change-me_app-client-id</strong> with the value of the <strong>App client id</strong> that you copied to a file earlier:</p></li>
</ol><pre class="highlight shell"><code>aws cognito-idp sign-up --client-id change-me_app-client-id --username student --password student&#x000A;</code></pre>
<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i>  <strong>Expected output:</strong></p>

<p><span style="font-family:Courier;">{<br><br>
  "UserConfirmed": false,<br><br>
  "UserSub": "abc70c2f-52v7-4abc-c195-012abc8560ab"<br><br>
}<br>
</span></p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> The values in the output should show your specific configuration.</p>

<p>You have now created a user in Amazon Cognito with the username <input readonly class="copyable-inline-input" size="7" type="text" value="student"> and a password of <input readonly class="copyable-inline-input" size="7" type="text" value="student">. Even though this isn't secure, you are using a simple username and password for simplicity during testing.</p>
<ol start="265">
<li>Next, confirm the user that you created. You will need to change <strong>change-me_pool-id</strong> with the value of the <strong>Pool Id</strong> that you copied to a file earlier.</li>
</ol>
<p><i class="fas fa-keyboard"></i> To confirm the user, enter the following command:</p>
<pre class="highlight shell"><code>aws cognito-idp admin-confirm-sign-up --user-pool-id change-me_pool-id --username student&#x000A;</code></pre>
<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> If you don't see any output, it means that the command is successful and you can continue.</p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> If the EC2 Instance Connect SSH session stops responding, hit the browser refresh button to re-initialize it.</p>
<ol start="266">
<li>Go back to the <strong>Amazon Cognito</strong> console, choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Manage User Pools</span>
</li>
<li>Under <span style="color:#0073bb;">User Pools</span> choose <span style="color:#0073bb;"><strong>PollyNotesPool</strong></span>.</li>
<li>Under <strong>General settings</strong>, choose <strong>Users and groups</strong>.</li>
</ol>
<p>You should see the username <span style="color:#0073bb;">student</span> and the status is <strong>CONFIRMED</strong>. If you do not see it, choose <i class="fas fa-sync" style="color:#0073bb;"></i> to refresh the browser.</p>

<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> Congratulations! You have successfully created an Amazon Cognito User Pool, manually added a user, and confirmed that user.</p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> Normally, the sign-up process would be done via the application. However, the application that you are using doesn't provide such a function. So instead, it is manually created.</p>

<h2 id="step20">Task 4: (Java) - Creating a DynamoDB table</h2>

<p>In this task, you will create a table in DynamoDB called <strong>pollynotes</strong>. This table is going to be used to store your user id, along with your notes.</p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram2-2020.png" alt="Lab 6 Diagram"></p>
<ol start="269">
<li><p>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>DynamoDB</strong>.</p></li>
<li><p>Choose the <strong>Tables</strong> link on the navigation menu on the left side.</p></li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Verify that you are in the <strong>correct region</strong>. If you are unsure of the region, you can see it identified in the <strong>Lab Information</strong> section to the left of these instructions.</p>

<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> The entries below are case sensitive, make sure that you copy and paste the entries from the lab console.</p>
<ol start="271">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create table</span> and fill in the values below:</li>
</ol><ul>
<li><p><strong>Table name:</strong> <input readonly class="copyable-inline-input" size="10" type="text" value="pollynotes"></p></li>
<li><p><strong>Partition key:</strong> <input readonly class="copyable-inline-input" size="6" type="text" value="userId"> <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">string <i class="fas fa-caret-down"></i></span></p></li>
<li><p><strong>Sort key:</strong> <input readonly class="copyable-inline-input" size="6" type="text" value="noteId"> <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">string <i class="fas fa-caret-down"></i></span></p></li>
<li><p><strong>Settings:</strong>  <i class="fas fa-dot-circle" style="color:#0073bb;"></i> Default settings</p></li>
</ul><ol start="272">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create table</span>
</li>
</ol>
<p>It may take up to 15 seconds for the DynamoDB table to be created. There will be a spinning loading logo next to your table name. Wait for that to disappear before moving to the next step.</p>
<ol start="273">
<li>From the left of your screen choose <strong>Items</strong> &gt; <i class="fas fa-dot-circle" style="color:#0073bb;"></i> pollynotes &gt; <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create item</span>
</li>
</ol><ul>
<li><p>In the <strong>VALUE</strong> field next to <strong>userId</strong>, enter: <input readonly class="copyable-inline-input" size="8" type="text" value="testuser"></p></li>
<li><p>In the <strong>VALUE</strong> field next to <strong>noteId</strong>, enter: <input readonly class="copyable-inline-input" size="3" type="text" value="001"></p></li>
</ul><ol start="274">
<li>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Add new attribute <i class="fas fa-caret-down"></i></span> &gt; <strong>String</strong> &gt; update <strong>NewValue</strong> to <input readonly class="copyable-inline-input" size="4" type="text" value="note">.</li>
</ol><ul>
<li>In the <strong>VALUE</strong> field next to <strong>note</strong>, enter: <input readonly class="copyable-inline-input" size="17" type="text" value="My note to myself">
</li>
</ul><ol start="275">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create item</span>
</li>
</ol>
<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> <strong>Example:</strong></p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/newItem.png" alt="xpected Output"></p>
<ol start="276">
<li>Create a few more items by going through the <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create item</span> process again.</li>
</ol>
<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> <strong>Example:</strong></p>
<ul>
<li>Your next <strong>noteId</strong> should be <input readonly class="copyable-inline-input" size="3" type="text" value="002">, then <input readonly class="copyable-inline-input" size="3" type="text" value="003">, and more.</li>
<li>The <strong>userId</strong> should always be <input readonly class="copyable-inline-input" size="8" type="text" value="testuser">.</li>
<li>The <strong>note</strong> can be anything that you would like, but beware that it will be recited back by Amazon Polly at some point.</li>
</ul>
<h2 id="step21">Task 5: (Java) - Creating Amazon S3 buckets</h2>

<p>In this task, you will create three Amazon S3 buckets:</p>
<ul>
<li>A website bucket which will host your front end website.</li>
<li>An MP3 bucket which will store your MP3 files.</li>
<li>A code bucket used to store your Lambda functions as they are uploaded from the AWS ToolKit in Eclipse.</li>
</ul>
<p>You will only be creating the Amazon S3 buckets in this section and configuring them in a later step.</p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram3-2020.png" alt="Lab 6 Diagram"></p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> The diagram does not show the Code bucket since it is used to store your Lambda functions only.</p>
<ol start="277">
<li>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>Amazon S3</strong>.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> You can see that the region is Global. This is because Amazon S3 does not require region selection. However, Amazon S3 creates buckets in a region you specify. When creating your buckets, select the correct region based on what you noted before. If you are unsure of the region, verify the value with your instructor.</p>

<h3>Task 5.1: (Java) - Create the Web bucket</h3>
<ol start="278">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create bucket</span>
</li>
<li>
<strong>Bucket name:</strong> enter (all lowercase): <input readonly class="copyable-inline-input" size="38" type="text" value="polly-notes-web-&lt;firstname&gt;-&lt;lastname&gt;">
</li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> For example, if your name is John Smith, your bucket name would be <strong>polly-notes-web-john-smith</strong>.</p>
<ol start="280">
<li>Make sure that the <strong>Region</strong> field is set to the appropriate region that you have noted earlier.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create bucket</span>
</li>
</ol>
<h3>Task 5.2: (Java) - Create the MP3 bucket</h3>

<p>In this task you will create another Amazon S3 bucket to hold the Amazon Polly audio files.</p>
<ol start="282">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create bucket</span>
</li>
<li>
<strong>Bucket name:</strong> (all lowercase): <input readonly class="copyable-inline-input" size="38" type="text" value="polly-notes-mp3-&lt;firstname&gt;-&lt;lastname&gt;">
</li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> For example, if your name is John Smith, your bucket name would be <strong>polly-notes-mp3-john-smith</strong>.</p>
<ol start="284">
<li>Make sure that the <strong>Region</strong> field is set to the appropriate region that you have noted earlier.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create bucket</span>
</li>
</ol>
<h3>Task 5.3: (Java) - Create the Code bucket</h3>

<p>In this task you will create another Amazon S3 bucket to hold the java code.</p>
<ol start="286">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create bucket</span>
</li>
<li>
<strong>Bucket name:</strong> (all lowercase): <input readonly class="copyable-inline-input" size="39" type="text" value="polly-notes-code-&lt;firstname&gt;-&lt;lastname&gt;">
</li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> For example, if your name is John Smith, your bucket name would be <strong>polly-notes-code-john-smith</strong>.</p>
<ol start="288">
<li>Make sure the <strong>Region</strong> field is set to the appropriate region that you have noted earlier.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create bucket</span>
</li>
</ol>
<h2 id="step22">Task 6: Reviewing an IAM managed policy and creating an IAM role</h2>

<p>In this task, you will review an IAM Managed Policy and create an IAM Role to allow your Lambda functions to:</p>
<ul>
<li>Perform CRUD operations on DynamoDB.</li>
<li>Call the Amazon Polly API.</li>
<li>Perform the PUT operation on Amazon S3 for the MP3.</li>
<li>Log events to CloudWatch.</li>
</ul>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram3b-2020.png" alt="Lab 6 Diagram"></p>
<ol start="290">
<li>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>IAM</strong>.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> You can see that the region is Global. IAM does not require region selection because it's a global service.</p>

<h3>Task 6.1: (Java) - Review an IAM managed policy</h3>
<ol start="291">
<li>To save time the <strong>lambda_ddb_s3_polly</strong> managed policy has already been created.</li>
<li>
<i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> The policy includes the following permissions:</li>
</ol>
<p><span style="font-family:Courier;">{<br><br>
  "Version": "2012-10-17",<br><br>
   "Statement": [<br><br>
      {<br><br>
    "Effect": "Allow",<br><br>
    "Action": [<br><br>
    "dynamodb:DeleteItem",<br><br>
    "dynamodb:GetItem",<br><br>
    "dynamodb:PutItem",<br><br>
    "dynamodb:Query",<br><br>
    "dynamodb:UpdateItem",<br><br>
    "dynamodb:DescribeTable",<br><br>
    "polly:SynthesizeSpeech",<br><br>
    "s3:PutObject",<br><br>
    "s3:GetObject",<br><br>
    "logs:CreateLogGroup",<br><br>
    "logs:CreateLogStream",<br><br>
    "logs:PutLogEvents"<br><br>
    ],<br><br>
    "Resource": ["*"]<br><br>
    }<br><br>
  ]<br><br>
}<br>
</span></p>

<h3>Task 6.2: (Java) - Creating an IAM role</h3>

<p>In this task, you will create an IAM Role called <strong>PollyNotesRole</strong> and attach the <strong>lambda_ddb_s3_polly</strong> policy to it. This Role will be used by the Lambda functions in the next sections. This IAM role allows you to delegate access with defined permissions in the above policy to trusted entities without having to hard code your credentials in your code.</p>
<ol start="293">
<li>In the navigation pane, choose <strong>Roles</strong>, and then choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create role</span>
</li>
<li>Under <strong>Select type of trusted entity</strong>, choose <i class="fas fa-cube" style="color:#0073bb;"></i> <strong>AWS service</strong>.</li>
<li>Go to the <strong>Choose a use case</strong> section. Choose <span style="color:#0073bb;"><strong>Lambda</strong></span>, and then, choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Next: Permissions</span>
</li>
<li>In the <strong>Search</strong> field, enter: <input readonly class="copyable-inline-input" size="19" type="text" value="lambda_ddb_s3_polly">
</li>
<li><p>Select the <span style="color:#0073bb;"><i class="far fa-check-square"></i> <strong>lambda_ddb_s3_polly</strong></span> policy.</p></li>
<li><p>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Next: Tags</span></p></li>
<li><p>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Next: Review</span></p></li>
<li><p>For <strong>Role name</strong>, enter: <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesRole"></p></li>
<li><p>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create role</span></p></li>
</ol>
<p>You should see a message reading:</p>

<p><i class="fas fa-check-circle" style="color:green;"></i> <span style="color:green;">The role</span><span style="color:#0073bb;"> <strong>PollyNotesRole</strong></span> <span style="color:green;">has been created</span></p>

<h2 id="step23">Task 7: (Java) - Creating the Lambda ListFunction</h2>

<p>In this task, you will create your Lambda List function. To do this, you edit the <em>ListFunction.java</em> file.</p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram4-2020.png" alt="Lab 6 Diagram"></p>

<h3>Task 7.1: (Java) - Getting to the ListFunction code</h3>
<ol start="302">
<li><p>Return to the <strong>Windows Dev Instance</strong>.</p></li>
<li><p>Open <strong>Eclipse</strong> from the desktop icon.</p></li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#d13212;"></i> Use this icon to start <strong>Eclipse</strong> as it is wrapped in a script to query the instance metadata to create the <strong>credentials</strong> file only when needed for the AWS Toolkit for Java.</p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> It can take a few minutes for this to finish. It will then start building the development environment. Wait for this to finish. You can watch the progress by viewing the lower right corner of the screen.</p>
<ol start="304">
<li><p>In the <strong>Anonymous Collection of Analytics for using the AWS Toolkit</strong> dialog box, choose <strong>Finish</strong>.</p></li>
<li><p>Close the <strong>Welcome</strong> window.</p></li>
<li><p>Choose <strong>File</strong> &gt; <strong>Open Projects from File System</strong>.</p></li>
<li><p>For <strong>Import source</strong> choose <strong>Directory...* and navigate to `C:\temp\workdir\lab6JavaLab</strong> and choose <strong>OK</strong>.</p></li>
<li><p>Make sure under <strong>Folder</strong> the checkbox is selected next to <i class="far fa-check-square" style="color:black;"></i> <strong>lab6JavaLab</strong>.</p></li>
<li><p>Choose <strong>Finish</strong>.</p></li>
<li><p><i class="far fa-compass" style="color:#dd6b10;"></i> Open the context menu for the project name <strong>PollyNotes</strong>, select <strong>Maven</strong>, choose <strong>Update Project...</strong>, and choose <strong>OK</strong> in the next window. This should resolve any errors.</p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> To keep the project small, the dependencies haven't been downloaded yet so you need to do this task to rebuild the project and all its dependencies as a first step.</p>
<ol start="311">
<li>The PollyNotes project contains a few packages that are worth understanding for coding your ListFunction:</li>
</ol><ul>
<li>You will be editing the <em>ListFunction.java</em> file. In the Project Explorer, expand: <input readonly class="copyable-inline-input" size="63" type="text" value="PollyNotes &gt; src/main/java &gt; com.amazonaws.pollynotes.functions"> and you will find the <em>ListFunction.java</em> file there. This is the file that you will do all of your development in.</li>
<li>Under <input readonly class="copyable-inline-input" size="26" type="text" value="PollyNotes &gt; src/main/java">, the <strong>com.amazonaws.pollynotes.pojo</strong> package contains POJO classes that are used to receive the data in the handler for Lambda. The Note will also be used to use the Object Persistence Model for DynamoDB so you can do simple operations on the Note POJO which already contains Java Annotations mapping each attributes to the object. It is worth taking a look at it to understand what was done.</li>
<li>Under <input readonly class="copyable-inline-input" size="26" type="text" value="PollyNotes &gt; src/main/java">, the <strong>com.amazonaws.pollynotes.solution</strong> package contains the Solution files to all of the four functions you will be creating. Note that the DictateFunction is already built hence why it doesn't have a solution. You can refer to the solution if you get stuck. Although the code of those functions looks fairly long, it is only due to the amount of logging done in the function. The actual code is only a few lines.</li>
<li>Under <input readonly class="copyable-inline-input" size="26" type="text" value="PollyNotes &gt; src/test/java">, the <strong>com.amazonaws.pollynotes</strong> package contains JUnit test cases that you can use to validate that the functions you create works. This will help you test your functions locally without having to upload them to Lambda.</li>
</ul>
<h3>Task 7.2: (Java) - Coding the ListFunction</h3>
<ol start="312">
<li>It is now time for you to code! You will need to edit the <em>ListFunction.java</em>. If you would rather not code and just use the Solution file, skip to <a href="#task73javalink" target="_self">Task 7.3: Upload Your ListFunction to Lambda</a>.</li>
</ol>
<p>Your goal is to develop a Lambda function that will receive a userId as an input and return a list of Note objects.</p>

<p>Java is a strong type language which means that receiving JSON isn't as easy to parse as some other languages. Instead, Lambda and Java work together to deserialize the JSON payload into an object.</p>

<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> The input from Lambda will look similar to the following:</p>

<p><span style="font-family:Courier;">{<br>
  "userId": "testuser"<br>
}<br>
</span></p>
<ul>
<li>
<i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> It may look difficult to parse at first glance, however the Lambda Java core will do the work for you by serializing this JSON into a Note object that will have its userId property set and that you receive as an argument to your Lambda function as you can see in the function you need to develop below.</li>
</ul><pre class="highlight java"><code><span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Note</span><span class="o">&gt;</span> <span class="nf">handleRequest</span><span class="o">(</span><span class="n">Note</span> <span class="n">note</span><span class="o">,</span> <span class="n">Context</span> <span class="n">context</span><span class="o">)</span> <span class="o">...</span>&#x000A;</code></pre><ul>
<li>
<i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> The output that Lambda is an array of Note that should be similar to the following. This may sound like a challenge to return this kind of data. However, by returning a <input readonly class="copyable-inline-input" size="10" type="text" value="List&lt;Note&gt;">, the Lambda Java core will serialize the list of Note and output the above JSON data.</li>
</ul>
<p><span style="font-family:Courier;">[<br><br>
  {<br><br>
    "userId": "testuser",<br><br>
    "noteId": "001",<br><br>
    "note": "My note to myself"<br><br>
  },<br><br>
  {<br><br>
    "userId": "testuser",<br><br>
    "noteId": "002",<br><br>
    "note": "My new note to myself"<br><br>
  }<br><br>
]<br>
</span></p>
<ul>
<li>There are comments in the code to give you some help. However, it is your responsibility to make good use of those comments or to do it on your own. There are many ways to Query DynamoDB and the Solution Code makes use of the Object Persistence Model that was discussed in the class. You should take a look at the following:</li>
<li>
<i class="fas fa-info-circle" style="color:#00a1c9;"></i> <a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DynamoDBMapper.QueryScanExample.html" target="_blank">Query and Scan</a>
</li>
<li><p><i class="fas fa-info-circle" style="color:#00a1c9;"></i> <a href="https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/dynamodbv2/datamodeling/AbstractDynamoDBMapper.html#query-java.lang.Class-com.amazonaws.services.dynamodbv2.datamodeling.DynamoDBQueryExpression-com.amazonaws.services.dynamodbv2.datamodeling.DynamoDBMapperConfig-" target="_blank">Query</a></p></li>
<li><p>Overall, the work you have to do is to query DynamoDB to find all of the notes of the userId based on the <strong>note</strong> argument and return a <input readonly class="copyable-inline-input" size="10" type="text" value="List&lt;Note&gt;"> based on the response of your query. Good luck and remember that there is always a Solution file that can help you out! Once you think you have something working or would like to test things out, follow the next steps.</p></li>
</ul><ol start="313">
<li>To test your code locally instead of having to upload your code to Lambda and invoke it from there, you will run a JUnit test. This will simulate a call to your Lambda handler with the userId <input readonly class="copyable-inline-input" size="8" type="text" value="testuser">. Even though this test runs locally, it's only your Lambda function that runs locally, your code is making an actual call to DynamoDB.</li>
</ol>
<p>To test, complete the following steps:</p>
<ul>
<li><p>Open the file <strong>ListFunctionTest.java</strong> located in the <input readonly class="copyable-inline-input" size="40" type="text" value="src/test/java &gt; com.amazonaws.pollynotes"> package.</p></li>
<li><p>Inspect the code of the test, which will make you realize that you are making a call to the CreateUpdateFunctionSolution function. Since this is a ListFunction, you need to make sure that there is data in the DynamoDB table. First thing to do is to create an item. Then, run your freshly coded ListFunction and make sure that the <input readonly class="copyable-inline-input" size="10" type="text" value="List&lt;Note&gt;"> that is returned isn't empty.</p></li>
<li>
<p>Run the test.</p>
<ul>
<li>
<i class="far fa-compass" style="color:#dd6b10;"></i> Open the context menu for the <strong>ListFunctionTest.java</strong> file.</li>
<li>Select <strong>Debug As</strong> &gt; <strong>JUnit Test</strong>.</li>
</ul>
</li>
<li><p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> You should see the output of the <em>CreateUpdateFunctionSolution</em> and then the beginning of your function in the <strong>Console</strong> View. If the Test successfully completes, the <strong>JUnit</strong> view should be all green. You can continue troubleshooting by using breakpoints and running the prior step again.</p></li>
</ul>
<p><span style="font-family:Courier;">Initiating PollyNotes-CreateUpdateFunction...<br><br>
Note received: {userId: "testuser", noteId: "001", note: "This is a test"}<br><br>
Returning noteId: "001"<br><br>
Initiating PollyNotes-ListFunction...<br><br>
</span></p>

<p><a id="task73javalink" target="_blank"></a></p>

<h3>Task 7.3: (Java) - Upload Your ListFunction to Lambda</h3>

<p>In this task, you upload your Lambda function to Lambda. To do so, you will use the AWS ToolKit that has been installed in Eclipse. This simplifies the process instead of having to use the command line. What is done in the background is for you is to create a ZIP of your code, uploading it to your code Amazon S3 bucket, creating the Lambda function by using the ZIP, and associating the IAM Role you created earlier.</p>
<ol start="314">
<li>
<i class="far fa-compass" style="color:#dd6b10;"></i> In the Project Explorer, open the context menu for the folder <input readonly class="copyable-inline-input" size="13" type="text" value="src/main/java"> and select <i class="fas fa-cube" style="color:#eb5f07;"></i> <strong>Amazon Web Services &gt;&gt; Upload function to AWS Lambda...</strong>
</li>
<li>For <strong>Select the Handler</strong>, complete one of the following:</li>
</ol><ul>
<li>If you have coded your function, select <input readonly class="copyable-inline-input" size="47" type="text" value="com.amazonaws.pollynotes.functions.ListFunction">.</li>
<li>If you want to use the Solution Code, select <input readonly class="copyable-inline-input" size="54" type="text" value="com.amazonaws.pollynotes.solution.ListFunctionSolution">.</li>
</ul><ol start="316">
<li>For <strong>Select the AWS Region</strong>, select the region for your lab as you noted it before.</li>
<li>Select <strong>Create a new Lambda function</strong> and replace the value of the field next to it (containing MyFunction) with <input readonly class="copyable-inline-input" size="23" type="text" value="PollyNotes-ListFunction">.</li>
<li>Choose <strong>Next</strong>
</li>
<li>For <strong>IAM Role</strong>, select <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesRole">.</li>
<li>For <strong>S3 Bucket</strong>, select your code Amazon S3 Bucket: <input readonly class="copyable-inline-input" size="39" type="text" value="polly-notes-code-&lt;firstname&gt;-&lt;lastname&gt;">
</li>
<li>In the <strong>Memory (MB)</strong> field, replace the content with <strong>1024</strong> so that your Lambda function can start faster on the first load.</li>
<li>Choose <strong>Finish</strong>
</li>
</ol>
<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> You have now uploaded your Lambda function!</p>
<ol start="323">
<li><p>The next step is to test the Lambda function from the Lambda UI.</p></li>
<li><p>From the <strong>AWS Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>Lambda</strong>.</p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> This lab uses the <i class="fas fa-toggle-on" style="color:#0073bb;"></i> <strong>Updated Lambda Console</strong>. If you are unsure which version you are using, simply choose the <i class="fas fa-bars"></i> icon in the top-left corner of the Lambda console and it will indicate if the <strong>Update Lambda Console</strong> option is on or off. If it shows <strong>off</strong>, select the toggle option to turn it on.</p>
<ol start="325">
<li><p>Choose <strong>PollyNotes-ListFunction</strong>. If you don't see your function, make sure that you are in the correct Region.</p></li>
<li><p>Choose the <strong>Test</strong> tab and make the following selections under <strong>Test event:</strong></p></li>
</ol><ul>
<li>
<i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="9" type="text" value="New event">.</li>
<li>
<strong>Template:</strong> <input readonly class="copyable-inline-input" size="11" type="text" value="hello-world">
</li>
<li>
<strong>Event name</strong>, enter: <input readonly class="copyable-inline-input" size="8" type="text" value="ListTest">
</li>
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> Replace the JSON payload with the following:</li>
</ul><pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testuser"</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre><ol start="327">
<li><p>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save Changes</span></p></li>
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Test</span></p></li>
</ol>
<p>It is normal for it to take a little longer as this is the first time you are running your Lambda function.</p>
<ol start="329">
<li>There should be a green check mark just under the name of your Lambda function name with the message <em>Execution result: succeeded (logs)</em>. Choose <strong>Details</strong> and you should see the output of your Lambda function listing a few notes that you have created in the DynamoDB section.</li>
</ol>
<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> <strong>Expected Output:</strong></p>

<p><span style="font-family:Courier;">[<br><br>
  {<br><br>
    "userId": "testuser",<br><br>
    "noteId": "001",<br><br>
    "note": "My note to myself"<br><br>
  },<br><br>
  {<br><br>
    "userId": "testuser",<br><br>
    "noteId": "002",<br><br>
    "note": "My new note to myself"<br><br>
  }<br><br>
]<br>
</span></p>

<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> Congratulations! You have just created the List Lambda function that will act as your backend when a user will need to list their notes.</p>

<h2 id="step24">Task 8: (Java) - Creating the API Gateway</h2>

<p>In this task, you will create a Restful API to front the back-end Lambda function. The API will use Amazon Cognito identities for authentication. For the application, you will be using the AWS API Gateway Service.</p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram5-2020.png" alt="Lab 6 Diagram"></p>
<ol start="330">
<li>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>API Gateway</strong>.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Verify that you are in the <strong>correct region</strong>. If you are unsure of the region, you can see it identified in the <strong>Lab Information</strong> section to the left of these instructions.</p>
<ol start="331">
<li>Under <strong>Choose an API type</strong>, select <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Build</span> from the <strong>REST API</strong> card.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> There is a similar option labeled as <strong>REST API Private</strong>. Please be mindful not to select this option.</p>
<ol start="332">
<li>In the <strong>Create your first API</strong> dialog box, choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">OK</span>
</li>
<li>Under <strong>Create new API</strong>, select <strong>New API</strong>.</li>
<li>Enter the following formation:
<ul>
<li>
<strong>API name</strong>, enter: <input readonly class="copyable-inline-input" size="13" type="text" value="PollyNotesAPI">
</li>
<li>
<strong>Description</strong>, enter: <input readonly class="copyable-inline-input" size="13" type="text" value="PollyNotesAPI">
</li>
<li>
<strong>Endpoint Type</strong>, select <input readonly class="copyable-inline-input" size="8" type="text" value="Regional">.</li>
</ul>
</li>
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create API</span>
</li>
</ol>
<h3>Task 8.1: (Java) - Creating the Amazon Cognito Authorizer</h3>

<p>In this task, you create the Amazon Cognito Authorizer. The Authorizer will allow you to control access to the API with the Amazon Cognito User Pool.</p>
<ol start="336">
<li>In the left navigation menu, choose <strong>Authorizers</strong>.</li>
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">+ Create New Authorizer</span>
</li>
<li>
<p>Enter the following information:</p>
<ul>
<li>
<strong>Name</strong>: <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesPool">
</li>
<li>
<strong>Type</strong>: <input readonly class="copyable-inline-input" size="7" type="text" value="Cognito">
</li>
<li>
<strong>Cognito User Pool</strong>: <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesPool">
</li>
<li>
<strong>Token Source</strong>: <input readonly class="copyable-inline-input" size="13" type="text" value="Authorization">
</li>
<li>
<strong>Token Validation</strong>: Leave empty.</li>
</ul>
</li>
<li><p>Choose <span style="color:#0073bb;"><strong>Create</strong></span></p></li>
</ol>
<h3>Task 8.2: (Java) - Creating the resources</h3>

<p>In this task, you create your API Resources.</p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram5-2020.png" alt="Lab 6 Diagram"></p>
<ol start="340">
<li>In the navigation pane, choose <strong>Resources</strong>.</li>
<li><p>Under <strong>Resources</strong>, select <strong><span style="color:#0073bb;">/</span></strong>.</p></li>
<li><p>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Actions <i class="fas fa-caret-down"></i></span>, and then select <strong>Create Resource</strong>.</p></li>
<li><p>Under <strong>Resource Name</strong>, enter the following: <input readonly class="copyable-inline-input" size="5" type="text" value="notes"></p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> The <strong>Resource Path</strong> will will populate automatically with <strong>notes</strong>.</p>
<ol start="344">
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create Resource</span>
</li>
</ol>
<p>Now that you have created your resource, you need to create your Methods.  </p>

<h3>Task 8.3: (Java) - Creating the API GET method</h3>
<ol start="345">
<li>If not already selected, choose the <strong>Resources</strong> link and select <span style="color:#0073bb;"><strong>/notes</strong></span>
</li>
<li>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Actions <i class="fas fa-caret-down"></i></span>, and then select <strong>Create Method</strong>.</li>
<li><p>Select <strong>GET</strong> and then choose the <i class="fas fa-check-circle"></i> (check mark tick).</p></li>
<li><p>For <strong>Integration type</strong>, select <i class="far fa-dot-circle" style="color:#0073bb;"></i> <strong>Lambda Function</strong>.</p></li>
<li><p>Under <strong>Lambda Function</strong>, type an uppercase <input readonly class="copyable-inline-input" size="1" type="text" value="P">, then select your Lambda <strong>PollyNotes-ListFunction</strong>.</p></li>
<li><p>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
<li><p>In the <strong>Add Permission to Lambda Function</strong> dialog box, choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">OK</span></p></li>
<li><p>Choose <span style="color:#0073bb;"><strong>Method Request</strong></span></p></li>
<li><p>In the <strong>Settings</strong> section, next to <strong>Authorization</strong>, choose <i class="fas fa-pencil-alt" style="color:#0073bb;"></i> (Edit).</p></li>
<li><p>Select <strong>PollyNotesPool</strong> and then, choose <i class="fas fa-check-circle"></i> (check mark tick).</p></li>
<li><p>In the breadcrumb, choose <span style="color:#0073bb;"><strong>&lt;- Method Execution</strong></span></p></li>
<li><p>Choose <span style="color:#0073bb;"><strong>Integration Request</strong></span></p></li>
<li><p>Expand the <i class="fas fa-caret-right"></i> <strong>Mapping Templates</strong> section.</p></li>
<li><p>Select <i class="far fa-dot-circle" style="color:#0073bb;"></i> <strong>When there are no templates defined (recommended)</strong>.</p></li>
<li><p>Under <strong>Content-Type</strong>, choose <i class="fas fa-plus-circle"></i> <span style="color:#0073bb;"><strong>Add mapping template</strong></span></p></li>
<li><p>Enter <input readonly class="copyable-inline-input" size="16" type="text" value="application/json"> and choose <i class="fas fa-check-circle"></i> (check mark tick).</p></li>
<li><p><i class="fas fa-file-code" style="color:#00a1c9;"></i> In the box that appeared below, enter the following:</p></li>
</ol><pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testuser"</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> You are hard coding the value of <em>userId</em> here so that when you do your first test from the web interface, you can see the original notes you have created in DynamoDB. Since you won't be creating the CreateUpdate Function until after doing your test, you would have no way to create a note for your user. The first step once you are done fully testing the List function, will be to change this mapping template to be dynamic based on the Amazon Cognito ID of the user login.</p>
<ol start="362">
<li>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span>
</li>
<li>Choose the <span style="color:#0073bb;"><strong>/notes</strong></span> resource.</li>
<li>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Actions <i class="fas fa-caret-down"></i></span> and select <strong>Enable CORS</strong>.</li>
<li>Under <strong>Gateway Responses for PollyNotes API API</strong>, check option for <i class="far fa-check-square" style="color:#0073bb;"></i> <strong>DEFAULT 4XX</strong> and <i class="far fa-check-square" style="color:#0073bb;"></i> <strong>DEFAULT 5XX</strong>.</li>
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Enable CORS and replace existing CORS headers</span>
</li>
<li>In the <strong>Confirm method changes</strong> dialog box, choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Yes, replace existing values</span>
</li>
<li>
<p>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Actions <i class="fas fa-caret-down"></i></span>, then select <strong>Deploy API</strong>. Make the following updates:</p>
<ul>
<li>
<strong>Deployment stage</strong>: <input readonly class="copyable-inline-input" size="11" type="text" value="[New Stage]">
</li>
<li>
<strong>Stage name</strong>: <input readonly class="copyable-inline-input" size="4" type="text" value="prod">
</li>
</ul>
</li>
<li><p>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Deploy</span></p></li>
<li><p>Copy the <strong>Invoke URL</strong> and paste it into a file. You will need it later in the lab.</p></li>
<li>
<p>In the <strong>prod Stage Editor</strong>, choose the <strong>Logs/Tracing</strong> tab and make the following updates:</p>
<ul>
<li>
<strong>CloudWatch Settings</strong>
<ul>
<li>
<strong>Enable CloudWatch Logs</strong> <i class="fas fa-check-square" style="color:#0073bb;"></i>
</li>
<li>
<strong>Log level</strong> <input readonly class="copyable-inline-input" size="4" type="text" value="INFO">
</li>
<li>
<strong>Log full requests/responses data</strong> <i class="fas fa-check-square" style="color:#0073bb;"></i>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save Changes</span></p></li>
</ol>
<h2 id="step25">Task 9: (Java) - Creating the front-end website</h2>

<p>In this task, you create the front-end website.</p>
<ol start="373">
<li>Download and extract the following zip file:</li>
</ol>
<p><strong>Source file:</strong> <a href="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/scripts/polly-notes-web-bucket-root.zip" target="_blank">ZIP File</a></p>
<ol start="374">
<li>
<i class="fas fa-keyboard"></i> Modify the <em>main.bundle.js</em> file (lines 2-4) and change the following values:</li>
</ol><pre class="highlight javascript"><code><span class="c1">// Change the following 3 variable's value</span>&#x000A;<span class="kd">var</span> <span class="nx">API_GATEWAY_INVOKE_URL</span> <span class="o">=</span> <span class="s2">"https://your-api-url"</span>&#x000A;<span class="kd">var</span> <span class="nx">COGNITO_POOL_ID</span> <span class="o">=</span> <span class="s1">'us-east-1-xxxxxxxxxxx'</span>&#x000A;<span class="kd">var</span> <span class="nx">COGNITO_APP_CLIENT_ID</span> <span class="o">=</span> <span class="s1">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>&#x000A;</code></pre>
<p>You should have noted the needed values from prior lab steps. If you do not have details, you can get them by using the Console and the following paths:</p>
<ul>
<li><strong>Services -&gt; API Gateway -&gt; PollyNotesAPI -&gt; Stages -&gt; prod (API Gateway Invoke URL)</strong></li>
<li><strong>Services -&gt; Cognito -&gt; Manage User Pools -&gt; PollyNotesPool (Cognito Pool ID)</strong></li>
<li><strong>Services -&gt; Cognito -&gt; Manage User Pools -&gt; PollyNotesPool -&gt; App clients (Cognito App client ID)</strong></li>
</ul><ol start="375">
<li><p>Save the changes to the file.</p></li>
<li><p>Next, you need to enable CORS on the MP3 Bucket. When users access your website, they will be loading the website from the static Website bucket. Then, they will use javascript in their browser to connect to two different endpoints; API Gateway and the MP3 bucket. You already enabled CORS on the API Gateway, but you now need to enable CORS on your MP3 bucket, so that it can set response headers.</p></li>
<li><p>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>Amazon S3</strong>.</p></li>
<li><p>Choose your <input readonly class="copyable-inline-input" size="38" type="text" value="polly-notes-mp3-&lt;firstname&gt;-&lt;lastname&gt;"> bucket.</p></li>
<li><p>Choose the <strong>Permissions</strong> tab.</p></li>
<li><p>Navigate down to the <strong>Cross-origin resource sharing (CORS)</strong> section, then click <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span></p></li>
<li><p><i class="fas fa-file-code" style="color:#00a1c9;"></i> Copy and paste the following JSON code into the text box, then choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save changes</span></p></li>
</ol><pre class="highlight json"><code><span class="p">[</span><span class="w">&#x000A;    </span><span class="p">{</span><span class="w">&#x000A;        </span><span class="s2">"AllowedHeaders"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">&#x000A;            </span><span class="s2">"*"</span><span class="w">&#x000A;        </span><span class="p">],</span><span class="w">&#x000A;        </span><span class="s2">"AllowedMethods"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">&#x000A;            </span><span class="s2">"GET"</span><span class="w">&#x000A;        </span><span class="p">],</span><span class="w">&#x000A;        </span><span class="s2">"AllowedOrigins"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">&#x000A;            </span><span class="s2">"*"</span><span class="w">&#x000A;        </span><span class="p">],</span><span class="w">&#x000A;        </span><span class="s2">"ExposeHeaders"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">&#x000A;    </span><span class="p">}</span><span class="w">&#x000A;</span><span class="p">]</span><span class="w">&#x000A;</span></code></pre><ol start="382">
<li>Next, go to your Website bucket. In the breadcrumb trail, choose <span style="color:#0073bb;"><strong>Amazon S3</strong></span>, and then, choose your <input readonly class="copyable-inline-input" size="38" type="text" value="polly-notes-web-&lt;firstname&gt;-&lt;lastname&gt;"> bucket.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Upload</span>
</li>
<li>Upload all the files and folders in the folder named <input readonly class="copyable-inline-input" size="27" type="text" value="polly-notes-web-bucket-root"> (not the folder itself) by dragging them onto the upload window.</li>
</ol>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/drag.png" alt="Dragging files into S3"></p>
<ol start="385">
<li><p>Move to the bottom of the screen, and choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Upload</span></p></li>
<li><p>Once the files and folders have uploaded successfully (32 total), choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Close</span></p></li>
</ol>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/files-example.png" alt="Amazon S3 website files and folders listing"></p>

<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> There should be a combined total of <strong>10 files and folders</strong> in the <strong>root</strong> of the <input readonly class="copyable-inline-input" size="38" type="text" value="polly-notes-web-&lt;firstname&gt;-&lt;lastname&gt;"> Amazon S3 bucket.</p>
<ol start="387">
<li>Choose the <strong>Permissions</strong> tab.</li>
<li>In the <strong>Block public access (bucket settings)</strong> card choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span>
</li>
<li>Unselect <i class="far fa-square"></i> <strong>Block</strong> <em>all</em> <strong>public access</strong>.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save changes</span>
</li>
<li>A confirmation box will appear; type <input readonly class="copyable-inline-input" size="7" type="text" value="confirm"> and choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Confirm</span>
</li>
<li>Move down to the <strong>Bucket policy</strong> card and choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span>
</li>
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> Copy and paste the following bucket policy into the <strong>Bucket policy</strong> field.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Ensure that you replace your bucket name.</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"Version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-10-17"</span><span class="p">,</span><span class="w">&#x000A;    </span><span class="s2">"Statement"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">&#x000A;        </span><span class="p">{</span><span class="w">&#x000A;            </span><span class="s2">"Sid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PublicReadGetObject"</span><span class="p">,</span><span class="w">&#x000A;            </span><span class="s2">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">&#x000A;            </span><span class="s2">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="p">,</span><span class="w">&#x000A;            </span><span class="s2">"Action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"s3:GetObject"</span><span class="p">,</span><span class="w">&#x000A;            </span><span class="s2">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:s3:::polly-notes-web-&lt;firstname&gt;-&lt;lastname&gt;/*"</span><span class="w">&#x000A;        </span><span class="p">}</span><span class="w">&#x000A;    </span><span class="p">]</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre><ol start="394">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save changes</span></p></li>
<li><p>The description of your bucket should now be flagged with <span style="background-color:#D90000;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Publicly accessible</span> and the <strong>Permissions overview</strong> card will read <strong>Access</strong> as<br>
<i class="fas fa-exclamation-triangle" style="color:#D90000;"></i> <span style="color:#D90000;">Public</span></p></li>
<li><p>Choose the <strong>Properties</strong> tab.</p></li>
<li><p>In the <strong>Static website hosting</strong> card, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span></p></li>
</ol>
<p>Configure the following settings:</p>
<ul>
<li>
<strong>Static website hosting:</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i> Enable</li>
<li>
<strong>Index document</strong>: <input readonly class="copyable-inline-input" size="10" type="text" value="index.html">
</li>
<li>
<strong>Error document:</strong> <input readonly class="copyable-inline-input" size="10" type="text" value="error.html">
</li>
</ul><ol start="398">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save changes</span></p></li>
<li><p>Move to the <strong>Static website hosting</strong> card and copy your <em>Bucket website endpoint</em> URL to a text editor.</p></li>
</ol>
<p>You will use this again in the lab.</p>

<h2 id="step26">Task 10: (Java) - Testing the web application</h2>

<p>In this task, you test the web application by loading your Amazon S3 Hosted URL.</p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> You can obtain your Amazon S3 Hosted URL by going into the Amazon S3 Console. Select your web hosting bucket. Choose the <strong>Properties</strong> tab, and then choose, <strong>Static website hosting</strong>.</p>
<ol start="400">
<li>In a browser, enter your Static website hosting URL.</li>
<li>
<i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> You should be presented with a login page.</li>
</ol>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/pollynotes-loginpage.png" alt="Polly Notes Login Page"></p>
<ol start="402">
<li>Login with the following:</li>
</ol><ul>
<li>For <strong>UserName</strong>, enter: <input readonly class="copyable-inline-input" size="7" type="text" value="student">
</li>
<li>For <strong>Password</strong>, enter: <input readonly class="copyable-inline-input" size="7" type="text" value="student">
</li>
</ul><ol start="403">
<li>
<i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> You should be presented with a page that looks like the following:</li>
</ol>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/pollynotes-homepage.png" alt="Polly Notes Login Page"></p>

<p>You should expect to see the notes you created earlier. All other functionality, such as adding notes, updating, deleting, or playing will not work. You need to create the API methods and Lambda functions to enable this functionality.</p>

<h2 id="step27">Task 11: (Java) - Creating the remaining Lambda functions</h2>

<p>Now that the ListFunction is working end-to-end, you need to create the rest of the application. Having a list of the notes is great, but if you can't Create, Update, Delete and Dictate, the application isn't doing much.</p>

<p>You have two options for the remaining Lambda functions:</p>
<ul>
<li>Take it easy on me! Use the Solution Code to create the rest of the Lambda functions.</li>
<li>Take the challenge! If you have time, create the other Lambda functions manually that interact with DynamoDB (Dictate, CreateUpdate, Search, and Delete). It is considered a challenge to complete this given the time provided for the lab.</li>
</ul>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram6-2020.png" alt="Lab 6 Diagram"></p>

<p>If you decide to take the challenge, the recommendation is to start by using the Solution Code and then go back to replace the functions with your own code to ensure you get to see the full application before spending more time coding.</p>
<ol start="404">
<li>The first step is to download a zip file that contains the Solution Code for all of the Lambda functions. Instead of having you download a different zip file for each, you will be re-using this zip file for all of them.</li>
</ol>
<p>Download the following ZIP file to your laptop: <a href="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/scripts/PollyNotes-JavaSolutionFunctions.zip" target="_blank">PollyNotes-JavaSolutionFunctions</a>.</p>

<h3>Task 11.1: (Java) - Creating the Lambda DictateFunction</h3>

<p>In this task, you work with the Lambda DictateFunction. This function is already completely coded for you due to the length of this lab. This is why you will not find Solution Code for Dictate.</p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> This lab uses the <i class="fas fa-toggle-on" style="color:#0073bb;"></i> <strong>Updated Lambda Console</strong>.</p>
<ol start="405">
<li>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>Lambda</strong>.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create function</span> and make the following updates:</li>
</ol><ul>
<li>
<strong>Author from scratch</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i>
</li>
<li>
<strong>Function name:</strong> <input readonly class="copyable-inline-input" size="26" type="text" value="PollyNotes-DictateFunction">
</li>
<li>
<strong>Runtime:</strong> <input readonly class="copyable-inline-input" size="6" type="text" value="Java 8">
</li>
<li>
<strong>Permissions:</strong>
<ul>
<li>Expand <i class="fas fa-caret-right"></i> <strong>Change default execution role</strong>.</li>
<li>
<strong>Execution role:</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="20" type="text" value="Use an existing role">
</li>
<li>
<strong>Existing role:</strong> <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesRole">
</li>
</ul>
</li>
</ul><ol start="407">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Create function</strong></span>
</li>
</ol>
<p>The lambda function page will be displayed with your function configuration.</p>
<ol start="408">
<li>Scroll to the right and select the <strong>Configuration</strong> tab. In the <strong>General Configuration</strong> card, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span>. In the window that appears, enter the following:</li>
</ol><ul>
<li>
<strong>Description</strong>: <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out">
</li>
</ul>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Due to the expansion of <strong>AWS Lambda states to all functions</strong> for the <strong>delayed update configuration mechanism</strong>, the <strong>Description</strong> requires the <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out"> value to be supplied. If this is not added, you will receive the following error when you try to update the function in later steps.</p>
<ul>
<li><strong><em>Failed to upload project to Lambda because of 409, ResourceConflictException.</em></strong></li>
</ul><ol start="409">
<li>In the <strong>Code source</strong> section, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Upload from <i class="fas fa-caret-down"></i></span> ,  select <strong>.zip or .jar file</strong>, and then choose the <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;"><i class="fas fa-upload"></i> Upload</span> button. Locate the  <em>PollyNotes-JavaSolutionFunctions.zip</em>  file that you downloaded in the previous section and choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span>
</li>
<li>Scroll down to the <strong>Runtime settings</strong> card, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span> and enter the following details:</li>
</ol><ul>
<li>
<strong>Handler</strong>: <input readonly class="copyable-inline-input" size="50" type="text" value="com.amazonaws.pollynotes.functions.DictateFunction">
</li>
</ul><ol start="411">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
<li><p>Choose the <strong>Configuration</strong> tab.</p></li>
<li><p>Choose <strong>Environment variables</strong> from the options on the left and then choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span></p></li>
<li><p>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Add environment variable</span></p></li>
<li><p>Add the following values:</p></li>
</ol><ul>
<li>
<strong>Key</strong>: <input readonly class="copyable-inline-input" size="15" type="text" value="MP3_BUCKET_NAME">
</li>
<li>
<strong>Value</strong>: <input readonly class="copyable-inline-input" size="38" type="text" value="polly-notes-mp3-&lt;firstname&gt;-&lt;lastname&gt;">. (Update with your bucket name.)</li>
</ul><ol start="416">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
<li><p>Choose <strong>General configuration</strong> from the list on the left, then choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span> and make the following update:</p></li>
</ol><ul>
<li>
<strong>Memory (MB)</strong>: <input readonly class="copyable-inline-input" size="6" type="text" value="1024MB"> (so that your Lambda function can start faster on the first load)</li>
</ul><ol start="418">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
<li><p>Now test the function. Choose the <strong>Test</strong> tab and configure the following fields under <strong>Test event</strong>:</p></li>
</ol><ul>
<li>
<i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="9" type="text" value="New event">
</li>
<li>
<strong>Template:</strong> <input readonly class="copyable-inline-input" size="11" type="text" value="hello-world">
</li>
<li>
<strong>Name:</strong> <input readonly class="copyable-inline-input" size="11" type="text" value="DictateTest">
</li>
</ul><ol start="420">
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> Replace the JSON payload with the following:</li>
</ol><pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"voiceId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Russell"</span><span class="p">,</span><span class="w">&#x000A;    </span><span class="s2">"note"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">&#x000A;        </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testuser"</span><span class="p">,</span><span class="w">&#x000A;        </span><span class="s2">"noteId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"001"</span><span class="w">&#x000A;    </span><span class="p">}</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre><ol start="421">
<li><p>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Save changes</span></p></li>
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Test</span></p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> It is normal for it to take a little longer as this is the first time you are running your Lambda function.</p>

<p>There should be a green check mark just under the name of your Lambda function name on the left indicating <em>Execution result: succeeded (logs)</em>.</p>
<ol start="423">
<li>Choose the <strong>Details</strong> link under that text. You should see the output of your Lambda function providing a very long URL to your MP3 bucket which represents a pre-signed URL.</li>
</ol>
<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> For example:</p>

<p><span style="font-family:Courier;">"<a href="https://polly-notes-mp3-%5C" target="_blank">https://polly-notes-mp3-\</a>-&lt;lastname&gt;.s3.amazonaws.com/testuser/001.mp3?X-Amz-Security-Token=..."<br>
</span></p>
<ol start="424">
<li>Copy and paste that URL in your browser. It will have you download an mp3. Open the file to listen to Russell dictating your note!</li>
</ol>
<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> Congratulations! You have now created your Lambda Dictate function.</p>

<h3>Task 11.2: (Java) - Creating the Lambda CreateUpdateFunction</h3>
<ol start="425">
<li>Choose the <span style="color:#0073bb;">Functions</span> bread crumb at the top of the page.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Create function</strong></span> and make the following updates:</li>
</ol><ul>
<li>
<strong>Author from scratch</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i>
</li>
<li>
<strong>Function name:</strong> <input readonly class="copyable-inline-input" size="31" type="text" value="PollyNotes-CreateUpdateFunction">
</li>
<li>
<strong>Runtime:</strong> <input readonly class="copyable-inline-input" size="6" type="text" value="Java 8">
</li>
<li>
<strong>Permissions:</strong>
<ul>
<li>Expand <i class="fas fa-caret-right"></i> <strong>Change default execution role</strong>.</li>
<li>
<strong>Execution role:</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="20" type="text" value="Use an existing role">
</li>
<li>
<strong>Existing role:</strong> <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesRole">
</li>
</ul>
</li>
</ul><ol start="427">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Create function</strong></span><br>
The lambda function page will be displayed with your function configuration.</p></li>
<li><p>Scroll to the right and select the <strong>Configuration</strong> tab. In the <strong>General Configuration</strong> card, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span>. In the window that appears, enter the following:</p></li>
</ol><ul>
<li>
<strong>Description</strong>: <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out">
</li>
</ul>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Due to the expansion of <strong>AWS Lambda states to all functions</strong> for the <strong>delayed update configuration mechanism</strong>, the <strong>Description</strong> requires the <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out"> value to be supplied. If this is not added, you will receive the following error when you try to update the function in later steps.</p>
<ul>
<li><strong><em>Failed to upload project to Lambda because of 409, ResourceConflictException.</em></strong></li>
</ul><ol start="429">
<li>In the <strong>Code source</strong> section, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Upload from <i class="fas fa-caret-down"></i></span> ,  select <strong>.zip or .jar file</strong>, and then choose the <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;"><i class="fas fa-upload"></i> Upload</span> button. Locate the  <em>PollyNotes-JavaSolutionFunctions.zip</em>  file that you downloaded in the previous section and click on <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span>
</li>
<li>Scroll down to the <strong>Runtime settings</strong> card, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span> and enter the following details:</li>
</ol><ul>
<li>
<strong>Handler</strong>: <input readonly class="copyable-inline-input" size="62" type="text" value="com.amazonaws.pollynotes.solution.CreateUpdateFunctionSolution">
</li>
</ul><ol start="431">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
<li><p>Choose the <strong>Configuration</strong> tab.</p></li>
<li><p>Choose <strong>Environment variables</strong> from the options on the left and then choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span></p></li>
<li><p>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Add environment variable</span></p></li>
<li><p>Add the following values:</p></li>
</ol><ul>
<li>
<strong>Key</strong>: <input readonly class="copyable-inline-input" size="15" type="text" value="MP3_BUCKET_NAME">
</li>
<li>
<strong>Value</strong>: <input readonly class="copyable-inline-input" size="38" type="text" value="polly-notes-mp3-&lt;firstname&gt;-&lt;lastname&gt;">. (Update with your bucket name.)</li>
</ul><ol start="436">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
<li><p>Choose <strong>General configuration</strong> from the list on the left, then choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span> and make the following update:</p></li>
</ol><ul>
<li>
<strong>Memory (MB)</strong>: <input readonly class="copyable-inline-input" size="6" type="text" value="1024MB"> (so that your Lambda function can start faster on the first load)</li>
</ul><ol start="438">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
<li><p>Now test the function. Choose the <strong>Test</strong> tab and configure the following fields under <strong>Test event</strong>:</p></li>
</ol><ul>
<li>
<i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="9" type="text" value="New event">
</li>
<li>
<strong>Template:</strong> <input readonly class="copyable-inline-input" size="11" type="text" value="hello-world">
</li>
<li>
<strong>Name:</strong> <input readonly class="copyable-inline-input" size="16" type="text" value="CreateUpdateTest">
</li>
</ul><ol start="440">
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> Replace the JSON payload with the following:</li>
</ol><pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testuser"</span><span class="p">,</span><span class="w">&#x000A;    </span><span class="s2">"noteId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"001"</span><span class="p">,</span><span class="w">&#x000A;    </span><span class="s2">"note"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My very new note to myself"</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre><ol start="441">
<li><p>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Save changes</span></p></li>
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Test</span></p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> It is normal for it to take a little longer as this is the first time you are running your Lambda function.</p>

<p>There should be a green check mark just under the name of your Lambda function name on the left indicating <em>Execution result: succeeded (logs)</em>.</p>
<ol start="443">
<li>Choose the <strong>Details</strong> link under that text. You should see the output of your Lambda function providing the noteId that you just uploaded. For example, <input readonly class="copyable-inline-input" size="5" type="text" value='"001"'>
</li>
</ol>
<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> Congratulations! You have now created your Lambda CreateUpdate function.</p>

<h3>Task 11.3: (Java) - Creating the Lambda SearchFunction</h3>
<ol start="444">
<li>Choose the <span style="color:#0073bb;">Functions</span> bread crumb at the top of the page.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Create function</strong></span> and make the following updates:</li>
</ol><ul>
<li>
<strong>Author from scratch</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i>
</li>
<li>
<strong>Function name:</strong> <input readonly class="copyable-inline-input" size="25" type="text" value="PollyNotes-SearchFunction">
</li>
<li>
<strong>Runtime:</strong> <input readonly class="copyable-inline-input" size="6" type="text" value="Java 8">
</li>
<li>
<strong>Permissions:</strong>
<ul>
<li>Expand <i class="fas fa-caret-right"></i> <strong>Change default execution role</strong>.</li>
<li>
<strong>Execution role:</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="20" type="text" value="Use an existing role">
</li>
<li>
<strong>Existing role:</strong> <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesRole">
</li>
</ul>
</li>
</ul><ol start="446">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Create function</strong></span>
</li>
</ol>
<p>The lambda function page will be displayed with your function configuration.</p>
<ol start="447">
<li>Scroll to the right and select the <strong>Configuration</strong> tab. In the <strong>General Configuration</strong> card, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span>. In the window that appears, enter the following:</li>
</ol><ul>
<li>
<strong>Description</strong>: <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out">
</li>
</ul>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Due to the expansion of <strong>AWS Lambda states to all functions</strong> for the <strong>delayed update configuration mechanism</strong>, the <strong>Description</strong> requires the <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out"> value to be supplied. If this is not added, you will receive the following error when you try to update the function in later steps.</p>
<ul>
<li><strong><em>Failed to upload project to Lambda because of 409, ResourceConflictException.</em></strong></li>
</ul><ol start="448">
<li>In the <strong>Code source</strong> section, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Upload from <i class="fas fa-caret-down"></i></span> ,  select <strong>.zip or .jar file</strong>, and then choose the <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;"><i class="fas fa-upload"></i> Upload</span> button. Locate the  <em>PollyNotes-JavaSolutionFunctions.zip</em>  file that you downloaded in the previous section and click on <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span>
</li>
<li>Scroll down to the <strong>Runtime settings</strong> card, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span> and enter the following details.</li>
</ol><ul>
<li>
<strong>Handler</strong>: <input readonly class="copyable-inline-input" size="56" type="text" value="com.amazonaws.pollynotes.solution.SearchFunctionSolution">
</li>
</ul><ol start="450">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
<li><p>Choose the <strong>Configuration</strong> tab.</p></li>
<li><p>Choose <strong>Environment variables</strong> from the options on the left and then choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span></p></li>
<li><p>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Add environment variable</span></p></li>
<li><p>Add the following values:</p></li>
</ol><ul>
<li>
<strong>Key</strong>: <input readonly class="copyable-inline-input" size="15" type="text" value="MP3_BUCKET_NAME">
</li>
<li>
<strong>Value</strong>: <input readonly class="copyable-inline-input" size="38" type="text" value="polly-notes-mp3-&lt;firstname&gt;-&lt;lastname&gt;">. (Update with your bucket name.)</li>
</ul><ol start="455">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
<li><p>Choose <strong>General configuration</strong> from the list on the left, then choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span> and make the following update:</p></li>
</ol><ul>
<li>
<strong>Memory (MB)</strong>: <input readonly class="copyable-inline-input" size="6" type="text" value="1024MB"> (so that your Lambda function can start faster on the first load)</li>
</ul><ol start="457">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
<li><p>Now test the function. Choose the <strong>Test</strong> tab and configure the following fields under <strong>Test event</strong>:</p></li>
</ol><ul>
<li>
<i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="9" type="text" value="New event">
</li>
<li>
<strong>Template:</strong> <input readonly class="copyable-inline-input" size="11" type="text" value="hello-world">
</li>
<li>
<strong>Name:</strong> <input readonly class="copyable-inline-input" size="10" type="text" value="SearchTest">
</li>
</ul><ol start="459">
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> Replace the JSON payload with the following:</li>
</ol><pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testuser"</span><span class="p">,</span><span class="w">&#x000A;    </span><span class="s2">"note"</span><span class="p">:</span><span class="w"> </span><span class="s2">"very"</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre><ol start="460">
<li><p>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Save changes</span></p></li>
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Test</span></p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> It is normal for it to take a little longer as this is the first time you are running your Lambda function.</p>

<p>There should be a green check mark just under the name of your Lambda function name on the left indicating <em>Execution result: succeeded (logs)</em>.</p>
<ol start="462">
<li>Choose the <strong>Details</strong> link under that text.</li>
</ol>
<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> You should see the output of your Lambda function listing a the note you just searched for using the <input readonly class="copyable-inline-input" size="4" type="text" value="very"> keyword that was just created in your previous CreateUpdateFunction.</p>

<p><span style="font-family:Courier;">[<br><br>
  {<br><br>
    "userId": "testuser",<br><br>
    "noteId": "001",<br><br>
    "note": "My very new note to myself"<br><br>
  }<br><br>
]<br>
</span></p>

<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> Congratulations! You have now created your LambdaSearch function.</p>

<h3>Task 11.4: (Java) - Creating the Lambda DeleteFunction</h3>
<ol start="463">
<li>Choose the <span style="color:#0073bb;">Functions</span> bread crumb at the top of the page.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Create function</strong></span> and make the following updates:</li>
</ol><ul>
<li>
<strong>Author from scratch</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i>
</li>
<li>
<strong>Function name:</strong> <input readonly class="copyable-inline-input" size="25" type="text" value="PollyNotes-DeleteFunction">
</li>
<li>
<strong>Runtime:</strong> <input readonly class="copyable-inline-input" size="6" type="text" value="Java 8">
</li>
<li>
<strong>Permissions:</strong>
<ul>
<li>Expand <i class="fas fa-caret-right"></i> <strong>Change default execution role</strong>.</li>
<li>
<strong>Execution role:</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="20" type="text" value="Use an existing role">
</li>
<li>
<strong>Existing role:</strong> <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesRole">
</li>
</ul>
</li>
</ul><ol start="465">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Create function</strong></span>
</li>
</ol>
<p>The lambda function page will be displayed with your function configuration.</p>
<ol start="466">
<li>Scroll to the right and select the <strong>Configuration</strong> tab. In the <strong>General Configuration</strong> card, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span>. In the window that appears, enter the following:</li>
</ol><ul>
<li>
<strong>Description</strong>: <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out">
</li>
</ul>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Due to the expansion of <strong>AWS Lambda states to all functions</strong> for the <strong>delayed update configuration mechanism</strong>, the <strong>Description</strong> requires the <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out"> value to be supplied. If this is not added, you will receive the following error when you try to update the function in later steps.</p>
<ul>
<li><strong><em>Failed to upload project to Lambda because of 409, ResourceConflictException.</em></strong></li>
</ul><ol start="467">
<li>In the <strong>Code source</strong> section, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Upload from <i class="fas fa-caret-down"></i></span> , select <strong>Upload a .zip or .jar file</strong>, and then choose the <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;"><i class="fas fa-upload"></i> Upload</span> button. Locate the  <em>PollyNotes-JavaSolutionFunctions.zip</em>  file that you downloaded in the previous section and choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span>
</li>
<li>Scroll down to the <strong>Runtime settings</strong> card, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span> and enter the following details:</li>
</ol><ul>
<li>
<strong>Handler</strong>: <input readonly class="copyable-inline-input" size="56" type="text" value="com.amazonaws.pollynotes.solution.DeleteFunctionSolution">
</li>
</ul><ol start="469">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
<li><p>Choose the <strong>Configuration</strong> tab.</p></li>
<li><p>Choose <strong>Environment variables</strong> from the options on the left and then choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span></p></li>
<li><p>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Add environment variable</span></p></li>
<li><p>Add the following values:</p></li>
</ol><ul>
<li>
<strong>Key</strong>: <input readonly class="copyable-inline-input" size="15" type="text" value="MP3_BUCKET_NAME">
</li>
<li>
<strong>Value</strong>: <input readonly class="copyable-inline-input" size="38" type="text" value="polly-notes-mp3-&lt;firstname&gt;-&lt;lastname&gt;">. (Update with your bucket name.)</li>
</ul><ol start="474">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
<li><p>Choose <strong>General configuration</strong> from the list on the left, then choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span> and make the following update:</p></li>
</ol><ul>
<li>
<strong>Memory (MB)</strong>: <input readonly class="copyable-inline-input" size="6" type="text" value="1024MB"> (so that your Lambda function can start faster on the first load)</li>
</ul><ol start="476">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
<li><p>Now test the function. Choose the <strong>Test</strong> tab and configure the following fields under <strong>Test event</strong>:</p></li>
<li><p>Now test the function. Choose the <strong>Test</strong> tab and configure the following fields under <strong>Test event</strong>:</p></li>
</ol><ul>
<li>
<i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="9" type="text" value="New event">
</li>
<li>
<strong>Template:</strong> <input readonly class="copyable-inline-input" size="11" type="text" value="hello-world">
</li>
<li>
<strong>Name:</strong> <input readonly class="copyable-inline-input" size="10" type="text" value="DeleteTest">
</li>
</ul><ol start="479">
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> Replace the JSON payload with the following:</li>
</ol><pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testuser"</span><span class="p">,</span><span class="w">&#x000A;    </span><span class="s2">"noteId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"001"</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre><ol start="480">
<li><p>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Save changes</span></p></li>
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Test</span></p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> It is normal for it to take a little longer as this is the first time you are running your Lambda function.</p>

<p>There should be a green check mark just under the name of your Lambda function name on the left side of the screen with text mentioning: <em>Execution result: succeeded (logs)</em>.</p>
<ol start="482">
<li>Choose the <strong>Details</strong> link under that text. You should see the output of your Lambda function providing the noteId that you just deleted. For example, <input readonly class="copyable-inline-input" size="5" type="text" value='"001"'>.</li>
</ol>
<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> Congratulations! You have now created your Lambda Delete function.</p>

<h2 id="step28">Task 12: (Java) - Creating the remaining Restful API</h2>

<p>In this task, you create the remaining Restful API.</p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram-2020.png" alt="Lab 6 Diagram"></p>
<ol start="483">
<li>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>API Gateway</strong>.</li>
<li>Choose <strong><span style="color:#0073bb;">PollyNotesAPI</span></strong>.</li>
<li>Choose the <span style="color:#0073bb;"><strong>/notes/GET</strong></span> method.</li>
<li>Choose <span style="color:#0073bb;"><strong>Integration Request</strong></span>
</li>
<li>Navigate to the bottom and expand <i class="fas fa-caret-right"></i> <strong>Mapping Templates</strong>.</li>
<li>Choose <strong>application/json</strong>.</li>
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> Move down and replace the mapping template with the following:</li>
</ol><pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$context.authorizer.claims.sub"</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> You are now removing the hard coded value of <em>testuser</em> to a variable that is dynamically populated based on your authorizer. In this case, the authorizer is Amazon Cognito. This means, <em>userId</em> will now be set to the value of the Amazon Cognito ID of the user login.</p>
<ol start="490">
<li>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span>
</li>
<li>Download the following Swagger file (API-Gateway-for-students-swagger.yaml):</li>
</ol>
<p><strong>Source file:</strong> <a href="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/scripts/API-Gateway-for-students-swagger.yaml" target="_blank">SWAGGER</a></p>
<ol start="492">
<li>Modify <strong>line 11</strong> of the file to replace it with your <strong>Amazon Cognito User Pool ARN</strong> (in between the quotes "").</li>
<li>
<strong>Save</strong> the file.</li>
<li>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Actions <i class="fas fa-caret-down"></i></span> and select <strong>Import API</strong>.</li>
<li>Navigate to the bottom of the page and change the <strong>Import mode</strong> to <strong>Merge</strong>.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#d13212;"></i> Be mindful not to select <input readonly class="copyable-inline-input" size="9" type="text" value="Overwrite">.</p>
<ol start="496">
<li>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Select Swagger File</span> and then select your saved Swagger file.</li>
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Import</span>
</li>
</ol>
<p>The Swagger file created the additional resources and methods for your API. You still need to integrate the Methods with your Lambda functions.</p>
<ol start="498">
<li>Choose the /<span style="color:#0073bb;">notes</span>/<span style="color:#6aaf35;">POST</span> method.</li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> If you encounter an error reading, <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;"><i class="fas fa-exclamation-circle" style="color:red;"></i> You do not have permission to perform this action.</span> you can ignore it.</p>

<p>The reason for this error is due to the swagger file specifying a mock function from another region. API Gateway tries to pull it up and returns the error because you do not have permissions to that region.</p>
<ol start="499">
<li>Choose <span style="color:#0073bb;"><strong>Integration Request</strong></span>
</li>
<li>For <strong>Lambda Region</strong>, choose <i class="fas fa-pencil-alt" style="color:#0073bb;"></i> (edit).</li>
<li>Select your <strong>Lambda Region</strong> based on what you have noted before and then, choose <i class="fas fa-check-circle"></i> (check mark tick).</li>
<li>For <strong>Lambda Function</strong>, type P and then select <strong>PollyNotes-CreateUpdateFunction</strong>. Choose <i class="fas fa-check-circle"></i> (check mark tick).</li>
<li>In the <strong>Add Permission to Lambda Function</strong> dialog box, make sure the Lambda function reflects the correct name.</li>
</ol><ul>
<li><p>If the name is correct, choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>OK</strong></span> to accept and allow invocation permissions to be created and your trigger to be setup.</p></li>
<li>
<p>If it reads as the <strong>Mock</strong> function name, we have to do a couple additional steps to workaround this UI issue.</p>
<ul>
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>OK</strong></span>.</li>
<li>Choose <strong>Resources</strong> link on the left to leave that section.</li>
<li>Next choose the appropriate method and select <strong>Integration Request</strong> and repeat the instructions as normal.</li>
<li>You should see that the region is set correctly but the <strong>Lambda Function</strong> is pointing to <strong>arn:aws:lambda:us-west-2:012345678901:function:Mock</strong> and needs to be updated.</li>
<li>
<i class="fas fa-sticky-note" style="color:#ec7211;"></i> There appears to be a bug with the API Gateway UI that causes this issue. It should be resolved soon. Until then, this is the workaround.</li>
</ul>
</li>
</ul><ol start="504">
<li>Repeat these steps for the remaining methods with the following mappings:</li>
</ol><ul>
<li>
<strong>/search/<span style="color:#0073bb;">GET</span></strong>     PollyNotes-SearchFunction</li>
<li>
<strong>/{id}/<span style="color:#d13212;">DELETE</span></strong>    PollyNotes-DeleteFunction</li>
<li>
<strong>/{id}/<span style="color:#6aaf35;">POST</span></strong>      PollyNotes-DictateFunction</li>
</ul>
<p>Once you have completed the steps for each of the above methods, complete the following:</p>
<ul>
<li>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Actions <i class="fas fa-caret-down"></i></span> and select <strong>Deploy API</strong>.</li>
<li>Select the <span style="color:#0073bb;"><strong>prod</strong></span> stage, and then choose <strong>Deploy</strong>.</li>
</ul>
<p>Your API should now be fully functional.</p>

<h2 id="step29">Task 13: (Java) - Testing the web application</h2>

<p>In this task, you test the web application by loading your Amazon S3 Hosted URL.</p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram-2020.png" alt="Lab 6 Diagram"></p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> You can obtain your Amazon S3 Hosted URL by going into the Amazon S3 Console. Select your web hosting bucket. Choose the <strong>Properties</strong> tab, and then, choose <strong>Static website hosting</strong>.</p>
<ol start="505">
<li>Test the application by exploring the functionality of the site. Test the add, delete, update, and search functions. Test that the voice options work correctly.</li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> Should you receive a backend server error, revisit the method integration steps and ensure the Lambda Function value is set correctly.</p>
<ul>
<li>If you find any that read as, <strong>arn:aws:lambda:us-west-2:012345678901:function:Mock/invocation</strong>, go back and update those methods to the correct Lambda Function name.</li>
</ul>
<p><a href="#troubleshooting" target="_self">A list of additional troubleshooting tips can be found here</a></p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> In case of errors, correct the code and run the test again.</p>

<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> Congratulations! You have completed the <strong>Java</strong> version of this lab!</p>

<p>If you do not wish to complete the <strong>Python</strong> version of the lab, <a href="#end" target="_self">continue to the next step</a>.</p>

<p><a id="python" target="_blank"></a></p>

<h2 id="step30">Task 3: (Python) - Amazon Cognito Authentication</h2>

<p>You can get started quickly using AWS with boto3, the AWS SDK for Python. Boto3 makes it easy to integrate your Python application, library, or script with AWS services including Amazon S3, Amazon EC2, Amazon DynamoDB, and more.</p>
<ul>
<li>
<i class="fas fa-info-circle" style="color:#00a1c9;"></i> <a href="https://aws.amazon.com/sdk-for-python" target="_blank">Learn more about the AWS SDK for Python</a>
</li>
</ul>
<p>In this task, you will:</p>
<ul>
<li>Create an Amazon Cognito user pool, which you are going to use to authenticate your end users and control access through API Gateway, making sure that your endpoint is secure.</li>
<li>Create and confirm an Amazon Cognito user by using the Linux Dev Instance. The Cognito user is used to test the end to end application.</li>
</ul>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram1-2020.png" alt="Lab 6 Diagram"></p>

<p><i class="fas fa-info-circle" style="color:#00a1c9;"></i> For more information on Amazon Cognito User Pools, see: <a href="https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-identity-pools.html" target="_blank">Amazon Cognito User Pools</a></p>

<h3>Task 3.1: (Python) - Creating an Amazon Cognito user pool</h3>
<ol start="506">
<li><p>Open the <strong>AWS Management Console</strong> if not already opened.</p></li>
<li><p>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>Amazon Cognito</strong>.</p></li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Verify that you are in the <strong>correct region</strong>. If you are unsure of the region, you can see it identified in the <strong>Lab Information</strong> section to the left of these instructions. Every service that is used in the lab (Amazon Cognito, API Gateway, Lambda, and DynamoDB) must be in the same region. Take a note of this region and every time the instructions prompt you to verify your region, make sure it is the same.</p>
<ol start="508">
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Manage User Pools</span>
</li>
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create a user pool</span>
</li>
<li>For <strong>Pool name</strong>, enter: <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesPool">
</li>
<li>For <strong>How do you want to create your user pool?</strong>, choose <span style="color:#0073bb;">Step through settings</span>
</li>
<li>Go to the <strong>Which standard attributes do you want to require?</strong> section.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#d13212;"></i> This step can't be modified once the User Pool is created. To correct this, you would need to delete the current User Pool and create a new one.</p>
<ol start="513">
<li><p>Remove the checkbox next to <i class="far fa-square"></i> <strong>email</strong> and choose <span style="background-color:#329AD6;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Next step</span></p></li>
<li><p>In the <strong>What password strength do you want to require?</strong> section, you set the specifics required for the password. The password used is for testing purposes and you will be entering it many times so it has limited security settings.</p></li>
</ol>
<p>Make the following configuration:</p>
<ul>
<li>
<strong>Minimum length</strong> <input readonly class="copyable-inline-input" size="1" type="text" value="6">
</li>
</ul>
<p>Unselect the following options:</p>
<ul>
<li>
<i class="far fa-square"></i> <strong>Require numbers</strong>
</li>
<li>
<i class="far fa-square"></i> <strong>Require special character</strong>
</li>
<li>
<i class="far fa-square"></i> <strong>Require uppercase letters</strong>
</li>
<li>
<i class="far fa-square"></i> <strong>Require lowercase letters</strong>
</li>
</ul><ol start="515">
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Next step</span>
</li>
</ol>
<p>In the navigation menu on the left, you will find a list of all of the main steps for the creation of the Amazon Cognito User Pool. As many settings can stay as the defaults, you will skip ahead and go to the ones that need to be modified.</p>
<ol start="516">
<li>Choose <strong>App clients</strong>.</li>
<li>Choose <span style="color:#0073bb;">Add an app client</span>
</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Make sure that you follow the next steps exactly as this configuration can't be undone. To correct, you will have to delete the current App client and create a new one.</p>
<ul>
<li>
<strong>App client name:</strong>  <input readonly class="copyable-inline-input" size="17" type="text" value="PollyNotesAngular">
</li>
<li>Unselect <i class="far fa-square"></i> <strong>Generate client secret</strong>.</li>
</ul><ol start="518">
<li>Choose <span style="background-color:#329AD6;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Create app client</span>
</li>
<li>In the navigation menu on the left, choose <strong>Review</strong> and review all of the settings.</li>
<li>Choose <span style="background-color:#329AD6;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Create pool</span>
</li>
<li>Save the <strong>Pool Id</strong> and the <strong>Pool ARN</strong> from your Amazon Cognito Pool information into a separate file for use later in this lab.</li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> Make sure to note that it is for <strong>Amazon Cognito Pool Id</strong> and <strong>Amazon Cognito Pool ARN</strong> as well.</p>

<p>For example, in the Oregon region, the <strong>Pool Id</strong> would look like <strong>us-west-2_XXXXXXXXX</strong> and the <strong>Pool ARN</strong> would look like <strong>arn:aws:cognito-idp:us-west-2:012345678901:userpool/us-west-2_XXXXXXXXX</strong>.</p>
<ol start="522">
<li><p>In the navigation pane on the left, under <strong>General settings</strong>, choose <strong>App clients</strong>.</p></li>
<li><p>Save the <strong>App client id</strong> in the form of xxxxxxxxxxxxxxxxxxxxxxxxxx information into the same file. Make sure to note that it is for the <strong>Amazon Cognito App client id</strong>.</p></li>
</ol>
<h3>Task 3.2: (Python) - Creating a user for the Amazon Cognito user pool</h3>

<p>In this task, you will create and confirm an Amazon Cognito user by using the Linux Dev Instance.</p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> You could connect to your <strong>Windows Dev Instance</strong> and open a PowerShell session to complete this step. However, to show another option, you will connect to the <strong>Linux Dev Instance</strong> using <strong>EC2 Instance Connect</strong>. It will connect you to a web-based ssh session.</p>
<ol start="524">
<li>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select  <strong>EC2</strong>.</li>
<li>Choose <strong>Instances</strong>.</li>
<li>Select <i class="far fa-check-square" style="color:#0073bb;"></i>  <strong>Linux Instance Dev</strong> and then choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;"> Connect</span>
</li>
<li>Select the <strong>EC2 Instance Connect</strong> tab.</li>
<li>Ensure the <strong>User name</strong> field is set to <input readonly class="copyable-inline-input" size="8" type="text" value="ec2-user">.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Connect</strong></span>
</li>
</ol>
<p><a id="python_continue" target="_blank"></a></p>

<p>Next you will run the sign-up script.</p>

<p><i class="fas fa-keyboard"></i> In the following command, change <strong>change-me_app-client-id</strong> with the value of the <strong>App client id</strong> that you copied to a file earlier and then, run the command:</p>
<pre class="highlight shell"><code>aws cognito-idp sign-up --client-id change-me_app-client-id --username student --password student&#x000A;</code></pre>
<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> <strong>Expected output:</strong></p>

<p><span style="font-family:Courier;">{<br><br>
  "UserConfirmed": false,<br><br>
  "UserSub": "abc70c2f-52v7-4abc-c195-012abc8560ab"<br><br>
}<br>
</span></p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> The values in the output should show your specific configuration.</p>

<p>You have now created a user in Amazon Cognito with the username <input readonly class="copyable-inline-input" size="7" type="text" value="student"> and a password of <input readonly class="copyable-inline-input" size="7" type="text" value="student">. Even though this isn't secure, you are using a simple username and password for simplicity during testing.</p>
<ol start="530">
<li>Next, confirm the user that you created. You will need to change <strong>change-me_pool-id</strong> with the value of the <strong>Pool Id</strong> that you copied to a file earlier.</li>
</ol>
<p><i class="fas fa-keyboard"></i> To confirm the user, enter the following command:</p>
<pre class="highlight shell"><code>aws cognito-idp admin-confirm-sign-up --user-pool-id change-me_pool-id --username student&#x000A;</code></pre>
<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> If you don't see any output, it means that the command is successful and you can continue.</p>
<ol start="531">
<li>Go back to the <strong>Amazon Cognito</strong> console, choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Manage User Pools</span>
</li>
<li>Under <span style="color:#0073bb;">User Pools</span> choose <span style="color:#0073bb;"><strong>PollyNotesPool</strong></span>.</li>
<li>Under <strong>General settings</strong>, choose <strong>Users and groups</strong>.</li>
</ol>
<p>You should see the username <span style="color:#0073bb;">student</span> and the status is <strong>CONFIRMED</strong>. If you do not see it, choose <i class="fas fa-sync" style="color:#0073bb;"></i> to refresh the browser.</p>

<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> Congratulations! You have successfully created an Amazon Cognito User Pool, manually added a user, and confirmed that user.</p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> Normally, the sign-up process would be done via the application. However, the application that you are using doesn't provide such a function. So instead, it is manually created.</p>

<h2 id="step31">Task 4: (Python) - Creating a DynamoDB table</h2>

<p>In this task, you will create a table in DynamoDB called <strong>pollynotes</strong>. This table is going to be used to store your user id, along with your notes.</p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram2-2020.png" alt="Lab 6 Diagram"></p>
<ol start="534">
<li><p>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>DynamoDB</strong>.</p></li>
<li><p>Choose the <strong>Tables</strong> link on the navigation menu on the left side.</p></li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Verify that you are in the <strong>correct region</strong>. If you are unsure of the region, you can see it identified in the <strong>Lab Information</strong> section to the left of these instructions.</p>

<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> The entries below are case sensitive, make sure that you copy and paste the entries from the lab console.</p>
<ol start="536">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create table</span> and fill in the values below:</li>
</ol><ul>
<li><p><strong>Table name:</strong> <input readonly class="copyable-inline-input" size="10" type="text" value="pollynotes"></p></li>
<li><p><strong>Partition key:</strong> <input readonly class="copyable-inline-input" size="6" type="text" value="userId"> <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">string <i class="fas fa-caret-down"></i></span></p></li>
<li><p><strong>Sort key:</strong> <input readonly class="copyable-inline-input" size="6" type="text" value="noteId"> <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">string <i class="fas fa-caret-down"></i></span></p></li>
<li><p><strong>Settings:</strong>  <i class="fas fa-dot-circle" style="color:#0073bb;"></i> Default settings</p></li>
</ul><ol start="537">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create table</span>
</li>
</ol>
<p>It may take up to 15 seconds for the DynamoDB table to be created. There will be a spinning loading logo next to your table name. Wait for that to disappear before moving to the next step.</p>
<ol start="538">
<li>From the left of your screen choose <strong>Items</strong> &gt; <i class="fas fa-dot-circle" style="color:#0073bb;"></i> pollynotes &gt; <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create item</span>
</li>
</ol><ul>
<li><p>In the <strong>VALUE</strong> field next to <strong>userId</strong>, enter: <input readonly class="copyable-inline-input" size="8" type="text" value="testuser"></p></li>
<li><p>In the <strong>VALUE</strong> field next to <strong>noteId</strong>, enter: <input readonly class="copyable-inline-input" size="3" type="text" value="001"></p></li>
</ul><ol start="539">
<li>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Add new attribute <i class="fas fa-caret-down"></i></span> &gt; <strong>String</strong> &gt; update <strong>NewValue</strong> to <input readonly class="copyable-inline-input" size="4" type="text" value="note">.</li>
</ol><ul>
<li>In the <strong>VALUE</strong> field next to <strong>note</strong>, enter: <input readonly class="copyable-inline-input" size="17" type="text" value="My note to myself">
</li>
</ul><ol start="540">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create item</span>
</li>
</ol>
<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> <strong>Example:</strong></p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/newItem.png" alt="xpected Output"></p>
<ol start="541">
<li>Create a few more items by going through the <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create item</span> process again.</li>
</ol>
<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> <strong>Example:</strong></p>
<ul>
<li>Your next <strong>noteId</strong> should be <input readonly class="copyable-inline-input" size="3" type="text" value="002">, then <input readonly class="copyable-inline-input" size="3" type="text" value="003">, and more.</li>
<li>The <strong>userId</strong> should always be <input readonly class="copyable-inline-input" size="8" type="text" value="testuser">.</li>
<li>The <strong>note</strong> can be anything that you would like, but beware that it will be recited back by Amazon Polly at some point.</li>
</ul>
<h2 id="step32">Task 5: (Python) - Creating Amazon S3 buckets</h2>

<p>In this task, you will create two Amazon S3 buckets:</p>
<ul>
<li>A website bucket which will host your front end website.</li>
<li>An MP3 bucket which will store your MP3 files.</li>
</ul>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram3-2020.png" alt="Lab 6 Diagram"></p>

<p>You will only be creating the two Amazon S3 buckets in this section and configuring them in a later step.</p>
<ol start="542">
<li>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>Amazon S3</strong>.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> You can see that the region is Global. This is because Amazon S3 does not require region selection. However, Amazon S3 creates buckets in a region you specify. When creating your buckets, select the correct region based on what you noted before. If you are unsure of the region, verify the value with your instructor.</p>

<h3>Task 5.1: (Python) - Create the Web bucket</h3>
<ol start="543">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create bucket</span>
</li>
<li>
<strong>Bucket name</strong>, enter (all lowercase): <input readonly class="copyable-inline-input" size="38" type="text" value="polly-notes-web-&lt;firstname&gt;-&lt;lastname&gt;">
</li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> For example, if your name is John Smith, your bucket name would be <strong>polly-notes-web-john-smith</strong>.</p>
<ol start="545">
<li>Make sure that the <strong>Region</strong> field is set to the appropriate region you have noted earlier.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create bucket</span>
</li>
</ol>
<h3>Task 5.2: (Python) - Create the MP3 bucket</h3>

<p>In this task you will create another Amazon S3 bucket to hold the Amazon Polly audio files.</p>
<ol start="547">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create bucket</span></p></li>
<li><p><strong>Bucket name:</strong> (all lowercase): <input readonly class="copyable-inline-input" size="38" type="text" value="polly-notes-mp3-&lt;firstname&gt;-&lt;lastname&gt;"></p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> For example, if your name is John Smith, your bucket name would be <strong>polly-notes-mp3-john-smith</strong>.</p>
<ol start="549">
<li>Make sure that the <strong>Region</strong> field is set to the appropriate region you have noted earlier.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create bucket</span>
</li>
</ol>
<h2 id="step33">Task 6: (Python) - Reviewing an IAM managed policy and creating an IAM role</h2>

<p>In this task, you will review an IAM Managed Policy and create an IAM Role to allow your Lambda functions to:</p>
<ul>
<li>Perform CRUD operations on DynamoDB.</li>
<li>Call the Amazon Polly API.</li>
<li>Perform the PUT operation on Amazon S3 for the MP3.</li>
<li>Log events to CloudWatch.</li>
</ul>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram3b-2020.png" alt="Lab 6 Diagram"></p>
<ol start="551">
<li>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>IAM</strong>.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> You can see that the region is Global. IAM does not require region selection because it's a global service.</p>

<h3>Task 6.1: (Python) - Creating an IAM policy</h3>
<ol start="552">
<li>To save time the <strong>lambda_ddb_s3_polly</strong> managed policy has already been created.</li>
<li>
<i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> The policy includes the following permissions:</li>
</ol>
<p><span style="font-family:Courier;">{<br><br>
"Version": "2012-10-17",<br><br>
  "Statement": [<br><br>
     {<br><br>
    "Effect": "Allow",<br><br>
    "Action": [<br><br>
      "dynamodb:DeleteItem",<br><br>
      "dynamodb:GetItem",<br><br>
      "dynamodb:PutItem",<br><br>
      "dynamodb:Query",<br><br>
      "dynamodb:UpdateItem",<br><br>
      "dynamodb:DescribeTable",<br><br>
      "polly:SynthesizeSpeech",<br><br>
      "s3:PutObject",<br><br>
      "s3:GetObject",<br><br>
      "logs:CreateLogGroup",<br><br>
      "logs:CreateLogStream",<br><br>
      "logs:PutLogEvents"<br><br>
],<br><br>
      "Resource": ["*"]<br><br>
    }<br><br>
      ]<br><br>
}<br>
</span></p>

<h3>Task 6.2: (Python) - Creating an IAM role</h3>

<p>In this task, you will create an IAM Role called <strong>PollyNotesRole</strong> and attach the <strong>lambda_ddb_s3_polly</strong> policy to it. This Role will be used by the Lambda functions in the next sections. This IAM role allows you to delegate access with defined permissions in the above policy to trusted entities without having to hard code your credentials in your code.</p>
<ol start="554">
<li>In the navigation pane, choose <strong>Roles</strong>, and then choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create role</span>
</li>
<li>Under <strong>Select type of trusted entity</strong>, choose <i class="fas fa-cube" style="color:#0073bb;"></i> <strong>AWS service</strong>.</li>
<li>Go to the <strong>Choose a use case</strong> section. Choose <span style="color:#0073bb;">Lambda</span>, and then choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Next: Permissions</span>
</li>
<li>In the <strong>Search</strong> field, enter: <input readonly class="copyable-inline-input" size="19" type="text" value="lambda_ddb_s3_polly">
</li>
<li>Select the <span style="color:#0073bb;"><i class="far fa-check-square"></i> <strong>lambda_ddb_s3_polly</strong></span> policy.</li>
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Next: Tags</span>
</li>
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Next: Review</span>
</li>
<li>For <strong>Role name</strong>, enter: <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesRole">
</li>
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create role</span>
</li>
</ol>
<h2 id="step34">Task 7: (Python) - Creating the Lambda ListFunction</h2>

<p>In this task, you will create your Lambda List function. To do this, you edit the <em>ListFunction.py</em> file.</p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram4-2020.png" alt="Lab 6 Diagram"></p>
<ol start="563">
<li>Download the source code to your computer from the following link:</li>
</ol>
<p><strong>List Function Source file:</strong> <a href="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/scripts/ListFunction.py" target="_blank">ListFunction.py</a></p>

<h3>Task 7.1: (Python) - Coding the ListFunction</h3>

<p>It is now time for you to code! You will need to edit the <strong>ListFunction.py</strong> to create and test your Lambda function by using this code. You can either edit this code in your IDE, or you can edit it in the next task directly in the Lambda console.</p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> If you would rather not code and just use the Solution file, skip to <a href="#task72link" target="_self">Task 7.2: Create your PollyNotes-ListFunction in Lambda</a>.</p>
<ol start="564">
<li>Your goal is to develop a Lambda function that will receive a userId as an input and return a list of Note objects.</li>
</ol><ul>
<li>
<i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> The input from Lambda will look similar to the following:</li>
</ul>
<p><span style="font-family:Courier;">{<br><br>
   "userId": "testuser"<br><br>
}<br>
</span></p>
<ul>
<li>Your function should query your DynamoDB table (pollynotes) to retrieve a list of items ["Items"] that belong to the userId that is being sent as a payload via the API Gateway.</li>
<li>
<i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> <strong>Expected Output:</strong>
</li>
</ul>
<p><span style="font-family:Courier;">[<br><br>
  {<br><br>
    "userId": "testuser",<br><br>
    "noteId": "001",<br><br>
    "note": "My note to myself"<br><br>
  },<br><br>
  {<br><br>
    "userId": "testuser",<br><br>
    "noteId": "002",<br><br>
    "note": "My new note to myself"<br><br>
  }<br><br>
]<br>
</span></p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> There are comments in the code to give you some help. However, it is your responsibility to make good use of those comments or to do it on your own.</p>
<ul>
<li>
<p>There are many ways to query DynamoDB. For example, on how to use the query method in the boto3 SDK, go to:</p>
<ul>
<li>
<i class="fas fa-info-circle" style="color:#00a1c9;"></i> <a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/GettingStarted.Python.04.html" target="_blank">Query and Scan Example</a>
</li>
<li>
<i class="fas fa-info-circle" style="color:#00a1c9;"></i> <a href="https://boto3.readthedocs.io/en/latest/guide/dynamodb.html#querying-and-scanning" target="_blank">Boto3 DynamoDB Reference - Querying and Scanning</a>
</li>
</ul>
</li>
<li><p>Overall, the work you have to do is to query DynamoDB to find all of the notes of the userId based on the <strong>note</strong> argument and return a <strong>JSON list</strong> based on the response of your query. Good luck and remember that there is always Solution Code that can help you! Once you think you have something working or would like to test things out, follow the Task 7.3 steps.</p></li>
<li><p>If you need to peek at the solution code, you can find it at the following URL:</p></li>
</ul>
<p><a id="task72link" target="_blank"></a></p>

<p><strong>Solution Code:</strong> <a href="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/scripts/ListFunctionSolution.py" target="_blank">Solution Code</a></p>

<h3>Task 7.2: (Python) - Create your PollyNotes-ListFunction in Lambda</h3>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> This lab uses the <i class="fas fa-toggle-on" style="color:#0073bb;"></i> <strong>Updated Lambda Console</strong>. If you are unsure which version you are using, simply choose the <i class="fas fa-bars"></i> icon in the top-left corner of the Lambda console and it will indicate if the <strong>Update Lambda Console</strong> option is on or off. If it shows <strong>off</strong>, select the toggle option to turn it on.</p>
<ol start="565">
<li>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>Lambda</strong>.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Verify that you are in the <strong>correct region</strong>. If you are unsure of the region, you can see it identified in the <strong>Lab Information</strong> section to the left of these instructions.</p>
<ol start="566">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Create function</strong></span> and make the following updates:</li>
</ol><ul>
<li>
<strong>Author from scratch</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i>
</li>
<li>
<strong>Function name:</strong> <input readonly class="copyable-inline-input" size="23" type="text" value="PollyNotes-ListFunction">
</li>
<li>
<strong>Runtime:</strong> <input readonly class="copyable-inline-input" size="10" type="text" value="Python 3.8">
</li>
<li>
<strong>Permissions:</strong>
<ul>
<li>Expand <i class="fas fa-caret-right"></i> <strong>Change default execution role</strong>.</li>
<li>
<strong>Execution role:</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="20" type="text" value="Use an existing role">
</li>
<li>
<strong>Existing role:</strong> <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesRole">
</li>
</ul>
</li>
</ul><ol start="567">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Create function</strong></span></p></li>
<li><p>Scroll to the right and select the <strong>Configuration</strong> tab. In the <strong>General Configuration</strong> card, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span>. In the window that appears, enter the following:</p></li>
</ol><ul>
<li>
<strong>Description</strong>: <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out">
</li>
</ul>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Due to the expansion of <strong>AWS Lambda states to all functions</strong> for the <strong>delayed update configuration mechanism</strong>, the <strong>Description</strong> requires the <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out"> value to be supplied. If this is not added, you will receive the following error when you try to update the function in later steps.</p>
<ul>
<li><strong><em>Failed to upload project to Lambda because of 409, ResourceConflictException.</em></strong></li>
</ul><ol start="569">
<li>Scroll down to <strong>Code source</strong> and replace the existing code in the file named <strong>lambda_function.py</strong> with the code from the <strong>ListFunction.py</strong> file that you downloaded in the previous step.</li>
</ol>
<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> The ListFunction.py file contains the following <em>stub</em> code:</p>

<p><span style="font-family:Courier;">  stubResponse = '[{"userId": "testuser", "note": "This is a stub response being returned by Lambda", "noteId": "001"}]'</span><br><br>
<span style="font-family:Courier;">  stubJSON = json.loads(stubResponse)</span><br><br>
<span style="font-family:Courier;">  return stubJSON<br>
</span></p>

<p>Your task is to develop code to replace this stub. You will need to:</p>
<ul>
<li>Evaluate the payload from API Gateway</li>
<li>Query the DynamoDB table</li>
<li>Return the Items from your DynamoDB Query</li>
</ul>
<p>If you chose not to code this piece you can paste in the <a href="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/scripts/ListFunctionSolution.py" target="_blank">code from the solution file found here</a></p>
<ol start="570">
<li>Choose <strong>File</strong> &gt; <strong>Save</strong>.</li>
<li>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Deploy</span>
</li>
</ol>
<h3>Task 7.3: (Python) - Testing the PollyNotes-ListFunction in Lambda</h3>

<p>The next step is to test the Lambda function from the Lambda UI.</p>
<ol start="572">
<li>Choose the <strong>Test</strong> tab and make the following selections under <strong>Test event</strong>:</li>
</ol><ul>
<li>
<i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="9" type="text" value="New event">.</li>
<li>
<strong>Template:</strong> <input readonly class="copyable-inline-input" size="11" type="text" value="hello-world">
</li>
<li>
<strong>Event name</strong>, enter: <input readonly class="copyable-inline-input" size="8" type="text" value="ListTest">
</li>
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> Replace the JSON payload with the following:</li>
</ul><pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testuser"</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre><ol start="573">
<li><p>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save Changes</span></p></li>
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Test</span></p></li>
</ol>
<p>It is normal for it to take a little longer as this is the first time you are running your Lambda function.</p>
<ol start="575">
<li>There should be a green check mark just under the name of your Lambda function name with the message <em>Execution result: succeeded (logs)</em>. Choose <strong>Details</strong> and you should see the output of your Lambda function listing a few notes that you have created in the DynamoDB section.</li>
</ol>
<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> For example:</p>

<p><span style="font-family:Courier;">[<br><br>
  {<br><br>
    "userId": "testuser",<br><br>
    "noteId": "001",<br><br>
    "note": "My note to myself"<br><br>
  },<br><br>
  {<br><br>
    "userId": "testuser",<br><br>
    "noteId": "002",<br><br>
    "note": "My new note to myself"<br><br>
  }<br><br>
]<br>
</span></p>

<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> Congratulations! You have just created the PollyNotes-ListFunction that will act as your backend when a user will need to list their notes.</p>

<h2 id="step35">Task 8: (Python) - Creating the API Gateway</h2>

<p>In this task, you will create a Restful API to front the back-end Lambda function. The API will use Amazon Cognito identities for authentication. For the application, you will be using the AWS API Gateway Service.</p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram5-2020.png" alt="Lab 6 Diagram"></p>
<ol start="576">
<li>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>API Gateway</strong>.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Verify that you are in the <strong>correct region</strong>. If you are unsure of the region, you can see it identified in the <strong>Lab Information</strong> section to the left of these instructions.</p>
<ol start="577">
<li>Under <strong>Choose an API type</strong>, select <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Build</span> from the <strong>REST API</strong> card.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> There is a similar option labeled as <strong>REST API Private</strong>. Please be mindful not to select this option.</p>
<ol start="578">
<li>In the <strong>Create your first API</strong> dialog box, choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">OK</span>
</li>
<li>Under <strong>Create new API</strong>, select <strong>New API</strong>.</li>
<li>Enter the following formation:
<ul>
<li>
<strong>API name</strong>, enter: <input readonly class="copyable-inline-input" size="13" type="text" value="PollyNotesAPI">
</li>
<li>
<strong>Description</strong>, enter: <input readonly class="copyable-inline-input" size="13" type="text" value="PollyNotesAPI">
</li>
<li>
<strong>Endpoint Type</strong>, select <input readonly class="copyable-inline-input" size="8" type="text" value="Regional">.</li>
</ul>
</li>
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Create API</span>
</li>
</ol>
<h3>Task 8.1: (Python) - Creating the Amazon Cognito Authorizer</h3>

<p>In this task, you create the Amazon Cognito Authorizer. The Authorizer will allow you to control access to the API with the Amazon Cognito User Pool.</p>
<ol start="582">
<li>In the left navigation menu, choose <strong>Authorizers</strong>.</li>
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>+ Create New Authorizer</strong></span>
</li>
<li>
<p>Enter the following information:</p>
<ul>
<li>
<strong>Name</strong>: <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesPool">
</li>
<li>
<strong>Type</strong>: <input readonly class="copyable-inline-input" size="7" type="text" value="Cognito">
</li>
<li>
<strong>Cognito User Pool</strong>: <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesPool">
</li>
<li>
<strong>Token Source</strong>: <input readonly class="copyable-inline-input" size="13" type="text" value="Authorization">
</li>
<li>
<strong>Token Validation</strong>: Leave empty.</li>
</ul>
</li>
<li><p>Choose <span style="color:#0073bb;"><strong>Create</strong></span></p></li>
</ol>
<h3>Task 8.2: (Python) - Creating the resources</h3>

<p>In this task, you create your API Resources.</p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram5-2020.png" alt="Lab 6 Diagram"></p>
<ol start="586">
<li>In the navigation pane, choose <strong>Resources</strong>.</li>
<li><p>Under <strong>Resources</strong>, select <strong><span style="color:#0073bb;">/</span></strong>.</p></li>
<li><p>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Actions <i class="fas fa-caret-down"></i></span>, and then select <strong>Create Resource</strong>.</p></li>
<li><p>Under <strong>Resource Name</strong>, enter the following: <input readonly class="copyable-inline-input" size="5" type="text" value="notes"></p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> The <strong>Resource Path</strong> will will populate automatically with <strong>notes</strong>.</p>
<ol start="590">
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Create Resource</strong></span>
</li>
</ol>
<p>Now that you have created your resource, you need to create your Methods.  </p>

<h3>Task 8.3: (Python) - Creating the API GET method</h3>
<ol start="591">
<li>If not already selected, choose the <strong>Resources</strong> link and select <span style="color:#0073bb;"><strong>/notes</strong></span>
</li>
<li>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Actions <i class="fas fa-caret-down"></i></span>, and then select <strong>Create Method</strong>.</li>
<li><p>Select <strong>GET</strong> and then choose <i class="fas fa-check-circle"></i> (check mark tick).</p></li>
<li><p>For <strong>Integration type</strong>, select <i class="far fa-dot-circle" style="color:#0073bb;"></i> <strong>Lambda Function</strong>.</p></li>
<li><p>Under <strong>Lambda Function</strong>, type an uppercase <input readonly class="copyable-inline-input" size="1" type="text" value="P">, then select your Lambda <strong>PollyNotes-ListFunction</strong>.</p></li>
<li><p>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
<li><p>In the <strong>Add Permission to Lambda Function</strong> dialog box, choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">OK</span></p></li>
<li><p>Choose <span style="color:#0073bb;"><strong>Method Request</strong></span></p></li>
<li><p>In the <strong>Settings</strong> section, next to <strong>Authorization</strong>, choose <i class="fas fa-pencil-alt" style="color:#0073bb;"></i> (Edit).</p></li>
<li><p>Select <strong>PollyNotesPool</strong> and then, choose <i class="fas fa-check-circle"></i> (check mark tick).</p></li>
<li><p>In the breadcrumb, choose <span style="color:#0073bb;"><strong>&lt;- Method Execution</strong></span></p></li>
<li><p>Choose <span style="color:#0073bb;"><strong>Integration Request</strong></span></p></li>
<li><p>Expand the <i class="fas fa-caret-right"></i> <strong>Mapping Templates</strong> section.</p></li>
<li><p>Select <i class="far fa-dot-circle" style="color:#0073bb;"></i> <strong>When there are no templates defined (recommended)</strong>.</p></li>
<li><p>Under <strong>Content-Type</strong>, choose <i class="fas fa-plus-circle"></i> <span style="color:#0073bb;"><strong>Add mapping template</strong></span></p></li>
<li><p>Enter <input readonly class="copyable-inline-input" size="16" type="text" value="application/json"> and choose <i class="fas fa-check-circle"></i> (check mark tick).</p></li>
<li><p><i class="fas fa-file-code" style="color:#00a1c9;"></i> In the box that appeared below, enter the following:</p></li>
</ol><pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testuser"</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> You are hard coding the value of <em>userId</em> here so that when you do your first test from the web interface, you can see the original notes you have created in DynamoDB. Since you won't be creating the CreateUpdate Function until after doing your test, you would have no way to create a note for your user. The first step once you are done fully testing the List function, will be to change this mapping template to be dynamic based on the Amazon Cognito ID of the user login.</p>
<ol start="608">
<li><p>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span></p></li>
<li><p>Choose the <span style="color:#0073bb;"><strong>/notes</strong></span> resource.</p></li>
<li><p>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Actions <i class="fas fa-caret-down"></i></span> and select <strong>Enable CORS</strong>.</p></li>
<li><p>Under <strong>Gateway Responses for PollyNotes API API</strong>, check option for <i class="far fa-check-square" style="color:#0073bb;"></i> <strong>DEFAULT 4XX</strong> and <i class="far fa-check-square" style="color:#0073bb;"></i> <strong>DEFAULT 5XX</strong>.</p></li>
<li><p>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Enable CORS and replace existing CORS headers</span></p></li>
<li><p>In the <strong>Confirm method changes</strong> dialog box, choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Yes, replace existing values</span></p></li>
<li>
<p>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Actions <i class="fas fa-caret-down"></i></span>, then select <strong>Deploy API</strong>. Make the following updates:</p>
<ul>
<li>
<strong>Deployment stage</strong>: <input readonly class="copyable-inline-input" size="11" type="text" value="[New Stage]">
</li>
<li>
<strong>Stage name</strong>: <input readonly class="copyable-inline-input" size="4" type="text" value="prod">
</li>
</ul>
</li>
<li><p>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Deploy</span></p></li>
<li><p>Copy the <strong>Invoke URL</strong> and paste it into a file. You will need it later in the lab.</p></li>
<li><p>In the <strong>prod Stage Editor</strong>, choose the <strong>Logs/Tracing</strong> tab and make the following updates:</p></li>
</ol><ul>
<li>
<strong>CloudWatch Settings</strong>
<ul>
<li>
<strong>Enable CloudWatch Logs</strong> <i class="fas fa-check-square" style="color:#0073bb;"></i>
</li>
<li>
<strong>Log level</strong> <input readonly class="copyable-inline-input" size="4" type="text" value="INFO">
</li>
<li>
<strong>Log full requests/responses data</strong> <i class="fas fa-check-square" style="color:#0073bb;"></i>
</li>
</ul>
</li>
</ul><ol start="618">
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save Changes</span>
</li>
</ol>
<h2 id="step36">Task 9: (Python) - Creating the front-end website</h2>

<p>In this task, you create the front-end website.</p>
<ol start="619">
<li>Download and extract the following zip file:</li>
</ol>
<p><strong>Source file:</strong> <a href="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/scripts/polly-notes-web-bucket-root.zip" target="_blank">ZIP File</a></p>
<ol start="620">
<li>
<i class="fas fa-keyboard"></i> Modify the <em>main.bundle.js</em> file (lines 2-4) and change the following values:</li>
</ol><pre class="highlight javascript"><code><span class="c1">// Change the following three variable's values:</span>&#x000A;<span class="kd">var</span> <span class="nx">API_GATEWAY_INVOKE_URL</span> <span class="o">=</span> <span class="s2">"https://your-api-url"</span>&#x000A;<span class="kd">var</span> <span class="nx">COGNITO_POOL_ID</span> <span class="o">=</span> <span class="s1">'us-east-1-xxxxxxxxxxx'</span>&#x000A;<span class="kd">var</span> <span class="nx">COGNITO_APP_CLIENT_ID</span> <span class="o">=</span> <span class="s1">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>&#x000A;</code></pre>
<p>You should have noted the needed values from prior lab steps. If you do not have details, you can get them by using the Console and the following paths:</p>
<ul>
<li><strong>Services -&gt; API Gateway -&gt; PollyNotesAPI -&gt; Stages -&gt; prod (API Gateway Invoke URL)</strong></li>
<li><strong>Services -&gt; Cognito -&gt; Manage User Pools -&gt; PollyNotesPool (Cognito Pool ID)</strong></li>
<li><strong>Services -&gt; Cognito -&gt; Manage User Pools -&gt; PollyNotesPool -&gt; App clients (Cognito App client ID)</strong></li>
</ul><ol start="621">
<li><p>Next, you need to enable CORS on the MP3 Bucket. When users access your website, they will be loading the website from the static Website bucket. Then, they will use javascript in their browser to connect to two different endpoints; API Gateway and the MP3 bucket. You already enabled CORS on the API Gateway, but you now need to enable CORS on your MP3 bucket, so that it can set response headers.</p></li>
<li><p>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>Amazon S3</strong>.</p></li>
<li><p>Choose your <input readonly class="copyable-inline-input" size="38" type="text" value="polly-notes-mp3-&lt;firstname&gt;-&lt;lastname&gt;"> bucket.</p></li>
<li><p>Choose the <strong>Permissions</strong> tab.</p></li>
<li><p>Navigate down to the <strong>Cross-origin resource sharing (CORS)</strong> section, then choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span></p></li>
<li><p><i class="fas fa-file-code" style="color:#00a1c9;"></i> Copy and paste the following JSON code into the text box, then choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save changes</span></p></li>
</ol><pre class="highlight json"><code><span class="p">[</span><span class="w">&#x000A;    </span><span class="p">{</span><span class="w">&#x000A;        </span><span class="s2">"AllowedHeaders"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">&#x000A;            </span><span class="s2">"*"</span><span class="w">&#x000A;        </span><span class="p">],</span><span class="w">&#x000A;        </span><span class="s2">"AllowedMethods"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">&#x000A;            </span><span class="s2">"GET"</span><span class="w">&#x000A;        </span><span class="p">],</span><span class="w">&#x000A;        </span><span class="s2">"AllowedOrigins"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">&#x000A;            </span><span class="s2">"*"</span><span class="w">&#x000A;        </span><span class="p">],</span><span class="w">&#x000A;        </span><span class="s2">"ExposeHeaders"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">&#x000A;    </span><span class="p">}</span><span class="w">&#x000A;</span><span class="p">]</span><span class="w">&#x000A;</span></code></pre><ol start="627">
<li>Next, go to your Website bucket. In the breadcrumb trail, choose <span style="color:#0073bb;"><strong>Amazon S3</strong></span>, and then, choose your <input readonly class="copyable-inline-input" size="38" type="text" value="polly-notes-web-&lt;firstname&gt;-&lt;lastname&gt;"> bucket.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Upload</span>
</li>
<li>Upload all the files and folders in the folder named <input readonly class="copyable-inline-input" size="27" type="text" value="polly-notes-web-bucket-root"> (not the folder itself) by dragging them onto the upload window.</li>
</ol>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/drag.png" alt="Dragging files into S3"></p>
<ol start="630">
<li><p>Move to the bottom of the screen, and choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Upload</span></p></li>
<li><p>Once the files and folders have uploaded successfully (32 total), choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Close</span></p></li>
</ol>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/files-example.png" alt="Amazon S3 website files and folders listing"></p>

<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> There should be a combined total of <strong>10 files and folders</strong> in the <strong>root</strong> of the <input readonly class="copyable-inline-input" size="38" type="text" value="polly-notes-web-&lt;firstname&gt;-&lt;lastname&gt;"> Amazon S3 bucket.</p>
<ol start="632">
<li>Choose the <strong>Permissions</strong> tab.</li>
<li>In the <strong>Block public access (bucket settings)</strong> card choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span>
</li>
<li>Unselect <i class="far fa-square"></i> <strong>Block</strong> <em>all</em> <strong>public access</strong>.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save changes</span>
</li>
<li>A confirmation box will appear; type <input readonly class="copyable-inline-input" size="7" type="text" value="confirm"> and choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Confirm</span>
</li>
<li>Move down to the <strong>Bucket policy</strong> card and choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span>
</li>
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> Copy and paste the following bucket policy into the <strong>Bucket policy</strong> field.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Ensure that you replace your bucket name.</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"Version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-10-17"</span><span class="p">,</span><span class="w">&#x000A;    </span><span class="s2">"Statement"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">&#x000A;        </span><span class="p">{</span><span class="w">&#x000A;            </span><span class="s2">"Sid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PublicReadGetObject"</span><span class="p">,</span><span class="w">&#x000A;            </span><span class="s2">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">&#x000A;            </span><span class="s2">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="p">,</span><span class="w">&#x000A;            </span><span class="s2">"Action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"s3:GetObject"</span><span class="p">,</span><span class="w">&#x000A;            </span><span class="s2">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:s3:::polly-notes-web-&lt;firstname&gt;-&lt;lastname&gt;/*"</span><span class="w">&#x000A;        </span><span class="p">}</span><span class="w">&#x000A;    </span><span class="p">]</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre><ol start="639">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save changes</span></p></li>
<li><p>The description of your bucket should now be flagged with <span style="background-color:#D90000;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Publicly accessible</span> and the <strong>Permissions overview</strong> card will read <strong>Access</strong> as<br>
<i class="fas fa-exclamation-triangle" style="color:#D90000;"></i> <span style="color:#D90000;">Public</span></p></li>
<li><p>Choose the <strong>Properties</strong> tab.</p></li>
<li><p>In the <strong>Static website hosting</strong> card, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span></p></li>
</ol>
<p>Configure the following settings:</p>
<ul>
<li>
<strong>Static website hosting:</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i> Enable</li>
<li>
<strong>Index document</strong>: <input readonly class="copyable-inline-input" size="10" type="text" value="index.html">
</li>
<li>
<strong>Error document:</strong> <input readonly class="copyable-inline-input" size="10" type="text" value="error.html">
</li>
</ul><ol start="643">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save changes</span></p></li>
<li><p>Move to the <strong>Static website hosting</strong> card and copy your <em>Bucket website endpoint</em> URL to a text editor.</p></li>
</ol>
<p>You will use this again in the lab.</p>

<h2 id="step37">Task 10: (Python) - Testing the web application</h2>

<p>In this task, you test the web application by loading your Amazon S3 Hosted URL.</p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> You can obtain your Amazon S3 Hosted URL by going into the Amazon S3 Console. Select your web hosting bucket. Choose the <strong>Properties</strong> tab, and then choose, <strong>Static website hosting</strong>.</p>
<ol start="645">
<li>In a browser, enter your Static website hosting URL. You should be presented with a login page.</li>
</ol>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/pollynotes-loginpage.png" alt="Amazon Polly Notes Login Page"></p>
<ol start="646">
<li>Login with the following:</li>
</ol><ul>
<li>For <strong>UserName</strong>, enter: <input readonly class="copyable-inline-input" size="7" type="text" value="student">
</li>
<li>For <strong>Password</strong>, enter: <input readonly class="copyable-inline-input" size="7" type="text" value="student">
</li>
</ul><ol start="647">
<li>You should be presented with a page that looks like the following:</li>
</ol>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/pollynotes-homepage.png" alt="Polly Notes Login Page"></p>

<p>You should expect to see the notes you created earlier. All other functionality, such as adding notes, updating, deleting, or playing will not work. You need to create the API methods and Lambda functions to enable this functionality.</p>

<h2 id="step38">Task 11: (Python) - Creating the remaining Lambda functions</h2>

<p>Now that the ListFunction is working end-to-end, you need to create the rest of the application. Having a list of the notes is great, but if you can't Create, Update, Delete and Dictate, the application isn't doing much.</p>

<p>You have two options for the remaining Lambda functions:</p>
<ul>
<li>Take it easy on me! Use the Solution Code to create the rest of the Lambda functions.</li>
<li>Take the challenge! If you have time, create the other Lambda functions manually that interact with DynamoDB (Dictate, CreateUpdate, Search, and Delete). It is considered a challenge to complete this given the time provided for the lab.</li>
</ul>
<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram6-2020.png" alt="Lab 6 Diagram"></p>

<p>If you decide to take the challenge, the recommendation is to start by using the Solution Code and then go back to replace the functions with your own code to ensure you get to see the full application before spending more time coding.</p>

<h3>Task 11.1: (Python) - Creating the Lambda DictateFunction</h3>

<p>In this task, you work with the Lambda DictateFunction. This function is already completely coded for you due to the length of this lab. This is why you will not find Solution Code for Dictate.</p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> This lab uses the <i class="fas fa-toggle-on" style="color:#0073bb;"></i> <strong>Updated Lambda Console</strong>.</p>
<ol start="648">
<li><p>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select <strong>Lambda</strong>.</p></li>
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Create function</strong></span> and make the following updates:</p></li>
</ol><ul>
<li>
<strong>Author from scratch</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i>
</li>
<li>
<strong>Function name:</strong> <input readonly class="copyable-inline-input" size="26" type="text" value="PollyNotes-DictateFunction">
</li>
<li>
<strong>Runtime:</strong> <input readonly class="copyable-inline-input" size="10" type="text" value="Python 3.8">
</li>
<li>
<strong>Permissions:</strong>
<ul>
<li>Expand <i class="fas fa-caret-right"></i> <strong>Change default execution role</strong>.</li>
<li>
<strong>Execution role:</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="20" type="text" value="Use an existing role">
</li>
<li>
<strong>Existing role:</strong> <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesRole">
</li>
</ul>
</li>
</ul><ol start="650">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Create function</strong></span></p></li>
<li><p>Scroll to the right and select the <strong>Configuration</strong> tab. In the <strong>General Configuration</strong> card, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span>. In the window that appears, enter the following:</p></li>
</ol><ul>
<li>
<strong>Description</strong>: <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out">
</li>
</ul>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Due to the expansion of <strong>AWS Lambda states to all functions</strong> for the <strong>delayed update configuration mechanism</strong>, the <strong>Description</strong> requires the <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out"> value to be supplied. If this is not added, you will receive the following error when you try to update the function in later steps.</p>
<ul>
<li><strong><em>Failed to upload project to Lambda because of 409, ResourceConflictException.</em></strong></li>
</ul><ol start="652">
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> In the <strong>Code source</strong> section, copy and paste the code from the following solution file in the <input readonly class="copyable-inline-input" size="18" type="text" value="lambda_function.py"> file replacing the original content:</li>
</ol>
<p><a href="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/scripts/DictateFunction.py" target="_blank">DictateFunction.py</a></p>
<ol start="653">
<li><p>Choose <strong>File</strong> &gt; <strong>Save</strong>.</p></li>
<li><p>Choose  <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Deploy</span></p></li>
<li><p>Choose <strong>Configuration</strong>.</p></li>
<li><p>From the list of option on the left choose <strong>Environment variables</strong> and the select <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span></p></li>
<li><p>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Add environment variable</span></p></li>
<li><p>Add the following values:</p></li>
</ol><ul>
<li>
<strong>Key</strong>: <input readonly class="copyable-inline-input" size="15" type="text" value="MP3_BUCKET_NAME">
</li>
<li>
<strong>Value</strong>: <input readonly class="copyable-inline-input" size="38" type="text" value="polly-notes-mp3-&lt;firstname&gt;-&lt;lastname&gt;">. (Update with your bucket name.)</li>
</ul><ol start="659">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Save</span>
</li>
<li>Now test the function. Choose the <strong>Test</strong> tab and configure the following fields under <strong>Test event</strong>:</li>
</ol><ul>
<li>
<i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="9" type="text" value="New event">
</li>
<li>
<strong>Template:</strong> <input readonly class="copyable-inline-input" size="11" type="text" value="hello-world">
</li>
<li>
<strong>Name:</strong> <input readonly class="copyable-inline-input" size="11" type="text" value="DictateTest">
</li>
</ul><ol start="661">
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> Replace the JSON payload with the following:</li>
</ol><pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"voiceId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Russell"</span><span class="p">,</span><span class="w">&#x000A;    </span><span class="s2">"note"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">&#x000A;        </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testuser"</span><span class="p">,</span><span class="w">&#x000A;        </span><span class="s2">"noteId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"001"</span><span class="w">&#x000A;    </span><span class="p">}</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre><ol start="662">
<li><p>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Save changes</span></p></li>
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Test</span></p></li>
</ol>
<p>There should be a green check mark just under the name of your Lambda function name on the left indicating <em>Execution result: succeeded (logs)</em>.</p>
<ol start="664">
<li>Choose the <strong>Details</strong> link under that text. You should see the output of your Lambda function providing a very long URL to your MP3 bucket which represents a pre-signed URL.</li>
</ol>
<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> For example:</p>

<p><span style="font-family:Courier;">"htt<span>ps://polly-notes-mp3-&lt;firstname&gt;-&lt;lastname&gt;.s3.amazonaws.com/testuser/001.mp3?X-Amz-Security-Token=..</span>."<br>
</span></p>
<ol start="665">
<li>Copy and paste that URL in your browser. It will prompt you to download the file. Download it and then listen to Russell dictating your note!</li>
</ol>
<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> Congratulations! You have now created your Lambda Dictate function.</p>

<h3>Task 11.2: (Python) - Creating the Lambda CreateUpdateFunction</h3>
<ol start="666">
<li>Choose the <span style="color:#0073bb;">Functions</span> bread crumb at the top of the page.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Create function</strong></span> and make the following updates:</li>
</ol><ul>
<li>
<strong>Author from scratch</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i>
</li>
<li>
<strong>Function name:</strong> <input readonly class="copyable-inline-input" size="31" type="text" value="PollyNotes-CreateUpdateFunction">
</li>
<li>
<strong>Runtime:</strong> <input readonly class="copyable-inline-input" size="10" type="text" value="Python 3.8">
</li>
<li>
<strong>Permissions:</strong>
<ul>
<li>Expand <i class="fas fa-caret-right"></i> <strong>Change default execution role</strong>.</li>
<li>
<strong>Execution role:</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="20" type="text" value="Use an existing role">
</li>
<li>
<strong>Existing role:</strong> <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesRole">
</li>
</ul>
</li>
</ul><ol start="668">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Create function</strong></span></p></li>
<li><p>Scroll to the right and select the <strong>Configuration</strong> tab. In the <strong>General Configuration</strong> card, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span>. In the window that appears, enter the following:</p></li>
</ol><ul>
<li>
<strong>Description</strong>: <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out">
</li>
</ul>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Due to the expansion of <strong>AWS Lambda states to all functions</strong> for the <strong>delayed update configuration mechanism</strong>, the <strong>Description</strong> requires the <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out"> value to be supplied. If this is not added, you will receive the following error when you try to update the function in later steps.</p>
<ul>
<li><strong><em>Failed to upload project to Lambda because of 409, ResourceConflictException.</em></strong></li>
</ul><ol start="670">
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> In the <strong>Code source</strong> section, copy and paste the code from the following solution file in the <input readonly class="copyable-inline-input" size="18" type="text" value="lambda_function.py"> file replacing the original content:</li>
</ol>
<p><a href="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/scripts/CreateUpdateFunctionSolution.py" target="_blank">CreateUpdateFunctionSolution.py</a></p>
<ol start="671">
<li>Choose <strong>File</strong> &gt; <strong>Save</strong>.</li>
<li>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Deploy</span>
</li>
<li>Now test the function. Choose the <strong>Test</strong> tab and configure the following fields under <strong>Test event</strong>:</li>
</ol><ul>
<li>
<i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="9" type="text" value="New event">
</li>
<li>
<strong>Template:</strong> <input readonly class="copyable-inline-input" size="11" type="text" value="hello-world">
</li>
<li>
<strong>Name:</strong> <input readonly class="copyable-inline-input" size="16" type="text" value="CreateUpdateTest">
</li>
</ul><ol start="674">
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> Replace the JSON payload with the following:</li>
</ol><pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testuser"</span><span class="p">,</span><span class="w">&#x000A;    </span><span class="s2">"noteId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"001"</span><span class="p">,</span><span class="w">&#x000A;    </span><span class="s2">"note"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My very new note to myself"</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre><ol start="675">
<li><p>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Save changes</span></p></li>
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Test</span></p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> It is normal for it to take a little longer as this is the first time you are running your Lambda function.</p>

<p>There should be a green check mark just under the name of your Lambda function name on the left indicating <em>Execution result: succeeded (logs)</em>.</p>
<ol start="677">
<li>Choose the <strong>Details</strong> link under that text. You should see the output of your Lambda function providing the noteId that you just uploaded. For example, <input readonly class="copyable-inline-input" size="5" type="text" value='"001"'>
</li>
</ol>
<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> Congratulations! You have now created your Lambda CreateUpdate function.</p>

<h3>Task 11.3: (Python) - Creating the Lambda SearchFunction</h3>
<ol start="678">
<li>Choose the <span style="color:#0073bb;">Functions</span> bread crumb at the top of the page.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Create function</strong></span> and make the following updates:</li>
</ol><ul>
<li>
<strong>Author from scratch</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i>
</li>
<li>
<strong>Function name:</strong> <input readonly class="copyable-inline-input" size="25" type="text" value="PollyNotes-SearchFunction">
</li>
<li>
<strong>Runtime:</strong> <input readonly class="copyable-inline-input" size="10" type="text" value="Python 3.8">
</li>
<li>
<strong>Permissions:</strong>
<ul>
<li>Expand <i class="fas fa-caret-right"></i> <strong>Change default execution role</strong>.</li>
<li>
<strong>Execution role:</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="20" type="text" value="Use an existing role">
</li>
<li>
<strong>Existing role:</strong> <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesRole">
</li>
</ul>
</li>
</ul><ol start="680">
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Create function</strong></span></p></li>
<li><p>Scroll to the right and select the <strong>Configuration</strong> tab. In the <strong>General Configuration</strong> card, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span>. In the window that appears, enter the following:</p></li>
</ol><ul>
<li>
<strong>Description</strong>: <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out">
</li>
</ul>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Due to the expansion of <strong>AWS Lambda states to all functions</strong> for the <strong>delayed update configuration mechanism</strong>, the <strong>Description</strong> requires the <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out"> value to be supplied. If this is not added, you will receive the following error when you try to update the function in later steps.</p>
<ul>
<li><strong><em>Failed to upload project to Lambda because of 409, ResourceConflictException.</em></strong></li>
</ul><ol start="682">
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> In the <strong>Code source</strong> section, copy and paste the code from the following solution file in the <input readonly class="copyable-inline-input" size="18" type="text" value="lambda_function.py"> file replacing the original content:</li>
</ol>
<p><a href="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/scripts/SearchFunctionSolution.py" target="_blank">SearchFunctionSolution.py</a></p>
<ol start="683">
<li>Choose <strong>File</strong> &gt; <strong>Save</strong>.</li>
<li>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Deploy</span>
</li>
<li>Now test the function. Choose the <strong>Test</strong> tab and configure the following fields under <strong>Test event</strong>:</li>
</ol><ul>
<li>
<i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="9" type="text" value="New event">
</li>
<li>
<strong>Template:</strong> <input readonly class="copyable-inline-input" size="11" type="text" value="hello-world">
</li>
<li>
<strong>Name:</strong> <input readonly class="copyable-inline-input" size="10" type="text" value="SearchTest">.</li>
</ul><ol start="686">
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> Replace the JSON payload with the following:</li>
</ol><pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testuser"</span><span class="p">,</span><span class="w">&#x000A;    </span><span class="s2">"note"</span><span class="p">:</span><span class="w"> </span><span class="s2">"very"</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre><ol start="687">
<li><p>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Save changes</span></p></li>
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Test</span></p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> It is normal for it to take a little longer as this is the first time you are running your Lambda function.</p>

<p>There should be a green check mark just under the name of your Lambda function name on the left indicating <em>Execution result: succeeded</em></p>

<p><i class="fas fa-clipboard-check" style="color:#6aaf35;"></i> You should see the output of your Lambda function listing a the note you just searched for using the <input readonly class="copyable-inline-input" size="4" type="text" value="very"> keyword that was just created in your previous CreateUpdateFunction.</p>

<p><span style="font-family:Courier;">[<br><br>
  {<br><br>
    "userId": "testuser",<br><br>
    "noteId": "001",<br><br>
    "note": "My very new note to myself"<br><br>
  }<br><br>
]<br>
</span></p>

<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> Congratulations! You have now created your Lambda Search function.</p>

<h3>Task 11.4: (Python) - Creating the Lambda DeleteFunction</h3>
<ol start="689">
<li>Choose the <span style="color:#0073bb;">Functions</span> bread crumb at the top of the page.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Create function</strong></span> and make the following updates:</li>
</ol><ul>
<li>
<strong>Author from scratch</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i>
</li>
<li>
<strong>Function name:</strong> <input readonly class="copyable-inline-input" size="25" type="text" value="PollyNotes-DeleteFunction">
</li>
<li>
<strong>Runtime:</strong> <input readonly class="copyable-inline-input" size="10" type="text" value="Python 3.8">
</li>
<li>
<strong>Permissions:</strong>
<ul>
<li>Expand <i class="fas fa-caret-right"></i> <strong>Change default execution role</strong>.</li>
<li>
<strong>Execution role:</strong> <i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="20" type="text" value="Use an existing role">
</li>
<li>
<strong>Existing role:</strong> <input readonly class="copyable-inline-input" size="14" type="text" value="PollyNotesRole">
</li>
</ul>
</li>
</ul><ol start="691">
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Create function</strong></span>
</li>
<li>Scroll to the right and select the <strong>Configuration</strong> tab. In the <strong>General Configuration</strong> card, choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Edit</span>. In the window that appears, enter the following:</li>
</ol><ul>
<li>
<strong>Description</strong>: <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out">
</li>
</ul>
<p><i class="fas fa-exclamation-triangle" style="color:#ec7211;"></i> Due to the expansion of <strong>AWS Lambda states to all functions</strong> for the <strong>delayed update configuration mechanism</strong>, the <strong>Description</strong> requires the <input readonly class="copyable-inline-input" size="18" type="text" value="aws:states:opt-out"> value to be supplied. If this is not added, you will receive the following error when you try to update the function in later steps.</p>
<ul>
<li><strong><em>Failed to upload project to Lambda because of 409, ResourceConflictException.</em></strong></li>
</ul><ol start="693">
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> In the <strong>Code source</strong> section, copy and paste the code from the following solution file into the <input readonly class="copyable-inline-input" size="18" type="text" value="lambda_function.py"> file replacing the original contents:</li>
</ol>
<p><a href="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/scripts/DeleteFunctionSolution.py" target="_blank">DeleteFunctionSolution.py</a></p>
<ol start="694">
<li>Choose <strong>File</strong> &gt; <strong>Save</strong>.</li>
<li>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Deploy</span>
</li>
<li>Now test the function. Choose the <strong>Test</strong> tab and configure the following fields under <strong>Test event</strong>:</li>
</ol><ul>
<li>
<i class="fas fa-dot-circle" style="color:#0073bb;"></i> <input readonly class="copyable-inline-input" size="9" type="text" value="New event">
</li>
<li>
<strong>Template:</strong> <input readonly class="copyable-inline-input" size="11" type="text" value="hello-world">
</li>
<li>
<strong>Name:</strong> <input readonly class="copyable-inline-input" size="10" type="text" value="DeleteTest">.</li>
</ul><ol start="697">
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> Replace the JSON payload with the following:</li>
</ol><pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"testuser"</span><span class="p">,</span><span class="w">&#x000A;    </span><span class="s2">"noteId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"001"</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre><ol start="698">
<li><p>Choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Save changes</span></p></li>
<li><p>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Test</span></p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> It is normal for it to take a little longer as this is the first time you are running your Lambda function.</p>

<p>There should be a green check mark just under the name of your Lambda function name on the left side of the screen with text mentioning: <em>Execution result: succeeded (logs)</em>.</p>
<ol start="700">
<li>Choose the <strong>Details</strong> link under that text. You should see the output of your Lambda function providing the noteId that you just deleted. For example, <input readonly class="copyable-inline-input" size="5" type="text" value='"001"'>.</li>
</ol>
<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> Congratulations! You have now created your Lambda Delete function.</p>

<h2 id="step39">Task 12: (Python) - Creating the remaining Restful API</h2>

<p>In this task, you create the remaining Restful API.</p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram-2020.png" alt="Lab 6 Diagram"></p>
<ol start="701">
<li>On the Services menu, choose <strong>API Gateway</strong>.</li>
<li>Choose <strong><span style="color:#0073bb;">PollyNotesAPI</span></strong>.</li>
<li>Choose the <span style="color:#0073bb;"><strong>/notes/GET</strong></span> method.</li>
<li>Choose <span style="color:#0073bb;"><strong>Integration Request</strong></span>
</li>
<li>Navigate to the bottom and expand <i class="fas fa-caret-right"></i> <strong>Mapping Templates</strong>.</li>
<li>Choose <strong>application/json</strong>.</li>
<li>
<i class="fas fa-file-code" style="color:#00a1c9;"></i> Scroll down and replace the mapping template with the following:</li>
</ol><pre class="highlight json"><code><span class="p">{</span><span class="w">&#x000A;    </span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"$context.authorizer.claims.sub"</span><span class="w">&#x000A;</span><span class="p">}</span><span class="w">&#x000A;</span></code></pre>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> You are now removing the hard coded value of <em>testuser</em> to a variable that is dynamically populated based on your authorizer. In this case, the authorizer is Amazon Cognito. This means, <em>userId</em> will now be set to the value of the Amazon Cognito ID of the user login.</p>
<ol start="708">
<li>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Save</strong></span>
</li>
<li>Download the following Swagger file (API-Gateway-for-students-swagger.yaml):</li>
</ol>
<p><strong>Source file:</strong> <a href="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/scripts/API-Gateway-for-students-swagger.yaml" target="_blank">Swagger</a></p>
<ol start="710">
<li>Modify <strong>line 11</strong> of the file to replace it with your <strong>Amazon Cognito User Pool ARN</strong> (in between the quotes "").</li>
<li>
<strong>Save</strong> the file.</li>
<li>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Actions <i class="fas fa-caret-down"></i></span> and select <strong>Import API</strong>.</li>
<li>Navigate to the bottom of the page and change the <strong>Import mode</strong> to <strong>Merge</strong>.</li>
</ol>
<p><i class="fas fa-exclamation-triangle" style="color:#d13212;"></i> Be mindful not to select <input readonly class="copyable-inline-input" size="9" type="text" value="Overwrite">.</p>
<ol start="714">
<li>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Select Swagger File</span> and then select your saved Swagger file.</li>
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Import</span>
</li>
</ol>
<p>The Swagger file created the additional resources and methods for your API. You still need to integrate the Methods with your Lambda functions.</p>
<ol start="716">
<li>Choose the /<span style="color:#0073bb;">notes</span>/<span style="color:#6aaf35;">POST</span> method.</li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> If you encounter an error reading, <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;"><i class="fas fa-exclamation-circle" style="color:red;"></i> You do not have permission to perform this action.</span> you can ignore it.</p>

<p>The reason for this error is due to the swagger file specifying a mock function from another region. API Gateway tries to pull it up and returns the error because you do not have permissions to that region.</p>
<ol start="717">
<li>Choose <span style="color:#0073bb;"><strong>Integration Request</strong></span>
</li>
<li>For <strong>Lambda Region</strong>, choose <i class="fas fa-pencil-alt" style="color:#0073bb;"></i> (edit).</li>
<li>Select your <strong>Lambda Region</strong> based on what you have noted before and then, choose <i class="fas fa-check-circle"></i> (check mark tick).</li>
<li>For <strong>Lambda Function</strong>, type P and then select <strong>PollyNotes-CreateUpdateFunction</strong>. Choose <i class="fas fa-check-circle"></i> (check mark tick).</li>
<li>In the <strong>Add Permission to Lambda Function</strong> dialog box, make sure the Lambda function reflects the correct name.</li>
</ol><ul>
<li><p>If the name is correct, choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>OK</strong></span> to accept and allow invocation permissions to be created and your trigger to be setup.</p></li>
<li>
<p>If it reads as the <strong>Mock</strong> function name, we have to do a couple additional steps to workaround this UI issue.</p>
<ul>
<li>Choose <span style="background-color:#257ACF;font-weight:bold;font-size:90%;color:white;border-radius:5px;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>OK</strong></span>.</li>
<li>Choose <strong>Resources</strong> link on the left to leave that section.</li>
<li>Next choose the appropriate method and select <strong>Integration Request</strong> and repeat the instructions as normal.</li>
<li>You should see that the region is set correctly but the <strong>Lambda Function</strong> is pointing to <strong>arn:aws:lambda:us-west-2:012345678901:function:Mock</strong> and needs to be updated.</li>
<li>
<i class="fas fa-sticky-note" style="color:#ec7211;"></i> There appears to be a bug with the API Gateway UI that causes this issue. It should be resolved soon. Until then, this is the workaround.</li>
</ul>
</li>
</ul><ol start="722">
<li>Repeat these steps for the remaining methods with the following mappings:</li>
</ol><ul>
<li>
<strong>/search/<span style="color:#0073bb;">GET</span></strong>     PollyNotes-SearchFunction</li>
<li>
<strong>/{id}/<span style="color:#d13212;">DELETE</span></strong>    PollyNotes-DeleteFunction</li>
<li>
<strong>/{id}/<span style="color:#6aaf35;">POST</span></strong>      PollyNotes-DictateFunction</li>
</ul>
<p>Once you have completed the steps for each of the above methods, complete the following:</p>
<ol start="723">
<li>Choose <span style="background-color:#DEDEDE;font-weight:bold;font-size:90%;color:#444;border-radius:5px;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;">Actions <i class="fas fa-caret-down"></i></span> and select <strong>Deploy API</strong>.</li>
<li>Select the <span style="color:#0073bb;"><strong>prod</strong></span> stage, and then, choose <strong>Deploy</strong>.</li>
</ol>
<p>Your API should now be fully functional.</p>

<h2 id="step40">Task 13: (Python) - Testing the web application</h2>

<p>In this task, you test the web application by loading your Amazon S3 Hosted URL.</p>

<p><img src="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/images/lab-6-diagram-2020.png" alt="Lab 6 Diagram"></p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> You can obtain your Amazon S3 Hosted URL by going into the Amazon S3 Console. Select your web hosting bucket. Choose the <strong>Properties</strong> tab, and then choose, <strong>Static website hosting</strong>.</p>
<ol start="725">
<li>Test the application by exploring the functionality of the site. Test the add, delete, update, and search functions. Test that the voice options work correctly.</li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> Should you receive a backend server error, revisit the method integration steps and ensure the Lambda Function value is set correctly.</p>
<ul>
<li>If you find any that read as, <strong>arn:aws:lambda:us-west-2:012345678901:function:Mock/invocation</strong>, go back and update those methods to the correct Lambda Function name.</li>
</ul>
<p><a href="#troubleshooting" target="_self">A list of additional troubleshooting tips can be found here</a></p>

<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> Congratulations! You have completed the <strong>Python</strong> version of this lab.</p>

<p><a id="end" target="_blank"></a></p>

<h2 id="step41">Summary</h2>

<p><i class="far fa-thumbs-up" style="color:#0073bb;"></i> Congratulations! You have successfully:</p>
<ul>
<li>Used Remote Desktop (RDP) to connect to an Amazon EC2 instance running Windows Server as your development environment.</li>
<li>Used Amazon EC2 Instance Connect to connect to an Amazon EC2 Instance running Linux.</li>
<li>Host a Static Website in an Amazon S3 bucket.</li>
<li>Created an IAM Policy and Role to give specific access to Lambda.</li>
<li>Created an Amazon Cognito User Pool to authenticate users and control access to API Gateway.</li>
<li>Created Lambda functions to perform CRUD operations on a DynamoDB table.</li>
<li>Created a Restful API on API Gateway to front Lambda functions.</li>
<li>Accessed the Amazon Polly service through API.</li>
</ul>
<h2 id="step42">End Lab</h2>

<p>Follow these steps to close the console, end your lab, and evaluate the experience.</p>
<ol start="726">
<li><p>Return to the AWS Management Console.</p></li>
<li><p>On the navigation bar, choose <strong>awsstudent@&lt;AccountNumber&gt;</strong>, and then choose <strong>Sign Out</strong>.</p></li>
<li><p>Choose <span style="background-color:#D93025;font-family:Google Sans;font-weight:bold;font-size:90%;color:white;border-color:#D93025;border-radius:4px;border-width:2px;border-style:solid;padding-top:5px;padding-bottom:5px;padding-left:10px;padding-right:10px;">End Lab</span></p></li>
<li><p>Choose <span style="background-color:#DEDEDE;font-family:Google Sans;font-weight:bold;font-size:90%;color:#444;border-width:1px;border-style:solid;border-color:#444;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">OK</span></p></li>
<li><p>(Optional):</p></li>
</ol><ul>
<li>Select the applicable number of stars <i class="far fa-star"></i>
</li>
<li>Type a comment</li>
<li>
<p>Choose <strong>Submit</strong></p>
<ul>
<li>1 star = Very dissatisfied</li>
<li>2 stars = Dissatisfied</li>
<li>3 stars = Neutral</li>
<li>4 stars = Satisfied</li>
<li>5 stars = Very satisfied</li>
</ul>
</li>
</ul>
<p>You may close the window if you don't want to provide feedback.<br>
For more information about AWS Training and Certification, see <a href="https://aws.amazon.com/training/" target="_blank"><em>https://aws.amazon.com/training/</em></a>.</p>

<p><em>Your feedback is welcome and appreciated.</em></p>

<p>If you would like to share any feedback, suggestions, or corrections, please provide the details in our <a href="https://support.aws.amazon.com/#/contacts/aws-training" target="_blank"><em>AWS Training and Certification Contact Form</em></a>.</p>

<p><a id="connect_dev_dotnet" target="_blank"></a><br>
<a id="connect_dev_java" target="_blank"></a><br>
<a id="connect_dev_python" target="_blank"></a></p>

<h1>Appendix</h1>

<p><a id="connect_guacamole" target="_blank"></a></p>

<h2 id="step43">Connect to the Windows Dev Instance using Apache Guacamole</h2>
<ol start="731">
<li><p>In the <strong>Connection Details</strong> section in the lab console, copy the <strong>GuacamoleLink</strong> and paste it into a browser.</p></li>
<li><p>Go back to the lab console and copy the <strong>AdministratorPassword</strong> to the clipboard.</p></li>
<li><p>Go to the Apache Guacamole sign in in the browser. Sign in by using the following steps:</p></li>
</ol><ul>
<li>For <strong>Username</strong>, enter: <input readonly class="copyable-inline-input" size="7" type="text" value="student">
</li>
<li>For <strong>Password</strong>, paste the <strong>AdministratorPassword</strong> from the clipboard.</li>
<li>Select <strong>Log In</strong>.</li>
</ul>
<p>Your connection to your remote instance should start momentarily. Once you open a connection, you will see an image of the Dev instance desktop. You can interact with this image just as you would your normal desktop, or any remote desktop client.</p>

<p>You are now connected to your Windows Dev instance in the browser via Guacamole.</p>

<p><strong>Tip</strong> Web browsers don't provide access to clipboard data, which means synchronization between your local clipboard and the remote clipboard is impossible. To copy and paste when using Guacamole, you must use the Clipboard editor. To open the Clipboard editor, press <strong>Ctrl -&gt; Alt -&gt; Shift</strong>.</p>

<p>Copy your text and paste it to the Clipboard editor. This will set the clipboard of your Dev instance to what you just pasted. You can also edit the text that you place in the Clipboard editor before pasting into your remote desktop. To close the Clipboard editor, press <strong>Ctrl -&gt; Alt -&gt; Shift</strong>.</p>

<p>To continue this lab, move on to <a href="#task1-continue" target="_self">Task 1.2: Command window options</a>.</p>

<p><a id="connect_win_win" target="_blank"></a></p>

<h2 id="step44">Connect to the Windows Dev Instance from a Windows Machine</h2>

<p>In this task, you will connect to a Windows Amazon EC2 instance from your Windows machine.</p>

<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> Perform the steps in this task only if you are connecting to <strong>Windows Dev Instance</strong> from a Windows machine.</p>
<ol start="734">
<li><p>In the lab console, go to the <strong>Connection Details</strong> section and copy the <strong>WindowsInstanceIP</strong> to the clipboard.</p></li>
<li><p>Open the Remote Desktop Connection application on your computer.</p></li>
</ol><ul>
<li>On Windows 7, select the <strong>Start</strong> icon, and in the <strong>Search programs and files</strong> textbox, enter: <input readonly class="copyable-inline-input" size="25" type="text" value="Remote Desktop Connection">. Select the application when it appears in the <strong>Programs</strong> list.</li>
<li>On Windows 8, activate the Charms menu by moving the cursor into the lower right corner of the screen, and select the <strong>Search</strong> icon. Enter: <input readonly class="copyable-inline-input" size="25" type="text" value="Remote Desktop Connection">. Select the application when it appears in the <strong>Programs</strong> list.</li>
<li>On Windows 10, select the <strong>Start</strong> icon, and then, select the <strong>Search</strong> icon. Enter: <input readonly class="copyable-inline-input" size="25" type="text" value="Remote Desktop Connection">. Select the application when it appears in the <strong>Programs</strong> list.</li>
</ul><ol start="736">
<li><p>In Remote Desktop Connection, for <strong>Computer</strong>, paste the IP of your Windows instance that you copied.</p></li>
<li><p>Select <strong>Connect</strong>.</p></li>
<li><p>Remote Desktop Connection will prompt you with a Login dialog asking for your username and password. By default, the application will use your current Windows username and domain. To change this, select <strong>Use another account</strong>.</p></li>
</ol>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> On Windows 10, select <strong>More Choices</strong> before selecting <strong>Use a different account</strong>.</p>
<ol start="739">
<li><p>Go back to the lab console and copy the <strong>AdministratorPassword</strong> to the clipboard.</p></li>
<li><p>For your login credentials, use the following values:</p></li>
</ol><ul>
<li>For <strong>User name</strong>, enter: <input readonly class="copyable-inline-input" size="14" type="text" value="\Administrator">
</li>
<li>For*<em>Password</em>*, paste the password from the clipboard.</li>
</ul>
<p><i class="fas fa-sticky-note" style="color:#ec7211;"></i> The <input readonly class="copyable-inline-input" size="1" type="text" value="\"> in the user name is important, as it tells Remote Desktop Connection that you are logging in as the local Administrator, and not as a domain user.</p>
<ol start="741">
<li>To connect to your instance, select <strong>OK</strong>. If you receive a prompt that the certificate used to verify the connection was not a known, trusted root certificate, select <strong>Yes</strong>.</li>
</ol>
<p><strong>Result</strong></p>

<p>Your connection to your remote instance should start momentarily. When lab instructions in subsequent sections require a command window, open or use a Powershell window.</p>

<p>To continue this lab, move on to <a href="#task1-continue" target="_self">Task 1.2: Command window options</a>.</p>

<p><a id="connect_win_mac" target="_blank"></a></p>

<h2 id="step45">Connect to the Windows Dev Instance from a macOS Machine</h2>

<p>In this task, you connect to a Windows EC2 instance from your macOS machine.</p>
<ol start="742">
<li>Install Microsoft Remote Desktop if it is not already installed. To install, complete the following:</li>
</ol><ul>
<li>At the top of the screen, select the Apple icon.</li>
<li>Select <strong>About This Mac</strong>.</li>
<li>Take note of your macOS version.</li>
<li>From the Dock, launch <strong>App store</strong>.</li>
<li><p>Search for the following string: <input readonly class="copyable-inline-input" size="24" type="text" value="Microsoft Remote Desktop">.</p></li>
<li><p>Choose <strong>Install</strong> or <strong>GET</strong> to install the appropriate version.</p></li>
<li><p>At the time of this writing, the current macOS version is OSX 10.15.7 and you install Microsoft Remote Desktop Version 10.5.2. The connection instructions will be based on this version.</p></li>
</ul><ol start="743">
<li><p>To open <strong>Microsoft Remote Desktop</strong>, on the Dock, select <strong>Launchpad</strong>. Then, select <strong>Microsoft Remote Desktop</strong>.</p></li>
<li><p>To create a new connection, from the top menu select <strong>Connections</strong> &gt; <strong>Add PC</strong> and fill in the following fields:</p></li>
</ol><ul>
<li>
<strong>PC name:</strong> <em>Paste in the WindowsInstanceIP copied from the Lab Properties to the left of these instructions.</em>
</li>
<li>
<strong>User account:</strong> <input readonly class="copyable-inline-input" size="13" type="text" value="Administrator">
</li>
<li>
<strong>Friendly name:</strong> <input readonly class="copyable-inline-input" size="20" type="text" value="Windows Dev Instance">
</li>
<li>
<i class="far fa-check-square" style="color:#0073bb;"></i> <strong>Reconnect if the connection is dropped:</strong> <em>Select this option if not already selected.</em>
</li>
<li>Choose <strong>Add</strong>.</li>
</ul><ol start="745">
<li><p>From the navigation panel to the left of these instructions, copy the <strong>WindowsPassword</strong> to the clipboard.</p></li>
<li><p>Go back to your Microsoft Remote Desktop connection window, and open the context menu for the <strong>Windows Dev Instance</strong> connection and choose <strong>Open</strong>.</p></li>
<li><p>It will show a message reading, <strong>You are connecting to the RDP host "IP.Address.Listed.Here". There certificate couldn't be verified back to a root certificate. Your connection may not be secure. Do you want to continue?</strong> Choose <strong>Continue</strong>.</p></li>
<li><p>Once prompted for the password, enter the password that you copied to the clipboard and choose <strong>Continue</strong>.</p></li>
</ol>
<p><strong>Result</strong></p>

<p>Your connection to your remote instance should start momentarily. When lab instructions in subsequent sections require a command window, open or use a PowerShell window.</p>

<p>To continue this lab, move on to <a href="#task1-continue" target="_self">Task 1.2: Command window options</a>.</p>

<p><a id="ec2-instance-connect" target="_blank"></a></p>

<h2 id="step46">Connect to the Linux Dev Instance Using Amazon EC2 Instance Connect</h2>
<ol start="749">
<li>From the browser tab logged into the <strong>Amazon Management Console</strong>, choose <span style="background-color:#232f3e;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;">Services <i class="fas fa-angle-down"></i></span> and select  <strong>EC2</strong>.</li>
<li>Choose <strong>Instances</strong>.</li>
<li>Select <i class="far fa-check-square" style="color:#0073bb;"></i>  <strong>Linux Instance Dev</strong> and then choose <span style="background-color:white;font-weight:bold;font-size:90%;color:#545b64;border-color:#545b64;border-radius:2px;border-width:1px;border-style:solid;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;"> Connect</span>
</li>
<li>Select the <strong>EC2 Instance Connect</strong> tab.</li>
<li>Ensure the <strong>User name</strong> field is set to <input readonly class="copyable-inline-input" size="8" type="text" value="ec2-user">.</li>
<li>Choose <span style="background-color:#ec7211;font-weight:bold;font-size:90%;color:white;padding-top:3px;padding-bottom:3px;padding-left:10px;padding-right:10px;white-space:nowrap;"><strong>Connect</strong></span>
</li>
</ol>
<p>Now you will be taken to an ssh session using the AWS console.</p>

<p>To continue this lab, move on to <a href="#python_continue" target="_self">Task 3.2 Continued: (Python)</a>.</p>

<h2 id="step47">Appendix: Configuring AWS SDK for .NET Credentials</h2>

<p><i class="fas fa-info-circle" style="color:#00a1c9;"></i> The following resources are excerpts from the <a href="http://docs.aws.amazon.com/sdk-for-net/v3/developer-guide/net-dg-config.html" target="_blank">AWS SDK for .NET Developer Guide</a>.</p>

<p><strong>AWS Credentials</strong></p>

<p><i class="fas fa-info-circle" style="color:#00a1c9;"></i> You can manage credentials for your AWS SDK for .NET application in the following ways:</p>
<ul>
<li><a href="http://docs.aws.amazon.com/sdk-for-net/v3/developer-guide/net-dg-config-creds.html#sdk-store" target="_blank">Using the SDK Store</a></li>
<li>
<a href="http://docs.aws.amazon.com/sdk-for-net/v3/developer-guide/net-dg-config-creds.html#creds-file" target="_blank">Using a Credentials File</a> (<input readonly class="copyable-inline-input" size="36" type="text" value="C:\Users\&lt;username&gt;\.aws\credentials">)</li>
</ul>
<p><i class="fas fa-info-circle" style="color:#00a1c9;"></i> For more information, see <a href="http://docs.aws.amazon.com/general/latest/gr/aws-access-keys-best-practices.html" target="_blank">AWS Access Keys Best Practices</a>.</p>

<h2 id="step48">Appendix: Working with Lab Skeleton Code in Python</h2>

<p>You can use one of the editors listed next depending on your choice of programming environment.</p>
<ul>
<li>
<strong>Windows Dev Instance</strong> is set up with the PyCharm IDE.</li>
<li>
<strong>Linux Dev Instance</strong> is set up with Nano and Vi editors.</li>
</ul>
<h2 id="step49">Working with Python Code in PyCharm IDE on Windows</h2>

<p>If you are going to develop your lab in the Python programming language in <strong>Windows Dev Instance</strong>, follow the instructions in this section to import your lab skeleton code into the PyCharm Community Edition IDE.</p>
<ol start="755">
<li>Launch the PyCharm IDE by using the desktop shortcut in Windows Dev Instance.</li>
<li>In the <strong>Complete Installation</strong> dialog box, select <strong>I do not have a previous version of PyCharm</strong>, and then, select <strong>OK</strong>.</li>
<li>Accept the default settings for the UI theme and select <strong>OK</strong> to proceed to the PyCharm Welcome Screen.</li>
<li>Select <strong>Open</strong>.</li>
<li>Navigate to the <input readonly class="copyable-inline-input" size="15" type="text" value="C:\temp\workdir"> folder. Select the lab <strong>folder</strong>.</li>
</ol>
<p>Examples of lab folder names include:<br>
   - <input readonly class="copyable-inline-input" size="19" type="text" value="readySetGoPythonLab"><br>
   - <input readonly class="copyable-inline-input" size="11" type="text" value="s3PythonLab"></p>
<ol start="760">
<li>After the lab is successfully imported into PyCharm, you can follow lab specific instructions to modify the skeleton code.</li>
</ol>
<p><a id="troubleshooting" target="_blank"></a></p>

<h2 id="step50">Appendix 2: Troubleshooting</h2>

<p>So, you broke it. Don't worry, hopefully the information in this section will help you get things up and running! If you work through these troubleshooting tips and your application is still not working, ask your instructor to help you.</p>

<p>There are a number of useful tools at your disposal to help you troubleshoot.</p>

<p><strong>AWS CloudWatch Logs</strong></p>

<p>CloudWatch logs will provide you with information on the following:</p>
<ul>
<li>API Gateway</li>
<li>Lambda</li>
</ul><ol start="761">
<li>To access the logs, complete the following steps:</li>
</ol><ul>
<li>Choose <strong>Services</strong>, and then, choose <strong>CloudWatch</strong>.</li>
<li>Choose <strong>Logs</strong> &gt; <strong>Log groups</strong>.</li>
<li>Select one of the following:</li>
</ul>
<p><strong>API-Gateway-Execution-Logs_xxxxxxxxxx/prod</strong>  (For your API Logs)</p>

<p><strong>/aws/lambda/PollyNotes-xxxxxxxxFunction</strong>     (For your Lambda Function)</p>
<ol start="762">
<li><p>When you choose the link, you will see your log streams, sorted by <em>last event time</em> with the most recently updated at the top. <strong>Choose the very top log stream</strong>.</p></li>
<li><p>Scroll down to see the latest events and look for any errors.</p></li>
</ol>
<p>Your API will log inbound and outbound payloads; your Lambda functions will log errors and any print statements that are included in the function. Both of these are very useful in troubleshooting.</p>

<p><strong>Front End Application</strong></p>

<p>The experience that you have in the application is often a good indicator of the issue. For example, if your application is not creating or updating records, but is listing ok; the issue may likely be with your /notes/POST method or your PollyNotes-CreateUpdateFunction. The logs will help you troubleshoot the issue.</p>

<p>Remember, the API Gateway Method to Lambda mappings are as follows:</p>
<ul>
<li><p><strong>/notes/GET --&gt; PollyNotes-ListFunction</strong></p></li>
<li><p><strong>/search/GET --&gt; PollyNotes-SearchFunction</strong></p></li>
<li><p><strong>/{id}/DELETE --&gt; PollyNotes-DeleteFunction</strong></p></li>
<li><p><strong>/{id}/POST --&gt; PollyNotes-DictateFunction</strong></p></li>
</ul>
<p><strong>Behavior Expected in the Application</strong></p>
<ul>
<li><p><strong>/notes/GET --&gt; PollyNotes-ListFunction</strong>: If this isn't working, the application will fail to show any items in the web interface.</p></li>
<li><p><strong>/notes/POST --&gt; PollyNotes-CreateUpdateFunction</strong>: If this isn't working, you will not be able to create or update notes.</p></li>
<li><p><strong>/search/GET --&gt; PollyNotes-SearchFunction</strong>: If this isn't working, you will not be able to search.</p></li>
<li><p><strong>/{id}/DELETE --&gt; PollyNotes-DeleteFunction</strong>: If this isn't working, you will not be able to delete notes.</p></li>
<li><p><strong>/{id}/POST --&gt; PollyNotes-DictateFunction</strong>: If this isn't working, you will not be able to play any audio from the application.</p></li>
</ul>
<p>The following file is a full completed Swagger file. If you create an empty new API, import this, and it will create all of the resources / methods for you. You will still need to integrate your methods with your Lambda functions. This could be good for troubleshooting if you break something in your API, you could delete all resources, then import this file, and re-integrate your Lambda functions.</p>

<p><strong>Source file:</strong> <a href="https://ap-northeast-1-tcprod.s3.amazonaws.com/courses/ILT-TF-200-DODEVA/v3.4.17/lab-6-end-to-end-app/scripts/API-Gateway-full-swagger.yaml" target="_blank">Full Swagger File</a></p>

<p><strong>Common Mistakes</strong></p>
<ul>
<li><p><strong>Number 1:</strong> Invalid DynamoDB Table Name (Case sensitive)</p></li>
<li><p><strong>Number 2:</strong> Lambda Environment Variables Not entered correctly</p></li>
<li><p><strong>Number 3:</strong> API Gateway - Lambda's not mapped to the correct Methods</p></li>
</ul>
<p>Hopefully these troubleshooting tips helped you to solve any errors that you had. If you still have errors, contact your instructor.</p>

</div>
</div>


<div class='lab-content__end-lab-button js-end-lab-button-container hidden'>
<ql-lab-control-button class='js-end-lab-button' running></ql-lab-control-button>
</div>
<!-- / TODO: Move recommendations into the end lab modal -->
</ql-drawer-content>
<ql-drawer end id='outline-drawer' open slot='drawer' width='320'>
<div aria-label='Lab Table of Contents' role='navigation'>
<ul class='lab-content__outline js-lab-content-outline'>
<li><a href='#step1'>Overview</a></li><li><a href='#step2'>Objectives</a></li><li><a href='#step3'>Prerequisites</a></li><li><a href='#step4'>Icon key</a></li><li><a href='#step5'>Duration</a></li><li><a href='#step6'>Start Lab</a></li><li><a href='#step7'>Task 1: Connect to your development environment</a></li><li><a href='#step8'>Task 2: Choose a programming language</a></li><li><a href='#step9'>Task 3: (.NET) - Amazon Cognito Authentication</a></li><li><a href='#step10'>Task 4: (.NET) - Creating a DynamoDB table</a></li><li><a href='#step11'>Task 6: (.NET) - Reviewing an IAM Managed Policy and Creating an IAM Role</a></li><li><a href='#step12'>Task 7: (.NET) - Creating the Lambda ListFunction</a></li><li><a href='#step13'>Task 8: (.NET) - Creating an API Gateway</a></li><li><a href='#step14'>Task 9: Creating the Front-End Website</a></li><li><a href='#step15'>Task 10: (.NET) - Testing the web application</a></li><li><a href='#step16'>Task 11: (.NET) - Creating the remaining Lambda functions</a></li><li><a href='#step17'>Task 12 (.NET) - Creating the remaining Restful API</a></li><li><a href='#step18'>Task 13: (.NET) Testing the web application</a></li><li><a href='#step19'>Task 3: (Java) - Amazon Cognito Authentication</a></li><li><a href='#step20'>Task 4: (Java) - Creating a DynamoDB table</a></li><li><a href='#step21'>Task 5: (Java) - Creating Amazon S3 buckets</a></li><li><a href='#step22'>Task 6: Reviewing an IAM managed policy and creating an IAM role</a></li><li><a href='#step23'>Task 7: (Java) - Creating the Lambda ListFunction</a></li><li><a href='#step24'>Task 8: (Java) - Creating the API Gateway</a></li><li><a href='#step25'>Task 9: (Java) - Creating the front-end website</a></li><li><a href='#step26'>Task 10: (Java) - Testing the web application</a></li><li><a href='#step27'>Task 11: (Java) - Creating the remaining Lambda functions</a></li><li><a href='#step28'>Task 12: (Java) - Creating the remaining Restful API</a></li><li><a href='#step29'>Task 13: (Java) - Testing the web application</a></li><li><a href='#step30'>Task 3: (Python) - Amazon Cognito Authentication</a></li><li><a href='#step31'>Task 4: (Python) - Creating a DynamoDB table</a></li><li><a href='#step32'>Task 5: (Python) - Creating Amazon S3 buckets</a></li><li><a href='#step33'>Task 6: (Python) - Reviewing an IAM managed policy and creating an IAM role</a></li><li><a href='#step34'>Task 7: (Python) - Creating the Lambda ListFunction</a></li><li><a href='#step35'>Task 8: (Python) - Creating the API Gateway</a></li><li><a href='#step36'>Task 9: (Python) - Creating the front-end website</a></li><li><a href='#step37'>Task 10: (Python) - Testing the web application</a></li><li><a href='#step38'>Task 11: (Python) - Creating the remaining Lambda functions</a></li><li><a href='#step39'>Task 12: (Python) - Creating the remaining Restful API</a></li><li><a href='#step40'>Task 13: (Python) - Testing the web application</a></li><li><a href='#step41'>Summary</a></li><li><a href='#step42'>End Lab</a></li><li><a href='#step43'>Connect to the Windows Dev Instance using Apache Guacamole</a></li><li><a href='#step44'>Connect to the Windows Dev Instance from a Windows Machine</a></li><li><a href='#step45'>Connect to the Windows Dev Instance from a macOS Machine</a></li><li><a href='#step46'>Connect to the Linux Dev Instance Using Amazon EC2 Instance Connect</a></li><li><a href='#step47'>Appendix: Configuring AWS SDK for .NET Credentials</a></li><li><a href='#step48'>Appendix: Working with Lab Skeleton Code in Python</a></li><li><a href='#step49'>Working with Python Code in PyCharm IDE on Windows</a></li><li><a href='#step50'>Appendix 2: Troubleshooting</a></li>
</ul>
</div>
</ql-drawer>
</ql-drawer-container>
</ql-drawer-content>
</ql-drawer-container>



</div>
</main>

<span class='hidden' id='flash-sibling-before'></span>
<ql-snackbar></ql-snackbar>


<div class='modal fade' id='lab-details-modal'>
<div class='modal-container'>
<div class='modal-content mdl-shadow--24dp'>
<div class='modal-body'>
<p class='l-mbm'>
Developing on AWS is a three-day instructor led course.
</p>
<p class='small-label l-mbs'>
<strong>
Duration:
</strong>
19m setup
&middot;
240m access
&middot;
240m completion
</p>
<p class='small-label l-mbs'>
<strong>AWS Region:</strong>
[eu-west-1] <strong>EU (Ireland)</strong>
</p>
<p class='small-label l-mbs'>

</p>
<p class='small-label'>
<strong>
Permalink:
</strong>
<a href="https://gk-emea.qwiklabs.com/catalog_lab/67435">https://gk-emea.qwiklabs.com/catalog_lab/67435</a>
</p>
</div>
<div class='modal-actions'>
<a class='button button--text' data-dismiss='modal'>
Got It
</a>
</div>


</div>
</div>
<iframe class='l-ie-iframe-fix' tabindex='-1'></iframe>
</div>
<ql-dialog headline='How satisfied are you with this lab?&lt;span aria-hidden=&quot;true&quot;&gt;*&lt;/span&gt;' id='lab-review-dialog'>
<form class="simple_form js-lab-review-form" id="new_lab_review" action="/lab_reviews" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div aria-labelledby='lab-review-dialog' aria-required='true' aria-valuemax='5' aria-valuemin='0' aria-valuenow='0' class='rateit js-rateit' data-rateit-max='5' data-rateit-min='0' data-rateit-resetable='false' data-rateit-step='1' data-rateit-value='0' id='lab-review-rateit' role='slider' tabindex='0'></div>
<div class='l-mtm'>

<div class="control-group hidden lab_review_user_id"><div class="controls"><input class="hidden" type="hidden" value="27375" name="lab_review[user_id]" id="lab_review_user_id" /></div></div>
<div class="control-group hidden lab_review_classroom_id"><div class="controls"><input class="hidden" type="hidden" value="4134" name="lab_review[classroom_id]" id="lab_review_classroom_id" /></div></div>
<div class="control-group hidden lab_review_lab_id"><div class="controls"><input class="hidden" type="hidden" value="67435" name="lab_review[lab_id]" id="lab_review_lab_id" /></div></div>
<div class="control-group hidden lab_review_focus_id"><div class="controls"><input class="hidden" type="hidden" value="31084" name="lab_review[focus_id]" id="lab_review_focus_id" /></div></div>
<div class="control-group hidden lab_review_rating"><div class="controls"><input class="hidden js-rating-input" type="hidden" name="lab_review[rating]" id="lab_review_rating" /></div></div>
<div class="control-group text optional lab_review_comment"><label class="text optional control-label" for="lab_review_comment">Additional Comments</label><div class="controls"><textarea class="text optional" name="lab_review[comment]" id="lab_review_comment">
</textarea></div></div>
</div>
</form><ql-button disabled id='submit' label='Submit' slot='action' text></ql-button>
</ql-dialog>

<ql-dialog headline='All done? If you end this lab, you will lose all your work. You may not be able to restart the lab if there is a quota limit. Are you sure you want to end this lab?' icon='error_outline' id='js-lab-are-you-sure-dialog'>
<ql-button id='js-are-you-sure-button' label='Submit' slot='action' text></ql-button>
</ql-dialog>


<script>
  $( function() {
    ql.initMaterialInputs();
    initChosen();
    initSearch();
    initTabs();
    ql.list.init();
    ql.favoriting.init();
    ql.header.myAccount.init();
    initTooltips();
    ql.autocomplete.init();
    ql.modals.init();
    ql.toggleButtons.init();
    ql.analytics.init();
    ql.chat.init();
  ql.jumpContent.init();
  initLabContent();
  ql.labOutline.links.init();
  initLabReviewModal();
  initLabReviewTranslations( {"star_amount_1":"1 of 5 stars","star_amount_2":"2 of 5 stars","star_amount_3":"3 of 5 stars","star_amount_4":"4 of 5 stars","star_amount_5":"5 of 5 stars"} )
  ql.labAssessment.init();
  ql.labData.init();
  initLabTranslations( {"are_you_sure":"All done? If you end this lab, you will lose all your work. You may not be able to restart the lab if there is a quota limit. Are you sure you want to end this lab?","in_progress":"*In Progress*","ending":"*Ending*","starting":"*Starting, please wait*","end_concurrent_labs":"Sorry, you can only run one lab at a time. To start this lab, please confirm that you want all of your existing labs to end.","copied":"Copied","no_resource":"Error retrieving resource.","no_support":"No Support","mac_press":"Press ⌘-C to copy","thanks_review":"Thanks for reviewing this lab.","windows_press":"Press Ctrl-C to copy","days":"days"} );
  ql.labRun.init();
  ql.navPanel.init();
  ql.navigation.init();
  
  });
</script>

</body>
</html>

